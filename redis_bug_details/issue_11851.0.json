{
  "issue_number": 11851.0,
  "title": "[BUG] Redis 5.0.5 crashed by signal: 11",
  "body": "**Describe the bug**\r\nMy redis instance died from signal 11. This was in regular operation and happened unexpectedly. The redis commands that I sent at the time can only have been typical, but I do not have enough context from logfiles to trace this exactly.\r\n\r\n**To reproduce**\r\nI am unable to reproduce this.\r\n\r\n**Expected behavior**\r\nNo crash.\r\n\r\n**Additional information**\r\nI am running redis in a docker container, using the image `redis:5.0.5`.\r\n\r\nBug report by redis:\r\n```\r\n\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n7:M 26 Feb 2023 13:42:15.741 # Redis 5.0.5 crashed by signal: 11\r\n7:M 26 Feb 2023 13:42:15.741 # Crashed running the instruction at: 0x5560f7ae987c\r\n7:M 26 Feb 2023 13:42:15.741 # Accessing address: 0x2000\r\n7:M 26 Feb 2023 13:42:15.741 # Failed assertion: <no assertion failed> (<no file>:0)\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\nredis-server 0.0.0.0:6379(dictFind+0x5c)[0x5560f7ae987c]\r\n\r\nBacktrace:\r\nredis-server 0.0.0.0:6379(logStackTrace+0x32)[0x5560f7b31112]\r\nredis-server 0.0.0.0:6379(sigsegvHandler+0x9e)[0x5560f7b317ee]\r\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x12730)[0x7fa76b132730]\r\nredis-server 0.0.0.0:6379(dictFind+0x5c)[0x5560f7ae987c]\r\nredis-server 0.0.0.0:6379(zsetAdd+0x68)[0x5560f7b19208]\r\nredis-server 0.0.0.0:6379(zaddGenericCommand+0x2ff)[0x5560f7b19b5f]\r\nredis-server 0.0.0.0:6379(call+0xa7)[0x5560f7aed2b7]\r\nredis-server 0.0.0.0:6379(processCommand+0x51e)[0x5560f7aedb5e]\r\nredis-server 0.0.0.0:6379(processInputBuffer+0x171)[0x5560f7afdd51]\r\nredis-server 0.0.0.0:6379(aeProcessEvents+0x101)[0x5560f7ae72e1]\r\nredis-server 0.0.0.0:6379(aeMain+0x2b)[0x5560f7ae76eb]\r\nredis-server 0.0.0.0:6379(main+0x4b9)[0x5560f7ae4569]\r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xeb)[0x7fa76af8309b]\r\nredis-server 0.0.0.0:6379(_start+0x2a)[0x5560f7ae47aa]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:5.0.5\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:442b43d467cd2b03\r\nredis_mode:standalone\r\nos:Linux 5.15.0-60-generic x86_64\r\narch_bits:64\r\nmultiplexing_api:epoll\r\natomicvar_api:atomic-builtin\r\ngcc_version:8.3.0\r\nprocess_id:7\r\nrun_id:c75e1ae6c1384702eec8adee7fe290f170c49d7d\r\ntcp_port:6379\r\nuptime_in_seconds:128129\r\nuptime_in_days:1\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:16474551\r\nexecutable:/data/redis/redis-server\r\nconfig_file:/tmp/redis.conf\r\n\r\n# Clients\r\nconnected_clients:28\r\nclient_recent_max_input_buffer:2\r\nclient_recent_max_output_buffer:0\r\nblocked_clients:0\r\n\r\n# Memory\r\nused_memory:281273920\r\nused_memory_human:268.24M\r\nused_memory_rss:290750464\r\nused_memory_rss_human:277.28M\r\nused_memory_peak:416032232\r\nused_memory_peak_human:396.76M\r\nused_memory_peak_perc:67.61%\r\nused_memory_overhead:1335920\r\nused_memory_startup:791344\r\nused_memory_dataset:279938000\r\nused_memory_dataset_perc:99.81%\r\nallocator_allocated:281355200\r\nallocator_active:281792512\r\nallocator_resident:290021376\r\ntotal_system_memory:67168899072\r\ntotal_system_memory_human:62.56G\r\nused_memory_lua:37888\r\nused_memory_lua_human:37.00K\r\nused_memory_scripts:0\r\nused_memory_scripts_human:0B\r\nnumber_of_cached_scripts:0\r\nmaxmemory:0\r\nmaxmemory_human:0B\r\nmaxmemory_policy:noeviction\r\nallocator_frag_ratio:1.00\r\nallocator_frag_bytes:437312\r\nallocator_rss_ratio:1.03\r\nallocator_rss_bytes:8228864\r\nrss_overhead_ratio:1.00\r\nrss_overhead_bytes:729088\r\nmem_fragmentation_ratio:1.03\r\nmem_fragmentation_bytes:9477808\r\nmem_not_counted_for_evict:0\r\nmem_replication_backlog:0\r\nmem_clients_slaves:0\r\nmem_clients_normal:539360\r\nmem_aof_buffer:0\r\nmem_allocator:jemalloc-5.1.0\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nrdb_changes_since_last_save:2380\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1677418833\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:1\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_last_cow_size:1585152\r\naof_enabled:0\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:-1\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:0\r\n\r\n# Stats\r\ntotal_connections_received:12720\r\ntotal_commands_processed:23802075\r\ninstantaneous_ops_per_sec:215\r\ntotal_net_input_bytes:2223140058\r\ntotal_net_output_bytes:1252510295\r\ninstantaneous_input_kbps:20.02\r\ninstantaneous_output_kbps:11.67\r\nrejected_connections:0\r\nsync_full:0\r\nsync_partial_ok:0\r\nsync_partial_err:0\r\nexpired_keys:0\r\nexpired_stale_perc:0.00\r\nexpired_time_cap_reached_count:0\r\nevicted_keys:0\r\nkeyspace_hits:16984861\r\nkeyspace_misses:3122678\r\npubsub_channels:0\r\npubsub_patterns:0\r\nlatest_fork_usec:13893\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:0\r\nmaster_replid:a7bb7e80d76a12122710f58fb209e604a6452a9a\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:0\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:0\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0\r\nrepl_backlog_histlen:0\r\n\r\n# CPU\r\nused_cpu_sys:496.779755\r\nused_cpu_user:339.369515\r\nused_cpu_sys_children:43.685153\r\nused_cpu_user_children:345.674342\r\n\r\n# Commandstats\r\ncmdstat_get:calls=12813,usec=15100,usec_per_call=1.18\r\ncmdstat_zremrangebyrank:calls=103,usec=982882,usec_per_call=9542.54\r\ncmdstat_type:calls=104,usec=123,usec_per_call=1.18\r\ncmdstat_ping:calls=12687,usec=6909,usec_per_call=0.54\r\ncmdstat_info:calls=281018,usec=5457531,usec_per_call=19.42\r\ncmdstat_zadd:calls=3221343,usec=38385310,usec_per_call=11.92\r\ncmdstat_keys:calls=166572,usec=3051145,usec_per_call=18.32\r\ncmdstat_zrange:calls=19979305,usec=59381379,usec_per_call=2.97\r\ncmdstat_set:calls=12813,usec=18512,usec_per_call=1.44\r\ncmdstat_zrangebyscore:calls=115317,usec=205252,usec_per_call=1.78\r\n\r\n# Cluster\r\ncluster_enabled:0\r\n\r\n# Keyspace\r\ndb0:keys=104,expires=0,avg_ttl=0\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=10 addr=127.0.0.1:33190 fd=14 name= age=128124 idle=128110 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=11 addr=127.0.0.1:33192 fd=15 name= age=128124 idle=5746 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=188 addr=127.0.0.1:44826 fd=21 name= age=126393 idle=52265 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=3 addr=127.0.0.1:33138 fd=7 name= age=128128 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=189 qbuf-free=32579 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6378 addr=127.0.0.1:36482 fd=27 name= age=63947 idle=51313 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=4 addr=127.0.0.1:33146 fd=8 name= age=128128 idle=128118 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=17 addr=127.0.0.1:41600 fd=20 name= age=128118 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=6326 addr=127.0.0.1:46188 fd=23 name= age=64443 idle=60456 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=610 addr=127.0.0.1:32776 fd=22 name= age=122141 idle=9281 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=info\r\nid=6613 addr=127.0.0.1:36156 fd=33 name= age=61695 idle=50836 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6383 addr=127.0.0.1:37364 fd=28 name= age=63903 idle=50985 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6377 addr=127.0.0.1:36474 fd=26 name= age=63947 idle=51292 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=5 addr=127.0.0.1:33148 fd=9 name= age=128128 idle=3 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=6376 addr=127.0.0.1:36462 fd=24 name= age=63948 idle=50978 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6 addr=127.0.0.1:33162 fd=10 name= age=128128 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=info\r\nid=7 addr=127.0.0.1:33166 fd=11 name= age=128128 idle=51 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=12 addr=127.0.0.1:41550 fd=16 name= age=128121 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=keys\r\nid=6499 addr=127.0.0.1:58272 fd=31 name= age=62798 idle=62798 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6530 addr=127.0.0.1:38410 fd=34 name= age=62520 idle=50996 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6501 addr=127.0.0.1:58300 fd=32 name= age=62792 idle=50972 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=6386 addr=127.0.0.1:42948 fd=30 name= age=63893 idle=50979 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nid=13 addr=127.0.0.1:41560 fd=17 name= age=128121 idle=5745 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=14 addr=127.0.0.1:41576 fd=18 name= age=128121 idle=128065 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=5991 addr=127.0.0.1:34198 fd=25 name= age=67806 idle=67806 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=keys\r\nid=15 addr=127.0.0.1:41578 fd=19 name= age=128121 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=set\r\nid=8 addr=127.0.0.1:33170 fd=12 name= age=128124 idle=5744 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=9 addr=127.0.0.1:33174 fd=13 name= age=128124 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=zrange\r\nid=6384 addr=127.0.0.1:37380 fd=29 name= age=63903 idle=50979 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=zadd\r\n\r\n------ CURRENT CLIENT INFO ------\r\nid=3 addr=127.0.0.1:33138 fd=7 name= age=128128 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=189 qbuf-free=32579 obl=0 oll=0 omem=0 events=r cmd=zadd\r\nargv[0]: 'ZADD'\r\nargv[1]: 'parameter_0_1_0:json:xy_alignment_procedure:last_status'\r\nargv[2]: '1677418935741435272'\r\nargv[3]: '\u0017Gc�|a͈\"ok: Completed(4.1s) XY alignment done, aligned: {'x': True, 'y': True}\"''\r\n7:M 26 Feb 2023 13:42:15.744 # key 'parameter_0_1_0:json:xy_alignment_procedure:last_status' found in DB containing the following object:\r\n7:M 26 Feb 2023 13:42:15.744 # Object type: 3\r\n7:M 26 Feb 2023 13:42:15.744 # Object encoding: 7\r\n7:M 26 Feb 2023 13:42:15.744 # Object refcount: 1\r\n7:M 26 Feb 2023 13:42:15.744 # Sorted set size: 88089\r\n7:M 26 Feb 2023 13:42:15.744 # Skiplist level: 8\r\n\r\n------ REGISTERS ------\r\n7:M 26 Feb 2023 13:42:15.744 # \r\nRAX:00007fa7500ac700 RBX:0000000000002000\r\nRCX:c753438103502070 RDX:0000000000008c04\r\nRDI:00005560f7b656c7 RSI:2898c89f8ea2a9f7\r\nRBP:00007fa7607ff560 RSP:00007ffe4cdc5820\r\nR8 :00005560f7c1a290 R9 :227d65757254203a\r\nR10:00007fa75c4ef2f3 R11:0000000000000000\r\nR12:00007fa75c4ef2a3 R13:00007fa7607ff570\r\nR14:41b8c8aeef9c8c04 R15:00007fa7607ff5b0\r\nRIP:00005560f7ae987c EFL:0000000000010206\r\nCSGSFS:002b000000000033\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582f) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582e) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582d) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582c) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582b) -> 0000000000000001\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc582a) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5829) -> 000000006aa09a88\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5828) -> 43b74763a27c61ce\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5827) -> 00005560f7b19208\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5826) -> 00007fa7607a4450\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5825) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5824) -> 0000000000000000\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5823) -> 00007ffe4cdc5908\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5822) -> 00007fa75c4ef2a3\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5821) -> 00007ffe4cdc5904\r\n7:M 26 Feb 2023 13:42:15.744 # (00007ffe4cdc5820) -> 0000000000000010\r\n\r\n------ FAST MEMORY TEST ------\r\n7:M 26 Feb 2023 13:42:15.744 # Bio thread for job type #0 terminated\r\n7:M 26 Feb 2023 13:42:15.745 # Bio thread for job type #1 terminated\r\n7:M 26 Feb 2023 13:42:15.745 # Bio thread for job type #2 terminated\r\n*** Preparing to test memory region 5560f7c5e000 (2248704 bytes)\r\n*** Preparing to test memory region 5560f9579000 (135168 bytes)\r\n*** Preparing to test memory region 7fa74a400000 (216006656 bytes)\r\n*** Preparing to test memory region 7fa7572fd000 (296747008 bytes)\r\n*** Preparing to test memory region 7fa768dfe000 (8388608 bytes)\r\n*** Preparing to test memory region 7fa7695ff000 (8388608 bytes)\r\n*** Preparing to test memory region 7fa769e00000 (8388608 bytes)\r\n*** Preparing to test memory region 7fa76a600000 (8388608 bytes)\r\n*** Preparing to test memory region 7fa76af59000 (24576 bytes)\r\n*** Preparing to test memory region 7fa76b11c000 (16384 bytes)\r\n*** Preparing to test memory region 7fa76b13d000 (16384 bytes)\r\n*** Preparing to test memory region 7fa76b2d3000 (8192 bytes)\r\n*** Preparing to test memory region 7fa76b300000 (4096 bytes)\r\n.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n------ DUMPING CODE AROUND EIP ------\r\nSymbol: dictFind (base: 0x5560f7ae9820)\r\nModule: redis-server 0.0.0.0:6379 (base 0x5560f7ab2000)\r\n$ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\n$ objdump --adjust-vma=0x5560f7ae9820 -D -b binary -m i386:x86-64 /tmp/dump.bin\r\n------\r\n7:M 26 Feb 2023 13:42:16.949 # dump of function (hexdump of 220 bytes):\r\n415741564155415455534883ec08488b4748480347280f848f00000048837f50ff4989f44889fd740b48837f58000f848c000000488b45004c89e74c8d6d104c8d7d50ff104989c6498b5510498b45004c21f2488b1cd04885db743f488b134939d47514eb47662e0f1f840000000000488b134c39e27435488b4500488b40184885c0740d488b7d084c89e6ffd085c0751b488b5b104885db75d548837d50ff74094983c5204d39ef759d31db4883c4084889d85b5d415c415d415e415fc390be01000000e8e6f5ffffe965ffffff904883ec08e827ffffff4885c0\r\nFunction at 0x5560f7ae8ed0 is dictRehash\r\nFunction at 0x5560f7ae9820 is dictFind\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n\r\n       Please report the crash by opening an issue on github:\r\n\r\n           http://github.com/antirez/redis/issues\r\n\r\n  Suspect RAM error? Use redis-server --test-memory to verify it.\r\n```\r\n",
  "state": "open",
  "created_at": "2023-02-27T19:43:03Z",
  "updated_at": "2023-02-27T21:50:53Z",
  "closed_at": null,
  "labels": [],
  "comments_data": []
}