{
  "issue_number": 13203.0,
  "title": "[CRASH] Redis 7.2.4 crashed by signal: 6, si_code: -6",
  "body": "Greetings,\r\n\r\nI am currently utilizing the redis-server for the purpose of caching within my application. The workflow involves the reception of real-time data on a per-second basis, wherein I proceed to store these values in Redis utilizing a key:list format, with a limit of 100 elements per list. Subsequently, this data is transferred to a database. Upon completion of this transfer, all corresponding keys within Redis are removed. Then, the cycle repeats. The system have been running two days before the redis container exited with code (134).\r\n\r\n**Crash report**\r\n```\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n9:M 10 Apr 2024 06:18:32.671 # Redis 7.2.4 crashed by signal: 6, si_code: -6\r\n9:M 10 Apr 2024 06:18:32.671 # Crashed running the instruction at: 0x7a3700bdf9fc\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\n/lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x12c)[0x7a3700bdf9fc]\r\n\r\nBacktrace:\r\n/lib/x86_64-linux-gnu/libc.so.6(+0x42520)[0x7a3700b8b520]\r\n/lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x12c)[0x7a3700bdf9fc]\r\n/lib/x86_64-linux-gnu/libc.so.6(raise+0x16)[0x7a3700b8b476]\r\n/lib/x86_64-linux-gnu/libc.so.6(abort+0xd3)[0x7a3700b717f3]\r\n/lib/x86_64-linux-gnu/libc.so.6(+0x89676)[0x7a3700bd2676]\r\n/lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x2a)[0x7a3700c7f59a]\r\n/lib/x86_64-linux-gnu/libc.so.6(+0x136566)[0x7a3700c7f566]\r\n/opt/redis-stack/bin/redis-server *:6379(lindexCommand+0x20e)[0x55def2c84e5e]\r\n/opt/redis-stack/bin/redis-server *:6379(server+0x0)[0x55def2f2d8a0]\r\n\r\n------ REGISTERS ------\r\n9:M 10 Apr 2024 06:18:32.672 # \r\nRAX:0000000000000000 RBX:00007a3700b45200\r\nRCX:00007a3700bdf9fc RDX:0000000000000006\r\nRDI:0000000000000009 RSI:0000000000000009\r\nRBP:0000000000000009 RSP:00007ffce9538620\r\nR8 :00007ffce95386f0 R9 :0000000000000000\r\nR10:0000000000000008 R11:0000000000000246\r\nR12:0000000000000006 R13:0000000000000016\r\nR14:0000000000000002 R15:0000000000000001\r\nRIP:00007a3700bdf9fc EFL:0000000000000246\r\nCSGSFS:002b000000000033\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862f) -> 00007ffce9538998\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862e) -> 00007a3700b44720\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862d) -> 7d877b152d958d00\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862c) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862b) -> 7d877b152d958d00\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce953862a) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538629) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538628) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538627) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538626) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538625) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538624) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538623) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538622) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538621) -> 00007a3700898280\r\n9:M 10 Apr 2024 06:18:32.672 # (00007ffce9538620) -> 00007a3700898280\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:7.2.4\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:3a23a5ac67fe7008\r\nredis_mode:standalone\r\nos:Linux 6.5.0-27-generic x86_64\r\narch_bits:64\r\nmonotonic_clock:POSIX clock_gettime\r\nmultiplexing_api:epoll\r\natomicvar_api:c11-builtin\r\ngcc_version:11.4.0\r\nprocess_id:9\r\nprocess_supervised:no\r\nrun_id:8db3f0407ebf1b76b5832fc2bc0c0f5f9aadd0d2\r\ntcp_port:6379\r\nserver_time_usec:1712729912671594\r\nuptime_in_seconds:82714\r\nuptime_in_days:0\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:1453880\r\nexecutable:/opt/redis-stack/bin/redis-server\r\nconfig_file:\r\nio_threads_active:0\r\nlistener0:name=tcp,bind=*,bind=-::*,port=6379\r\n\r\n# Clients\r\nconnected_clients:4\r\ncluster_connections:0\r\nmaxclients:10000\r\nclient_recent_max_input_buffer:20480\r\nclient_recent_max_output_buffer:20504\r\nblocked_clients:0\r\ntracking_clients:0\r\nclients_in_timeout_table:0\r\ntotal_blocking_keys:0\r\ntotal_blocking_keys_on_nokey:0\r\n\r\n# Memory\r\nused_memory:1665544\r\nused_memory_human:1.59M\r\nused_memory_rss:21901312\r\nused_memory_rss_human:20.89M\r\nused_memory_peak:2183552\r\nused_memory_peak_human:2.08M\r\nused_memory_peak_perc:76.28%\r\nused_memory_overhead:1288528\r\nused_memory_startup:1193088\r\nused_memory_dataset:377016\r\nused_memory_dataset_perc:79.80%\r\nallocator_allocated:1812544\r\nallocator_active:8781824\r\nallocator_resident:15204352\r\ntotal_system_memory:33403666432\r\ntotal_system_memory_human:31.11G\r\nused_memory_lua:31744\r\nused_memory_vm_eval:31744\r\nused_memory_lua_human:31.00K\r\nused_memory_scripts_eval:0\r\nnumber_of_cached_scripts:0\r\nnumber_of_functions:0\r\nnumber_of_libraries:0\r\nused_memory_vm_functions:32768\r\nused_memory_vm_total:64512\r\nused_memory_vm_total_human:63.00K\r\nused_memory_functions:184\r\nused_memory_scripts:184\r\nused_memory_scripts_human:184B\r\nmaxmemory:0\r\nmaxmemory_human:0B\r\nmaxmemory_policy:noeviction\r\nallocator_frag_ratio:4.85\r\nallocator_frag_bytes:6969280\r\nallocator_rss_ratio:1.73\r\nallocator_rss_bytes:6422528\r\nrss_overhead_ratio:1.44\r\nrss_overhead_bytes:6696960\r\nmem_fragmentation_ratio:13.42\r\nmem_fragmentation_bytes:20269648\r\nmem_not_counted_for_evict:0\r\nmem_replication_backlog:0\r\nmem_total_replication_buffers:0\r\nmem_clients_slaves:0\r\nmem_clients_normal:84488\r\nmem_cluster_links:0\r\nmem_aof_buffer:0\r\nmem_allocator:jemalloc-5.3.0\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\nlazyfreed_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nasync_loading:0\r\ncurrent_cow_peak:0\r\ncurrent_cow_size:0\r\ncurrent_cow_size_age:0\r\ncurrent_fork_perc:0.00\r\ncurrent_save_keys_processed:0\r\ncurrent_save_keys_total:0\r\nrdb_changes_since_last_save:0\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1712673421\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:0\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_saves:424\r\nrdb_last_cow_size:1003520\r\nrdb_last_load_keys_expired:0\r\nrdb_last_load_keys_loaded:213\r\naof_enabled:0\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:-1\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_rewrites:0\r\naof_rewrites_consecutive_failures:0\r\naof_last_write_status:ok\r\naof_last_cow_size:0\r\nmodule_fork_in_progress:0\r\nmodule_fork_last_cow_size:0\r\n\r\n# Stats\r\ntotal_connections_received:10\r\ntotal_commands_processed:8096910560\r\ninstantaneous_ops_per_sec:96674\r\ntotal_net_input_bytes:408947426582\r\ntotal_net_output_bytes:406652407660\r\ntotal_net_repl_input_bytes:0\r\ntotal_net_repl_output_bytes:0\r\ninstantaneous_input_kbps:4769.19\r\ninstantaneous_output_kbps:4747.82\r\ninstantaneous_input_repl_kbps:0.00\r\ninstantaneous_output_repl_kbps:0.00\r\nrejected_connections:0\r\nsync_full:0\r\nsync_partial_ok:0\r\nsync_partial_err:0\r\nexpired_keys:0\r\nexpired_stale_perc:0.00\r\nexpired_time_cap_reached_count:0\r\nexpire_cycle_cpu_milliseconds:348\r\nevicted_keys:0\r\nevicted_clients:0\r\ntotal_eviction_exceeded_time:0\r\ncurrent_eviction_exceeded_time:0\r\nkeyspace_hits:7972382342\r\nkeyspace_misses:53395\r\npubsub_channels:0\r\npubsub_patterns:0\r\npubsubshard_channels:0\r\nlatest_fork_usec:259\r\ntotal_forks:424\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\ntotal_active_defrag_time:0\r\ncurrent_active_defrag_time:0\r\ntracking_total_keys:0\r\ntracking_total_items:0\r\ntracking_total_prefixes:0\r\nunexpected_error_replies:0\r\ntotal_error_replies:0\r\ndump_payload_sanitizations:0\r\ntotal_reads_processed:81752319\r\ntotal_writes_processed:81753030\r\nio_threaded_reads_processed:0\r\nio_threaded_writes_processed:0\r\nreply_buffer_shrinks:15861\r\nreply_buffer_expands:47311\r\neventloop_cycles:82124693\r\neventloop_duration_sum:2887565653\r\neventloop_duration_cmd_sum:1492045457\r\ninstantaneous_eventloop_cycles_per_sec:911\r\ninstantaneous_eventloop_duration_usec:54\r\nacl_access_denied_auth:0\r\nacl_access_denied_cmd:0\r\nacl_access_denied_key:0\r\nacl_access_denied_channel:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:0\r\nmaster_failover_state:no-failover\r\nmaster_replid:45446aa02e4549c31c33a978069bff00cdf2cf69\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:0\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:0\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0\r\nrepl_backlog_histlen:0\r\n\r\n# CPU\r\nused_cpu_sys:455.564253\r\nused_cpu_user:2569.047655\r\nused_cpu_sys_children:0.132226\r\nused_cpu_user_children:0.444681\r\nused_cpu_sys_main_thread:452.858630\r\nused_cpu_user_main_thread:2563.903713\r\n\r\n# Modules\r\nmodule:name=search,ver=20813,api=1,filters=0,usedby=[],using=[ReJSON],options=[handle-io-errors]\r\nmodule:name=RedisCompat,ver=1,api=1,filters=0,usedby=[],using=[],options=[]\r\nmodule:name=redisgears_2,ver=20020,api=1,filters=0,usedby=[],using=[],options=[]\r\nmodule:name=timeseries,ver=11012,api=1,filters=0,usedby=[],using=[],options=[]\r\nmodule:name=ReJSON,ver=20610,api=1,filters=0,usedby=[search],using=[],options=[handle-io-errors]\r\nmodule:name=bf,ver=20612,api=1,filters=0,usedby=[],using=[],options=[]\r\n\r\n# Commandstats\r\ncmdstat_keys:calls=43722553,usec=323293037,usec_per_call=7.39,rejected_calls=0,failed_calls=0\r\ncmdstat_lindex:calls=7972388189,usec=657748416,usec_per_call=0.08,rejected_calls=0,failed_calls=0\r\ncmdstat_set:calls=1776,usec=2097,usec_per_call=1.18,rejected_calls=0,failed_calls=0\r\ncmdstat_rpush:calls=4654975,usec=1010346,usec_per_call=0.22,rejected_calls=0,failed_calls=0\r\ncmdstat_multi:calls=38024730,usec=2400862,usec_per_call=0.06,rejected_calls=0,failed_calls=0\r\ncmdstat_flushdb:calls=1,usec=69,usec_per_call=69.00,rejected_calls=0,failed_calls=0\r\ncmdstat_config|get:calls=1,usec=5,usec_per_call=5.00,rejected_calls=0,failed_calls=0\r\ncmdstat_lrange:calls=47105,usec=109866,usec_per_call=2.33,rejected_calls=0,failed_calls=0\r\ncmdstat_info:calls=5,usec=107,usec_per_call=21.40,rejected_calls=0,failed_calls=0\r\ncmdstat_del:calls=46480,usec=25185,usec_per_call=0.54,rejected_calls=0,failed_calls=0\r\ncmdstat_exec:calls=38024729,usec=1166351489,usec_per_call=30.67,rejected_calls=0,failed_calls=0\r\ncmdstat_get:calls=16,usec=5,usec_per_call=0.31,rejected_calls=0,failed_calls=0\r\n\r\n# Errorstats\r\n\r\n# Latencystats\r\nlatency_percentiles_usec_keys:p50=8.031,p99=15.039,p99.9=20.095\r\nlatency_percentiles_usec_lindex:p50=0.001,p99=1.003,p99.9=1.003\r\nlatency_percentiles_usec_set:p50=0.001,p99=8.031,p99.9=11.007\r\nlatency_percentiles_usec_rpush:p50=0.001,p99=2.007,p99.9=7.007\r\nlatency_percentiles_usec_multi:p50=0.001,p99=1.003,p99.9=1.003\r\nlatency_percentiles_usec_flushdb:p50=69.119,p99=69.119,p99.9=69.119\r\nlatency_percentiles_usec_config|get:p50=5.023,p99=5.023,p99.9=5.023\r\nlatency_percentiles_usec_lrange:p50=2.007,p99=4.015,p99.9=7.007\r\nlatency_percentiles_usec_info:p50=18.047,p99=48.127,p99.9=48.127\r\nlatency_percentiles_usec_del:p50=0.001,p99=2.007,p99.9=13.055\r\nlatency_percentiles_usec_exec:p50=29.055,p99=52.223,p99.9=71.167\r\nlatency_percentiles_usec_get:p50=0.001,p99=1.003,p99.9=1.003\r\n\r\n# Cluster\r\ncluster_enabled:0\r\n\r\n# Keyspace\r\ndb0:keys=218,expires=0,avg_ttl=0\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=19 addr=172.17.0.1:50114 laddr=172.17.0.2:6379 fd=16 name= age=82440 idle=0 flags=x db=0 sub=0 psub=0 ssub=0 multi=210 qbuf=10728 qbuf-free=9746 argv-mem=4 multi-mem=10909 rbs=8192 rbp=5047 obl=2121 oll=0 omem=0 tot-mem=46649 events=r cmd=exec user=default redir=-1 resp=2 lib-name= lib-ver=\r\nid=20 addr=172.17.0.1:34022 laddr=172.17.0.2:6379 fd=17 name= age=82435 idle=0 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=20474 argv-mem=0 multi-mem=0 rbs=8192 rbp=5047 obl=0 oll=0 omem=0 tot-mem=29568 events=r cmd=keys user=default redir=-1 resp=2 lib-name= lib-ver=\r\nid=21 addr=172.17.0.1:34032 laddr=172.17.0.2:6379 fd=18 name= age=82435 idle=1 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=20474 argv-mem=0 multi-mem=0 rbs=2048 rbp=1024 obl=0 oll=0 omem=0 tot-mem=23424 events=r cmd=exec user=default redir=-1 resp=2 lib-name= lib-ver=\r\nid=22 addr=172.17.0.1:34034 laddr=172.17.0.2:6379 fd=19 name= age=82433 idle=82332 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=0 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=0 omem=0 tot-mem=1928 events=r cmd=exec user=default redir=-1 resp=2 lib-name= lib-ver=\r\n\r\n------ CURRENT CLIENT INFO ------\r\nid=19 addr=172.17.0.1:50114 laddr=172.17.0.2:6379 fd=16 name= age=82440 idle=0 flags=x db=0 sub=0 psub=0 ssub=0 multi=210 qbuf=10728 qbuf-free=9746 argv-mem=4 multi-mem=10909 rbs=8192 rbp=5047 obl=2121 oll=0 omem=0 tot-mem=46649 events=r cmd=exec user=default redir=-1 resp=2 lib-name= lib-ver=\r\nargc: '3'\r\nargv[0]: '\"LINDEX\"'\r\nargv[1]: '\"Input Data:S1_V1L_POS\"'\r\nargv[2]: '\"-1\"'\r\n9:M 10 Apr 2024 06:18:32.672 # key 'Input Data:S1_V1L_POS' found in DB containing the following object:\r\n9:M 10 Apr 2024 06:18:32.672 # Object type: 1\r\n9:M 10 Apr 2024 06:18:32.672 # Object encoding: 11\r\n9:M 10 Apr 2024 06:18:32.672 # Object refcount: 1\r\n\r\n------ EXECUTING CLIENT INFO ------\r\nid=19 addr=172.17.0.1:50114 laddr=172.17.0.2:6379 fd=16 name= age=82440 idle=0 flags=x db=0 sub=0 psub=0 ssub=0 multi=210 qbuf=10728 qbuf-free=9746 argv-mem=4 multi-mem=10909 rbs=8192 rbp=5047 obl=2121 oll=0 omem=0 tot-mem=46649 events=r cmd=exec user=default redir=-1 resp=2 lib-name= lib-ver=\r\nargc: '3'\r\nargv[0]: '\"LINDEX\"'\r\nargv[1]: '\"Input Data:S1_V1L_POS\"'\r\nargv[2]: '\"-1\"'\r\n9:M 10 Apr 2024 06:18:32.672 # key 'Input Data:S1_V1L_POS' found in DB containing the following object:\r\n9:M 10 Apr 2024 06:18:32.672 # Object type: 1\r\n9:M 10 Apr 2024 06:18:32.672 # Object encoding: 11\r\n9:M 10 Apr 2024 06:18:32.672 # Object refcount: 1\r\n\r\n------ MODULES INFO OUTPUT ------\r\n# search_version\r\nsearch_version:2.8.13\r\nsearch_redis_version:7.2.4 - oss\r\n\r\n# search_index\r\nsearch_number_of_indexes:0\r\n\r\n# search_fields_statistics\r\n\r\n# search_dialect_statistics\r\nsearch_dialect_1:0\r\nsearch_dialect_2:0\r\nsearch_dialect_3:0\r\nsearch_dialect_4:0\r\n\r\n# search_runtime_configurations\r\nsearch_concurrent_mode:OFF\r\nsearch_enableGC:ON\r\nsearch_minimal_term_prefix:2\r\nsearch_maximal_prefix_expansions:200\r\nsearch_query_timeout_ms:500\r\nsearch_timeout_policy:return\r\nsearch_cursor_read_size:1000\r\nsearch_cursor_max_idle_time:300000\r\nsearch_max_doc_table_size:1000000\r\nsearch_max_search_results:10000\r\nsearch_max_aggregate_results:10000\r\nsearch_search_pool_size:20\r\nsearch_index_pool_size:8\r\nsearch_gc_scan_size:100\r\nsearch_min_phonetic_term_length:3\r\n\r\n# redisgears_2_trace\r\nredisgears_2_backtrace:   0: redis_module::basic_info_command_handler\r\n   1: redisgears::gears_module::__info_func\r\n   2: modulesCollectInfo\r\n             at /__w/redis-stack/redis-stack/redis/src/module.c:10293:9\r\n   3: logModulesInfo\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:1900:22\r\n      printCrashReport\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:2183:5\r\n   4: sigsegvHandler\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:2164:5\r\n   5: <unknown>\r\n   6: pthread_kill\r\n   7: gsignal\r\n   8: abort\r\n   9: <unknown>\r\n  10: __fortify_fail\r\n  11: __stack_chk_fail\r\n  12: lindexCommand\r\n             at /__w/redis-stack/redis-stack/redis/src/t_list.c:620:1\r\n  13: <unknown>\r\n\r\n\r\n# redisgears_2_UninitialisedBackends\r\nredisgears_2_backend_name:js\r\n\r\n# ReJSON_trace\r\nReJSON_backtrace:   0: redis_module::basic_info_command_handler\r\n   1: rejson::__info_func\r\n   2: modulesCollectInfo\r\n             at /__w/redis-stack/redis-stack/redis/src/module.c:10293:9\r\n   3: logModulesInfo\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:1900:22\r\n      printCrashReport\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:2183:5\r\n   4: sigsegvHandler\r\n             at /__w/redis-stack/redis-stack/redis/src/debug.c:2164:5\r\n   5: <unknown>\r\n   6: pthread_kill\r\n   7: gsignal\r\n   8: abort\r\n   9: <unknown>\r\n  10: __fortify_fail\r\n  11: __stack_chk_fail\r\n  12: lindexCommand\r\n             at /__w/redis-stack/redis-stack/redis/src/t_list.c:620:1\r\n  13: <unknown>\r\n\r\n\r\n------ CONFIG DEBUG OUTPUT ------\r\nproto-max-bulk-len 512mb\r\nsanitize-dump-payload no\r\nlazyfree-lazy-user-flush no\r\nrepl-diskless-sync yes\r\nio-threads 1\r\nio-threads-do-reads no\r\nlist-compress-depth 0\r\nlazyfree-lazy-user-del no\r\nreplica-read-only yes\r\nlazyfree-lazy-expire no\r\nclient-query-buffer-limit 1gb\r\nactivedefrag no\r\nrepl-diskless-load disabled\r\nslave-read-only yes\r\nlazyfree-lazy-eviction no\r\nlazyfree-lazy-server-del no\r\n\r\n------ FAST MEMORY TEST ------\r\n9:M 10 Apr 2024 06:18:32.698 # Bio worker thread #0 terminated\r\n9:M 10 Apr 2024 06:18:32.698 # Bio worker thread #1 terminated\r\n9:M 10 Apr 2024 06:18:32.698 # Bio worker thread #2 terminated\r\n*** Preparing to test memory region 55def2f1a000 (704512 bytes)\r\n*** Preparing to test memory region 55def356f000 (450560 bytes)\r\n*** Preparing to test memory region 7a36ec000000 (135168 bytes)\r\n*** Preparing to test memory region 7a36f0840000 (6291456 bytes)\r\n*** Preparing to test memory region 7a36f2400000 (6291456 bytes)\r\n*** Preparing to test memory region 7a36f2b60000 (5242880 bytes)\r\n*** Preparing to test memory region 7a36f4000000 (135168 bytes)\r\n*** Preparing to test memory region 7a36f85f0000 (4194304 bytes)\r\n*** Preparing to test memory region 7a36f8a00000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36f9200000 (2097152 bytes)\r\n*** Preparing to test memory region 7a36f9600000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36f9e00000 (4194304 bytes)\r\n*** Preparing to test memory region 7a36fa35b000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36fab5c000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36fb35d000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36fbb5e000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36fdda9000 (159744 bytes)\r\n*** Preparing to test memory region 7a36fddd0000 (3670016 bytes)\r\n*** Preparing to test memory region 7a36fe4eb000 (8192 bytes)\r\n*** Preparing to test memory region 7a36fea4d000 (12288 bytes)\r\n*** Preparing to test memory region 7a36fea51000 (8388608 bytes)\r\n*** Preparing to test memory region 7a36ff252000 (8388608 bytes)\r\n*** Preparing to test memory region 7a3700079000 (28672 bytes)\r\n*** Preparing to test memory region 7a3700080000 (9961472 bytes)\r\n*** Preparing to test memory region 7a3700b12000 (4096 bytes)\r\n*** Preparing to test memory region 7a3700b44000 (20480 bytes)\r\n*** Preparing to test memory region 7a3700d65000 (53248 bytes)\r\n*** Preparing to test memory region 7a37011b3000 (12288 bytes)\r\n*** Preparing to test memory region 7a3701343000 (8192 bytes)\r\n*** Preparing to test memory region 7a370137c000 (4096 bytes)\r\n.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n------ DUMPING CODE AROUND EIP ------\r\nSymbol: pthread_kill (base: 0x7a3700bdf8d0)\r\nModule: /lib/x86_64-linux-gnu/libc.so.6 (base 0x7a3700b49000)\r\n$ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\n$ objdump --adjust-vma=0x7a3700bdf8d0 -D -b binary -m i386:x86-64 /tmp/dump.bin\r\n------\r\n9:M 10 Apr 2024 06:18:32.842 # dump of function (hexdump of 428 bytes):\r\nf30f1efa41568d56e0415541bd16000000415455534881ec9000000064488b042528000000488984248800000031c083fa01767e4889fb4189f464483b3c25100000000f84c70000004989e641ba0800000031ffb80e0000004c89f2488d352dc113000f0531c0488dab74090000ba01000000f00fb155000f85ca00000080bb730900000074594531ed31d287937409000083fa010f8fbd00000041ba0800000031d24c89f6bf02000000b80e0000000f05488b84248800000064482b0425280000000f859c0000004881c4900000004489e85b5d415c415d415ec30f1f4000448babd0020000e8845605004489e289c74489eeb8ea0000000f053d00f0ffff76854189c541f7ddeb80660f1f440000b8ba0000000f0589c5e8525605004489e289ee89c7b8ea0000000f054189c541f7dd3d00f0ffffb800000000440f46e8e96dffffff0f1f004889efe810a8ffffe929ffffff0f1f004889efe8d0a8ffffe936ffffffe816fb0900660f1f440000f30f1efac3662e0f1f840000000000904157415641554154554889fd534883ec2864488b042528000000488944241831c0648b0425d0020000894424\r\nFunction at 0x7a3700c35040 is getpid\r\nFunction at 0x7a3700c7f550 is __stack_chk_fail\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n\r\n       Please report the crash by opening an issue on github:\r\n\r\n           http://github.com/redis/redis/issues\r\n\r\n  If a Redis module was involved, please open in the module's repo instead.\r\n\r\n  Suspect RAM error? Use redis-server --test-memory to verify it.\r\n\r\n  Some other issues could be detected by redis-server --check-system\r\nAborted (core dumped)\r\n```\r\n\r\nOS: Ubuntu 22.04\r\n\r\n\r\nPS: \r\nAdditionally, upon inspecting the logs preceding the occurrence of a crash, I have observed the recurrence of the message:\r\n```\r\n9:M 09 Apr 2024 05:05:28.081 * 10000 changes in 60 seconds. Saving...\r\n9:M 09 Apr 2024 05:05:28.081 * Background saving started by pid 288\r\n288:C 09 Apr 2024 05:05:28.084 * DB saved on disk\r\n288:C 09 Apr 2024 05:05:28.084 * Fork CoW for RDB: current 0 MB, peak 0 MB, average 0 MB\r\n```\r\nwhere PID incrementally increases until reaching 288, subsequently resulting in a sigterm signal and what appears to be the automatic restart of the redis-server. For the moment of crash, the PID was 451.\r\n```\r\n9:signal-handler (1712639140) Received SIGTERM scheduling shutdown...\r\n9:signal-handler (1712639140) Received SIGTERM scheduling shutdown...\r\n9:C 09 Apr 2024 07:19:58.567 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\r\n9:C 09 Apr 2024 07:19:58.567 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo\r\n```\r\nTo address the crash issue, I enabled overcommit and configured forced restart in case of crash. But i would like to know the root cause of these crashes for further investigation and resolution.\r\n\r\n\r\n\r\n",
  "state": "open",
  "created_at": "2024-04-11T00:50:33Z",
  "updated_at": "2024-07-17T05:49:33Z",
  "closed_at": null,
  "labels": [
    "crash report"
  ],
  "comments_data": [
    {
      "id": 2048842976,
      "user": "sundb",
      "created_at": "2024-04-11T02:51:47Z",
      "body": "it's strange that signal SIGTERM is send by the user.\r\nare the signal and the crash at the same time?"
    },
    {
      "id": 2048979473,
      "user": "doxg",
      "created_at": "2024-04-11T06:01:40Z",
      "body": "@sundb Looking at the time, the SIGTERM was logged 40mins prior to crash. At the log time, no user could have transmitted a shutdown directive to the container. Within the application, the permissible operations are setting, retrieving, and deleting. In the case of application failure, it may disconnect from the container, yet it does not initiate the shutdown process for the container."
    },
    {
      "id": 2054410260,
      "user": "sundb",
      "created_at": "2024-04-15T02:24:22Z",
      "body": "@doxg what operation system and version are you using? and how did you install Redis?"
    },
    {
      "id": 2076826685,
      "user": "oranagra",
      "created_at": "2024-04-25T10:06:14Z",
      "body": "i don't think it's SIGTERM sent by a user, it's a fortification assertion. involving LINDEX on a listpack.\r\nif you happen to learn how to reproduce it, please send the reproduction privately to redis@redis.io"
    },
    {
      "id": 2084499662,
      "user": "doxg",
      "created_at": "2024-04-30T06:45:41Z",
      "body": "@sundb I apologize for late replies. It's Ubuntu 22.04. I installed redis container following tutorial on official website.\r\nhttps://redis.io/docs/latest/operate/oss_and_stack/install/install-stack/docker/\r\n\r\n"
    },
    {
      "id": 2084506742,
      "user": "doxg",
      "created_at": "2024-04-30T06:49:01Z",
      "body": "@oranagra I apologize for late replies. I wasn't able to reproduce the issue, but I did stumble upon an intriguing case. Upon investigation, I discovered hardware issues with the current server and requested a replacement. Interestingly, this error hasn't occurred on other machines running different operating systems, such as Ubuntu 18 and Windows 10."
    },
    {
      "id": 2088028481,
      "user": "oranagra",
      "created_at": "2024-05-01T06:07:02Z",
      "body": "interesting, what type of hardware was it and what was the HW error?\r\nmaybe we can blame non-ECC memory for a corruption that led to this."
    }
  ]
}