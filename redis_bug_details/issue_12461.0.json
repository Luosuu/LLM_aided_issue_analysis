{
  "issue_number": 12461.0,
  "title": "[BUG] execute redis-cli --cluster add-node command no return for long time",
  "body": "**Describe the bug**\r\n\r\nA short description of the bug.\r\n\r\nmy redis cluster have problem like this:\r\n\r\n```sh\r\nroot@175-69-174-222:~# kubectl logs -f --tail 999 -n redis-system redis-operator-7578f7c544-nmn2b ^C\r\nroot@175-69-174-222:~# kubectl get pods -n redis-system -owide\r\nNAME                              READY   STATUS    RESTARTS      AGE   IP              NODE    NOMINATED NODE   READINESS GATES\r\nredis-follower-0                  2/2     Running   0             20h   10.233.74.122   node4   <none>           <none>\r\nredis-follower-1                  2/2     Running   0             20h   10.233.74.127   node4   <none>           <none>\r\nredis-follower-2                  2/2     Running   0             19h   10.233.74.89    node4   <none>           <none>\r\nredis-leader-0                    2/2     Running   0             20h   10.233.74.82    node4   <none>           <none>\r\nredis-leader-1                    2/2     Running   0             19h   10.233.74.75    node4   <none>           <none>\r\nredis-leader-2                    2/2     Running   0             19h   10.233.74.110   node4   <none>           <none>\r\nredis-operator-7578f7c544-nmn2b   1/1     Running   8 (17h ago)   20h   10.233.74.91    node4   <none>           <none>\r\nroot@175-69-174-222:~#\r\nroot@175-69-174-222:~#\r\nroot@175-69-174-222:~# kubectl exec  -n redis-system redis-leader-0 -- redis-cli  cluster info\r\nDefaulting container name to redis-leader.\r\nUse 'kubectl describe pod/redis-leader-0 -n redis-system' to see all of the containers in this pod.\r\nNOAUTH Authentication required.\r\nroot@175-69-174-222:~# kubectl exec  -n redis-system redis-leader-0 -- redis-cli  cluster infokubectl exec  -n redis-system redis-leader-0 -- redis-cli -c -a <password> cluster^C\r\nroot@175-69-174-222:~#\r\nroot@175-69-174-222:~#\r\nroot@175-69-174-222:~# kubectl exec  -n redis-system redis-leader-0 -- redis-cli -c -a <password> cluster info\r\nDefaulting container name to redis-leader.\r\nUse 'kubectl describe pod/redis-leader-0 -n redis-system' to see all of the containers in this pod.\r\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\r\ncluster_state:fail\r\ncluster_slots_assigned:16384\r\ncluster_slots_ok:5461\r\ncluster_slots_pfail:10923\r\ncluster_slots_fail:0\r\ncluster_known_nodes:5\r\ncluster_size:3\r\ncluster_current_epoch:15\r\ncluster_my_epoch:1\r\ncluster_stats_messages_ping_sent:4\r\ncluster_stats_messages_sent:4\r\ncluster_stats_messages_received:0\r\nroot@175-69-174-222:~#\r\nroot@175-69-174-222:~# kubectl exec  -n redis-system redis-leader-0 -- redis-cli -c -a <password> cluster nodes\r\nDefaulting container name to redis-leader.\r\nUse 'kubectl describe pod/redis-leader-0 -n redis-system' to see all of the containers in this pod.\r\n58913a2fbf0932adc3c829c906cfa43d596c37ef 10.233.100.184:6379@16379 master,fail? - 1691046710926 1691046673341 14 connected 5461-10922\r\n4d0a34c58279aa8b5f18ce8e2c31226bdfecf293 10.233.100.191:6379@16379 master,fail? - 1691046710926 1691046673341 6 connected 10923-16383\r\n1ca641a43263880e7cf7384be8e6c3594cbca777 10.233.74.92:6379@16379 slave,fail? 4d0a34c58279aa8b5f18ce8e2c31226bdfecf293 1691046710926 1691046673341 6 connected\r\nfb0c88d0b27936956ec71975792e994c55b6f0bc 10.233.74.82:6379@16379 myself,master - 0 1691046673341 1 connected 0-5460\r\nbca2cc8acc12c7afae82ac580ae87f1f8c477c40 10.233.74.72:6379@16379 slave,fail? 58913a2fbf0932adc3c829c906cfa43d596c37ef 1691046710926 1691046673341 14 connected\r\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\r\nroot@175-69-174-222:~#\r\n```\r\n\r\nI want to solve  this problem by execute  redis-cli --cluster add-node command，like this: `redis-cli --cluster add-node 10.233.74.71:6379 10.233.74.65:6379 --cluster-slave -a <password>`\r\n\r\nbut this command no return for long time.\r\n\r\n```sh\r\nbash-4.4$ time redis-cli --cluster add-node 10.233.74.89:6379 10.233.74.110:6379 --cluster-slave -a <password>\r\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\r\n>>> Adding node 10.233.74.89:6379 to cluster 10.233.74.110:6379\r\n\r\n^C\r\n\r\nreal    1m40.952s\r\nuser    0m0.000s\r\nsys     0m0.002s\r\nbash-4.4$\r\n```\r\n\r\n**To reproduce**\r\n\r\nredis version:  6.2.6\r\nredis config like this:\r\n```conf\r\nbind 0.0.0.0\r\nprotected-mode yes\r\ntcp-backlog 511\r\ntimeout 0\r\ntcp-keepalive 300\r\ndaemonize no\r\nsupervised no\r\npidfile /var/run/redis.pid\r\nmasterauth <password>\r\nrequirepass <password>\r\ncluster-enabled yes\r\ncluster-node-timeout 5000\r\ncluster-require-full-coverage no\r\ncluster-migration-barrier 1\r\ncluster-config-file /data/nodes.conf\r\nsave 900 1\r\nsave 300 10\r\nsave 60 10000\r\nappendonly yes\r\nappendfilename \"appendonly.aof\"\r\ndir /data\r\n```\r\n\r\n**Expected behavior**\r\n\r\nI want to learn how to resolve this problem\r\nwhen i execute “redis-cli --cluster add-node” command, what does redis do ?\r\n\r\n**Additional information**\r\n\r\nAny additional information that is relevant to the problem.\r\n",
  "state": "open",
  "created_at": "2023-08-04T03:31:05Z",
  "updated_at": "2023-08-04T03:31:05Z",
  "closed_at": null,
  "labels": [],
  "comments_data": []
}