{
  "issue_number": 13302.0,
  "title": "[CRASH] New Redis 6.2.6 Crash ",
  "body": "**Crash report**\r\n[redis6_crash_report_May24.txt](https://github.com/redis/redis/files/15487701/redis6_crash_report_May24.txt)\r\n\r\n```\r\nMay 23 21:22:37.231768+00:00 2024 leaf5 INFO database#supervisord: redis6 === REDIS BUG REPORT START: Cut & paste starting from here ===\r\nMay 23 21:22:37.232176+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.231 # Redis 6.2.6 crashed by signal: 11, si_code: 1\r\nMay 23 21:22:37.232600+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.232 # Accessing address: 0xffffffff830ff539\r\nMay 23 21:22:37.232749+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.232 # Crashed running the instruction at: 0x55e587d110f9\r\nMay 23 21:22:37.234150+00:00 2024 leaf5 INFO database#supervisord: redis6\r\nMay 23 21:22:37.234150+00:00 2024 leaf5 INFO database#supervisord: redis6 ------ STACK TRACE ------\r\nMay 23 21:22:37.234545+00:00 2024 leaf5 INFO database#supervisord: redis6 EIP:\r\nMay 23 21:22:37.234895+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(sdsMakeRoomFor+0x429)[0x55e587d110f9]\r\nMay 23 21:22:37.235203+00:00 2024 leaf5 INFO database#supervisord: redis6\r\nMay 23 21:22:37.235203+00:00 2024 leaf5 INFO database#supervisord: redis6 Backtrace:\r\nMay 23 21:22:37.235482+00:00 2024 leaf5 INFO database#supervisord: redis6 /lib/x86_64-linux-gnu/libpthread.so.0(+0x13140)[0x7f5a6dee7140]\r\nMay 23 21:22:37.235792+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(sdsMakeRoomFor+0x429)[0x55e587d110f9]\r\nMay 23 21:22:37.236126+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(sdscatlen+0x44)[0x55e587d11794]\r\nMay 23 21:22:37.236469+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(notifyKeyspaceEvent+0xd6)[0x55e587d89fe6]\r\nMay 23 21:22:37.236787+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(hsetCommand+0xf9)[0x55e587d51819]\r\nMay 23 21:22:37.237001+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(call+0xb1)[0x55e587d09bb1]\r\nMay 23 21:22:37.237323+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(luaRedisGenericCommand+0x3b9)[0x55e587d76df9]\r\nMay 23 21:22:37.237749+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x117858)[0x55e587dd1858]\r\nMay 23 21:22:37.237993+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x122020)[0x55e587ddc020]\r\nMay 23 21:22:37.238379+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x117ef5)[0x55e587dd1ef5]\r\nMay 23 21:22:37.238674+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x1171eb)[0x55e587dd11eb]\r\nMay 23 21:22:37.238994+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x1180a0)[0x55e587dd20a0]\r\nMay 23 21:22:37.239335+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(lua_pcall+0x58)[0x55e587dcf468]\r\nMay 23 21:22:37.239686+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(evalGenericCommand+0x1ff)[0x55e587d743ff]\r\nMay 23 21:22:37.240007+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(call+0xb1)[0x55e587d09bb1]\r\nMay 23 21:22:37.240352+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(processCommand+0x5b3)[0x55e587d0aab3]\r\nMay 23 21:22:37.240687+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(processInputBuffer+0xf8)[0x55e587d1f738]\r\nMay 23 21:22:37.241010+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(+0x10513c)[0x55e587dbf13c]\r\nMay 23 21:22:37.241348+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(aeProcessEvents+0x2c2)[0x55e587d02032]\r\nMay 23 21:22:37.241695+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(aeMain+0x1d)[0x55e587d022bd]\r\nMay 23 21:22:37.242002+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(main+0x337)[0x55e587cfe307]\r\nMay 23 21:22:37.242311+00:00 2024 leaf5 INFO database#supervisord: redis6 /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xea)[0x7f5a6dd21d0a]\r\nMay 23 21:22:37.242637+00:00 2024 leaf5 INFO database#supervisord: redis6 /usr/bin/redis-server 127.0.0.1:63796(_start+0x2a)[0x55e587cfe83a]\r\nMay 23 21:22:37.242906+00:00 2024 leaf5 INFO database#supervisord: redis6\r\nMay 23 21:22:37.243008+00:00 2024 leaf5 INFO database#supervisord: redis6 ------ REGISTERS ------\r\nMay 23 21:22:37.243229+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 #\r\nMay 23 21:22:37.243383+00:00 2024 leaf5 INFO database#supervisord: redis6 RAX:ffffffff830ff539 RBX:0000000000000001\r\nMay 23 21:22:37.243383+00:00 2024 leaf5 INFO database#supervisord: redis6 RCX:000055e587e5d7e0 RDX:000055e587d10df1\r\nMay 23 21:22:37.243383+00:00 2024 leaf5 INFO database#supervisord: redis6 RDI:00007f5a6abb0001 RSI:0000000000000001\r\nMay 23 21:22:37.243558+00:00 2024 leaf5 INFO database#supervisord: redis6 RBP:00007f5a6abb0001 RSP:00007ffd00e4eda0\r\nMay 23 21:22:37.243558+00:00 2024 leaf5 INFO database#supervisord: redis6 R8 :000000007cf00ac8 R9 :00007ffd00e4ee40\r\nMay 23 21:22:37.243558+00:00 2024 leaf5 INFO database#supervisord: redis6 R10:0000000000000000 R11:0000000000000032\r\nMay 23 21:22:37.243766+00:00 2024 leaf5 INFO database#supervisord: redis6 R12:0000000000000002 R13:000000000000000b\r\nMay 23 21:22:37.243766+00:00 2024 leaf5 INFO database#supervisord: redis6 R14:00007f5a6abb0001 R15:00007ffd00e4ee40\r\nMay 23 21:22:37.243766+00:00 2024 leaf5 INFO database#supervisord: redis6 RIP:000055e587d110f9 EFL:0000000000010206\r\nMay 23 21:22:37.243766+00:00 2024 leaf5 INFO database#supervisord: redis6 CSGSFS:002b000000000033\r\nMay 23 21:22:37.244601+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edaf) -> 0000000000000002\r\nMay 23 21:22:37.244776+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edae) -> 00007f5a6ad260a8\r\nMay 23 21:22:37.244776+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edad) -> 0000000000000001\r\nMay 23 21:22:37.244776+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edac) -> 00007f5a6ad260a8\r\nMay 23 21:22:37.244776+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edab) -> 000055e587d11794\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4edaa) -> 00007ffd00e4ee40\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda9) -> 00007f5a6abb0001\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda8) -> 000000000000000b\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda7) -> 0000000000000002\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda6) -> 00007ffd00e4ee40\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda5) -> 0000000000000001\r\nMay 23 21:22:37.245069+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda4) -> 000000000000000b\r\nMay 23 21:22:37.245474+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda3) -> 23cd2b772c1c5d00\r\nMay 23 21:22:37.245474+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda2) -> 00007f5a6abb0000\r\nMay 23 21:22:37.245474+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda1) -> 00007ffd00e4ede0\r\nMay 23 21:22:37.245474+00:00 2024 leaf5 INFO database#supervisord: redis6 75:M 23 May 2024 21:22:37.243 # (00007ffd00e4eda0) -> 00007f5a6a6b0000\r\nMay 23 21:22:37.245474+00:00 2024 leaf5 INFO database#supervisord: redis6\r\n\r\n```\r\nFull crash report attached.\r\n",
  "state": "open",
  "created_at": "2024-05-29T16:38:59Z",
  "updated_at": "2024-06-17T08:52:46Z",
  "closed_at": null,
  "labels": [
    "crash report"
  ],
  "comments_data": [
    {
      "id": 2151382839,
      "user": "sg893052",
      "created_at": "2024-06-06T04:21:28Z",
      "body": "@oranagra @sundb  Could you please share your valuable inputs on this? Thanks!"
    },
    {
      "id": 2151591276,
      "user": "sundb",
      "created_at": "2024-06-06T07:29:42Z",
      "body": "@sg893052 can you give the notification config? or other special configs?"
    },
    {
      "id": 2151779277,
      "user": "sg893052",
      "created_at": "2024-06-06T09:04:28Z",
      "body": "> @sg893052 can you give the notification config? or other special configs? @sundb I have attached the redis.conf file\r\n[docker-database-redis.conf.txt](https://github.com/user-attachments/files/15612580/docker-database-redis.conf.txt)\r\n\r\nAlso, attaching the supervisord.conf file for how the different redis server instances are spawned inside docker-database container. The problem occurred at redis6 instance. \r\n[docker-database-supervisord.conf.txt](https://github.com/user-attachments/files/15612635/docker-database-supervisord.conf.txt)\r\n\r\n\r\nInside docker-database container:\r\n```\r\nroot@sonic:/# ps aux\r\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\r\nroot           1  0.0  0.1  33624 25988 pts/0    Ss+  Jun05   0:27 /usr/bin/python3 /usr/local/bin/supervisord\r\nroot          68  0.0  0.0   2480  1568 pts/0    S    Jun05   0:00 sh /usr/bin/supervisor-proc-exit-listener --container-name database\r\nroot          70  0.5  0.1 122512 26116 pts/0    Sl   Jun05   7:38 /usr/bin/redis-server 127.0.0.1:6379\r\nroot          71  0.3  0.1  78344 16620 pts/0    Sl   Jun05   4:37 /usr/bin/redis-server 127.0.0.1:63792\r\nroot          75  0.1  0.1  65660 15768 pts/0    Sl   Jun05   1:50 /usr/bin/redis-server 127.0.0.1:63793\r\nroot          83  0.1  0.0  62340 13544 pts/0    Sl   Jun05   1:28 /usr/bin/redis-server 127.0.0.1:63794\r\nroot          90  2.5  0.1  69548 18556 pts/0    Sl   Jun05  33:21 /usr/bin/redis-server 127.0.0.1:63796\r\nroot          97  0.1  0.0  59780 13652 pts/0    Sl   Jun05   1:25 /usr/bin/redis-server 127.0.0.1:63970\r\nroot         239  0.0  0.0 220904  3804 pts/0    Sl   Jun05   0:01 /usr/sbin/rsyslogd -n -iNONE\r\nroot         408  0.0  0.0   7788  3956 pts/1    Ss   Jun05   0:00 bash\r\nroot        3745  0.0  0.2 683676 45832 pts/1    Sl+  Jun05   0:00 gdb /usr/bin/redis-server /core.redis-server.0.ba1a0b8780ea4774b75a47d5ce70532c.1253.1716499357000000\r\nroot        9524  1.0  0.0   7788  3768 pts/2    Ss   08:53   0:00 bash\r\nroot        9530  0.0  0.0  10384  3340 pts/2    R+   08:53   0:00 ps aux\r\n```\r\n\r\n"
    },
    {
      "id": 2172725514,
      "user": "oranagra",
      "created_at": "2024-06-17T08:52:45Z",
      "body": "@sg893052 did it happen once? or does it reproduce.\r\ni see this is a rather old version (even for 6.2.x), skimming over the release notes i don't see anything obvious, but still maybe you should try to upgrade."
    }
  ]
}