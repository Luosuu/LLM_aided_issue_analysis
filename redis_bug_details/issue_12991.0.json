{
  "issue_number": 12991.0,
  "title": "[BUG] Crash on CMS.MERGE when weights length does not match numKeys",
  "body": "**Describe the bug**\r\n\r\nCrash on CMS.MERGE when weights length does not match numKeys.\r\n\r\nAlso reported here https://github.com/RedisBloom/RedisBloom/issues/753\r\n\r\n**To reproduce**\r\n\r\n```python\r\ndef test_cms_merge(r: redis.Redis):\r\n    assert r.cms().initbydim(\"cmsDim\", 100, 5)\r\n    assert r.cms().initbydim(\"cms2\", 100, 5)\r\n\r\n    assert r.cms().incrby(\"cmsDim\", [\"foo\"], [3]) == [3]\r\n    assert r.cms().incrby(\"cms2\", [\"foo\", \"bar\"], [4, 1]) == [4, 1]\r\n    assert r.cms().merge(\"cmsDim\", 1, [\"cms2\"])\r\n    assert r.cms().query(\"cmsDim\", \"foo\", \"bar\") == [4, 1]\r\n\r\n    with pytest.raises(redis.exceptions.ResponseError, match=\"CMS: key does not exist\"):\r\n        r.cms().merge(\"noexist\", 1, [\"cms2\"])\r\n\r\n    with pytest.raises(redis.exceptions.ResponseError, match=\"CMS: wrong number of keys\"):\r\n        r.cms().merge(\"cms2\", 0, [\"cmsDim\"])\r\n\r\n    with pytest.raises(redis.exceptions.ResponseError, match=\"wrong number of arguments for 'cms.merge' command\"):\r\n        r.cms().merge(\"cms2\", 1, [])\r\n\r\n    with pytest.raises(redis.exceptions.ResponseError, match=\"CMS: wrong number of keys/weights\"):\r\n        r.cms().merge(\"cmsDim\", 1, [\"cms2\", \"cms1\"], [4, 3])\r\n\r\n    with pytest.raises(redis.exceptions.ResponseError, match=\"CMS: key does not exist\"):\r\n        r.cms().merge(\"cmsDim\", 2, [\"cms2\", \"cms1\"], [4])\r\n\r\n```\r\n\r\n**Expected behavior**\r\n\r\nSome kind of error message\r\n\r\n**Additional information**\r\n\r\n```\r\nredis7-1  | === REDIS BUG REPORT START: Cut & paste starting from here ===\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.714 # Redis 7.2.3 crashed by signal: 11, si_code: 1\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.714 # Accessing address: 0x79\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.714 # Crashed running the instruction at: 0xaaaac4b8aea0\r\nredis7-1  |\r\nredis7-1  | ------ STACK TRACE ------\r\nredis7-1  | EIP:\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(RM_StringToLongLong+0x0)[0xaaaac4b8aea0]\r\nredis7-1  |\r\nredis7-1  | Backtrace:\r\nredis7-1  | linux-vdso.so.1(__kernel_rt_sigreturn+0x0)[0xffff97b367a0]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(RM_StringToLongLong+0x0)[0xaaaac4b8aea0]\r\nredis7-1  | /opt/redis-stack/lib/redisbloom.so(CMSketch_Merge+0x238)[0xffff9572aa0c]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(RedisModuleCommandDispatcher+0xb8)[0xaaaac4b90568]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(call+0x170)[0xaaaac4ab7aa4]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(processCommand+0x3c0)[0xaaaac4ab84e4]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(processInputBuffer+0xe0)[0xaaaac4ad8720]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(readQueryFromClient+0x308)[0xaaaac4ad8be8]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(+0x1a77c8)[0xaaaac4bd77c8]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(aeMain+0x12c)[0xaaaac4aadeac]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(main+0x3f4)[0xaaaac4aa2ab4]\r\nredis7-1  | /lib/aarch64-linux-gnu/libc.so.6(+0x273fc)[0xffff974273fc]\r\nredis7-1  | /lib/aarch64-linux-gnu/libc.so.6(__libc_start_main+0x98)[0xffff974274cc]\r\nredis7-1  | /opt/redis-stack/bin/redis-server *:6379(_start+0x30)[0xaaaac4aa32b0]\r\nredis7-1  |\r\nredis7-1  | ------ REGISTERS ------\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 #\r\nredis7-1  | X18:0000000000000000 X19:0000aaaaf2592478\r\nredis7-1  | X20:0000fffff56aa570 X21:0000000000000008\r\nredis7-1  | X22:0000000000000000 X23:0000000000000002\r\nredis7-1  | X24:0000aaaac4d1cf18 X25:0000000000000064\r\nredis7-1  | X26:0000000000000005 X27:0000aaaaf2592490\r\nredis7-1  | X28:0000000000000001 X29:0000fffff56aa480\r\nredis7-1  | X30:0000ffff9572aa0c\r\nredis7-1  | pc:0000aaaac4b8aea0 sp:0000fffff56aa480\r\nredis7-1  | pstate:0000000020001000 fault_address:0000000000000079\r\nredis7-1  |\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48f) -> 0000aaaac4ab7868\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48e) -> 0000fffff56aa5c0\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48d) -> 0000fffff56aa518\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48c) -> 000030c030030003\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48b) -> 0000fffff56aa688\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa48a) -> 0000000000000001\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa489) -> 0000aaaac4d11000\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa488) -> 00060fc5dc53c097\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa487) -> 0000aaaaf2570a50\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa486) -> 0000aaaaf253e760\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa485) -> 0000aaaac4cba000\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa484) -> 0000fffff56aa570\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa483) -> 0000aaaaf2570a50\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa482) -> 0000000000000000\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa481) -> 0000aaaac4b90568\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # (0000fffff56aa480) -> 0000fffff56aa540\r\nredis7-1  |\r\nredis7-1  | ------ INFO OUTPUT ------\r\nredis7-1  | # Server\r\nredis7-1  | redis_version:7.2.3\r\nredis7-1  | redis_git_sha1:00000000\r\nredis7-1  | redis_git_dirty:0\r\nredis7-1  | redis_build_id:bea59c30c177d53\r\nredis7-1  | redis_mode:standalone\r\nredis7-1  | os:Linux 6.5.11-linuxkit aarch64\r\nredis7-1  | arch_bits:64\r\nredis7-1  | monotonic_clock:POSIX clock_gettime\r\nredis7-1  | multiplexing_api:epoll\r\nredis7-1  | atomicvar_api:c11-builtin\r\nredis7-1  | gcc_version:11.4.0\r\nredis7-1  | process_id:8\r\nredis7-1  | process_supervised:no\r\nredis7-1  | run_id:8f276a24d25215ce70f913f28d577f0586e73c0f\r\nredis7-1  | tcp_port:6379\r\nredis7-1  | server_time_usec:1706192339714199\r\nredis7-1  | uptime_in_seconds:17\r\nredis7-1  | uptime_in_days:0\r\nredis7-1  | hz:10\r\nredis7-1  | configured_hz:10\r\nredis7-1  | lru_clock:11693523\r\nredis7-1  | executable:/opt/redis-stack/bin/redis-server\r\nredis7-1  | config_file:\r\nredis7-1  | io_threads_active:0\r\nredis7-1  | listener0:name=tcp,bind=*,bind=-::*,port=6379\r\nredis7-1  |\r\nredis7-1  | # Clients\r\nredis7-1  | connected_clients:1\r\nredis7-1  | cluster_connections:0\r\nredis7-1  | maxclients:10000\r\nredis7-1  | client_recent_max_input_buffer:0\r\nredis7-1  | client_recent_max_output_buffer:0\r\nredis7-1  | blocked_clients:0\r\nredis7-1  | tracking_clients:0\r\nredis7-1  | clients_in_timeout_table:0\r\nredis7-1  | total_blocking_keys:0\r\nredis7-1  | total_blocking_keys_on_nokey:0\r\nredis7-1  |\r\nredis7-1  | # Memory\r\nredis7-1  | used_memory:1548584\r\nredis7-1  | used_memory_human:1.48M\r\nredis7-1  | used_memory_rss:19398656\r\nredis7-1  | used_memory_rss_human:18.50M\r\nredis7-1  | used_memory_peak:1548584\r\nredis7-1  | used_memory_peak_human:1.48M\r\nredis7-1  | used_memory_peak_perc:100.15%\r\nredis7-1  | used_memory_overhead:1333968\r\nredis7-1  | used_memory_startup:1333640\r\nredis7-1  | used_memory_dataset:214616\r\nredis7-1  | used_memory_dataset_perc:99.85%\r\nredis7-1  | allocator_allocated:1507384\r\nredis7-1  | allocator_active:19366912\r\nredis7-1  | allocator_resident:19366912\r\nredis7-1  | total_system_memory:8332460032\r\nredis7-1  | total_system_memory_human:7.76G\r\nredis7-1  | used_memory_lua:31744\r\nredis7-1  | used_memory_vm_eval:31744\r\nredis7-1  | used_memory_lua_human:31.00K\r\nredis7-1  | used_memory_scripts_eval:0\r\nredis7-1  | number_of_cached_scripts:0\r\nredis7-1  | number_of_functions:0\r\nredis7-1  | number_of_libraries:0\r\nredis7-1  | used_memory_vm_functions:32768\r\nredis7-1  | used_memory_vm_total:64512\r\nredis7-1  | used_memory_vm_total_human:63.00K\r\nredis7-1  | used_memory_functions:216\r\nredis7-1  | used_memory_scripts:216\r\nredis7-1  | used_memory_scripts_human:216B\r\nredis7-1  | maxmemory:0\r\nredis7-1  | maxmemory_human:0B\r\nredis7-1  | maxmemory_policy:noeviction\r\nredis7-1  | allocator_frag_ratio:12.85\r\nredis7-1  | allocator_frag_bytes:17859528\r\nredis7-1  | allocator_rss_ratio:1.00\r\nredis7-1  | allocator_rss_bytes:0\r\nredis7-1  | rss_overhead_ratio:1.00\r\nredis7-1  | rss_overhead_bytes:31744\r\nredis7-1  | mem_fragmentation_ratio:12.87\r\nredis7-1  | mem_fragmentation_bytes:17891272\r\nredis7-1  | mem_not_counted_for_evict:0\r\nredis7-1  | mem_replication_backlog:0\r\nredis7-1  | mem_total_replication_buffers:0\r\nredis7-1  | mem_clients_slaves:0\r\nredis7-1  | mem_clients_normal:0\r\nredis7-1  | mem_cluster_links:0\r\nredis7-1  | mem_aof_buffer:0\r\nredis7-1  | mem_allocator:libc\r\nredis7-1  | active_defrag_running:0\r\nredis7-1  | lazyfree_pending_objects:0\r\nredis7-1  | lazyfreed_objects:0\r\nredis7-1  |\r\nredis7-1  | # Persistence\r\nredis7-1  | loading:0\r\nredis7-1  | async_loading:0\r\nredis7-1  | current_cow_peak:0\r\nredis7-1  | current_cow_size:0\r\nredis7-1  | current_cow_size_age:0\r\nredis7-1  | current_fork_perc:0.00\r\nredis7-1  | current_save_keys_processed:0\r\nredis7-1  | current_save_keys_total:0\r\nredis7-1  | rdb_changes_since_last_save:5\r\nredis7-1  | rdb_bgsave_in_progress:0\r\nredis7-1  | rdb_last_save_time:1706192339\r\nredis7-1  | rdb_last_bgsave_status:ok\r\nredis7-1  | rdb_last_bgsave_time_sec:-1\r\nredis7-1  | rdb_current_bgsave_time_sec:-1\r\nredis7-1  | rdb_saves:0\r\nredis7-1  | rdb_last_cow_size:0\r\nredis7-1  | rdb_last_load_keys_expired:0\r\nredis7-1  | rdb_last_load_keys_loaded:0\r\nredis7-1  | aof_enabled:0\r\nredis7-1  | aof_rewrite_in_progress:0\r\nredis7-1  | aof_rewrite_scheduled:0\r\nredis7-1  | aof_last_rewrite_time_sec:-1\r\nredis7-1  | aof_current_rewrite_time_sec:-1\r\nredis7-1  | aof_last_bgrewrite_status:ok\r\nredis7-1  | aof_rewrites:0\r\nredis7-1  | aof_rewrites_consecutive_failures:0\r\nredis7-1  | aof_last_write_status:ok\r\nredis7-1  | aof_last_cow_size:0\r\nredis7-1  | module_fork_in_progress:0\r\nredis7-1  | module_fork_last_cow_size:0\r\nredis7-1  |\r\nredis7-1  | # Stats\r\nredis7-1  | total_connections_received:4\r\nredis7-1  | total_commands_processed:43\r\nredis7-1  | instantaneous_ops_per_sec:0\r\nredis7-1  | total_net_input_bytes:1825\r\nredis7-1  | total_net_output_bytes:12080\r\nredis7-1  | total_net_repl_input_bytes:0\r\nredis7-1  | total_net_repl_output_bytes:0\r\nredis7-1  | instantaneous_input_kbps:0.00\r\nredis7-1  | instantaneous_output_kbps:0.00\r\nredis7-1  | instantaneous_input_repl_kbps:0.00\r\nredis7-1  | instantaneous_output_repl_kbps:0.00\r\nredis7-1  | rejected_connections:0\r\nredis7-1  | sync_full:0\r\nredis7-1  | sync_partial_ok:0\r\nredis7-1  | sync_partial_err:0\r\nredis7-1  | expired_keys:0\r\nredis7-1  | expired_stale_perc:0.00\r\nredis7-1  | expired_time_cap_reached_count:0\r\nredis7-1  | expire_cycle_cpu_milliseconds:0\r\nredis7-1  | evicted_keys:0\r\nredis7-1  | evicted_clients:0\r\nredis7-1  | total_eviction_exceeded_time:0\r\nredis7-1  | current_eviction_exceeded_time:0\r\nredis7-1  | keyspace_hits:9\r\nredis7-1  | keyspace_misses:0\r\nredis7-1  | pubsub_channels:0\r\nredis7-1  | pubsub_patterns:0\r\nredis7-1  | pubsubshard_channels:0\r\nredis7-1  | latest_fork_usec:0\r\nredis7-1  | total_forks:0\r\nredis7-1  | migrate_cached_sockets:0\r\nredis7-1  | slave_expires_tracked_keys:0\r\nredis7-1  | active_defrag_hits:0\r\nredis7-1  | active_defrag_misses:0\r\nredis7-1  | active_defrag_key_hits:0\r\nredis7-1  | active_defrag_key_misses:0\r\nredis7-1  | total_active_defrag_time:0\r\nredis7-1  | current_active_defrag_time:0\r\nredis7-1  | tracking_total_keys:0\r\nredis7-1  | tracking_total_items:0\r\nredis7-1  | tracking_total_prefixes:0\r\nredis7-1  | unexpected_error_replies:0\r\nredis7-1  | total_error_replies:9\r\nredis7-1  | dump_payload_sanitizations:0\r\nredis7-1  | total_reads_processed:42\r\nredis7-1  | total_writes_processed:38\r\nredis7-1  | io_threaded_reads_processed:0\r\nredis7-1  | io_threaded_writes_processed:0\r\nredis7-1  | reply_buffer_shrinks:0\r\nredis7-1  | reply_buffer_expands:0\r\nredis7-1  | eventloop_cycles:207\r\nredis7-1  | eventloop_duration_sum:93402\r\nredis7-1  | eventloop_duration_cmd_sum:32410\r\nredis7-1  | instantaneous_eventloop_cycles_per_sec:9\r\nredis7-1  | instantaneous_eventloop_duration_usec:320\r\nredis7-1  | acl_access_denied_auth:0\r\nredis7-1  | acl_access_denied_cmd:0\r\nredis7-1  | acl_access_denied_key:0\r\nredis7-1  | acl_access_denied_channel:0\r\nredis7-1  |\r\nredis7-1  | # Replication\r\nredis7-1  | role:master\r\nredis7-1  | connected_slaves:0\r\nredis7-1  | master_failover_state:no-failover\r\nredis7-1  | master_replid:331fdb9d51db8b9bd3bdf50a8e7cb965df7e9a53\r\nredis7-1  | master_replid2:0000000000000000000000000000000000000000\r\nredis7-1  | master_repl_offset:0\r\nredis7-1  | second_repl_offset:-1\r\nredis7-1  | repl_backlog_active:0\r\nredis7-1  | repl_backlog_size:1048576\r\nredis7-1  | repl_backlog_first_byte_offset:0\r\nredis7-1  | repl_backlog_histlen:0\r\nredis7-1  |\r\nredis7-1  | # CPU\r\nredis7-1  | used_cpu_sys:0.067598\r\nredis7-1  | used_cpu_user:0.032189\r\nredis7-1  | used_cpu_sys_children:0.000000\r\nredis7-1  | used_cpu_user_children:0.000808\r\nredis7-1  | used_cpu_sys_main_thread:0.067422\r\nredis7-1  | used_cpu_user_main_thread:0.032105\r\nredis7-1  |\r\nredis7-1  | # Modules\r\nredis7-1  | module:name=search,ver=20809,api=1,filters=0,usedby=[],using=[ReJSON],options=[handle-io-errors]\r\nredis7-1  | module:name=timeseries,ver=11009,api=1,filters=0,usedby=[],using=[],options=[]\r\nredis7-1  | module:name=redisgears_2,ver=20014,api=1,filters=0,usedby=[],using=[],options=[]\r\nredis7-1  | module:name=ReJSON,ver=20607,api=1,filters=0,usedby=[search],using=[],options=[handle-io-errors]\r\nredis7-1  | module:name=bf,ver=20608,api=1,filters=0,usedby=[],using=[],options=[]\r\nredis7-1  | module:name=RedisCompat,ver=1,api=1,filters=0,usedby=[],using=[],options=[]\r\nredis7-1  |\r\nredis7-1  | # Commandstats\r\nredis7-1  | cmdstat_select:calls=4,usec=4,usec_per_call=1.00,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_client|setinfo:calls=8,usec=17,usec_per_call=2.12,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_cms.query:calls=2,usec=7,usec_per_call=3.50,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_info:calls=6,usec=556,usec_per_call=92.67,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_cms.initbydim:calls=4,usec=90,usec_per_call=22.50,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_config|get:calls=1,usec=3,usec_per_call=3.00,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_cms.incrby:calls=4,usec=47,usec_per_call=11.75,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_flushall:calls=3,usec=31645,usec_per_call=10548.33,rejected_calls=0,failed_calls=0\r\nredis7-1  | cmdstat_cms.merge:calls=11,usec=92,usec_per_call=8.36,rejected_calls=0,failed_calls=9\r\nredis7-1  |\r\nredis7-1  | # Errorstats\r\nredis7-1  | errorstat_CMS_:count=7\r\nredis7-1  | errorstat_ERR:count=2\r\nredis7-1  |\r\nredis7-1  | # Latencystats\r\nredis7-1  | latency_percentiles_usec_select:p50=1.003,p99=2.007,p99.9=2.007\r\nredis7-1  | latency_percentiles_usec_client|setinfo:p50=1.003,p99=6.015,p99.9=6.015\r\nredis7-1  | latency_percentiles_usec_cms.query:p50=2.007,p99=5.023,p99.9=5.023\r\nredis7-1  | latency_percentiles_usec_info:p50=7.007,p99=264.191,p99.9=264.191\r\nredis7-1  | latency_percentiles_usec_cms.initbydim:p50=8.031,p99=39.167,p99.9=39.167\r\nredis7-1  | latency_percentiles_usec_config|get:p50=3.007,p99=3.007,p99.9=3.007\r\nredis7-1  | latency_percentiles_usec_cms.incrby:p50=4.015,p99=29.055,p99.9=29.055\r\nredis7-1  | latency_percentiles_usec_flushall:p50=8519.679,p99=17563.647,p99.9=17563.647\r\nredis7-1  | latency_percentiles_usec_cms.merge:p50=7.007,p99=22.015,p99.9=22.015\r\nredis7-1  |\r\nredis7-1  | # Cluster\r\nredis7-1  | cluster_enabled:0\r\nredis7-1  |\r\nredis7-1  | # Keyspace\r\nredis7-1  | db2:keys=2,expires=0,avg_ttl=0\r\nredis7-1  |\r\nredis7-1  | ------ CLIENT LIST OUTPUT ------\r\nredis7-1  | id=16 addr=192.168.65.1:63631 laddr=172.18.0.2:6379 fd=16 name= age=0 idle=0 flags=N db=2 sub=0 psub=0 ssub=0 multi=-1 qbuf=78 qbuf-free=16308 argv-mem=32 multi-mem=0 rbs=16392 rbp=16392 obl=0 oll=0 omem=0 tot-mem=33648 events=r cmd=cms.merge user=default redir=-1 resp=2 lib-name=redis-py lib-ver=5.0.1\r\nredis7-1  |\r\nredis7-1  | ------ CURRENT CLIENT INFO ------\r\nredis7-1  | id=16 addr=192.168.65.1:63631 laddr=172.18.0.2:6379 fd=16 name= age=0 idle=0 flags=N db=2 sub=0 psub=0 ssub=0 multi=-1 qbuf=78 qbuf-free=16308 argv-mem=32 multi-mem=0 rbs=16392 rbp=16392 obl=0 oll=0 omem=0 tot-mem=33648 events=r cmd=cms.merge user=default redir=-1 resp=2 lib-name=redis-py lib-ver=5.0.1\r\nredis7-1  | argc: '7'\r\nredis7-1  | argv[0]: '\"CMS.MERGE\"'\r\nredis7-1  | argv[1]: '\"cmsDim\"'\r\nredis7-1  | argv[2]: '\"2\"'\r\nredis7-1  | argv[3]: '\"cms2\"'\r\nredis7-1  | argv[4]: '\"cms1\"'\r\nredis7-1  | argv[5]: '\"WEIGHTS\"'\r\nredis7-1  | argv[6]: '\"4\"'\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # key 'cmsDim' found in DB containing the following object:\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object type: 5\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object encoding: 0\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object refcount: 1\r\nredis7-1  |\r\nredis7-1  | ------ EXECUTING CLIENT INFO ------\r\nredis7-1  | id=16 addr=192.168.65.1:63631 laddr=172.18.0.2:6379 fd=16 name= age=0 idle=0 flags=N db=2 sub=0 psub=0 ssub=0 multi=-1 qbuf=78 qbuf-free=16308 argv-mem=32 multi-mem=0 rbs=16392 rbp=16392 obl=0 oll=0 omem=0 tot-mem=33648 events=r cmd=cms.merge user=default redir=-1 resp=2 lib-name=redis-py lib-ver=5.0.1\r\nredis7-1  | argc: '7'\r\nredis7-1  | argv[0]: '\"CMS.MERGE\"'\r\nredis7-1  | argv[1]: '\"cmsDim\"'\r\nredis7-1  | argv[2]: '\"2\"'\r\nredis7-1  | argv[3]: '\"cms2\"'\r\nredis7-1  | argv[4]: '\"cms1\"'\r\nredis7-1  | argv[5]: '\"WEIGHTS\"'\r\nredis7-1  | argv[6]: '\"4\"'\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # key 'cmsDim' found in DB containing the following object:\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object type: 5\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object encoding: 0\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.719 # Object refcount: 1\r\nredis7-1  |\r\nredis7-1  | ------ MODULES INFO OUTPUT ------\r\nredis7-1  | # search_version\r\nredis7-1  | search_version:2.8.9\r\nredis7-1  | search_redis_version:7.2.3 - oss\r\nredis7-1  |\r\nredis7-1  | # search_index\r\nredis7-1  | search_number_of_indexes:0\r\nredis7-1  |\r\nredis7-1  | # search_fields_statistics\r\nredis7-1  |\r\nredis7-1  | # search_dialect_statistics\r\nredis7-1  | search_dialect_1:0\r\nredis7-1  | search_dialect_2:0\r\nredis7-1  | search_dialect_3:0\r\nredis7-1  | search_dialect_4:0\r\nredis7-1  |\r\nredis7-1  | # search_runtime_configurations\r\nredis7-1  | search_concurrent_mode:OFF\r\nredis7-1  | search_enableGC:ON\r\nredis7-1  | search_minimal_term_prefix:2\r\nredis7-1  | search_maximal_prefix_expansions:200\r\nredis7-1  | search_query_timeout_ms:500\r\nredis7-1  | search_timeout_policy:return\r\nredis7-1  | search_cursor_read_size:1000\r\nredis7-1  | search_cursor_max_idle_time:300000\r\nredis7-1  | search_max_doc_table_size:1000000\r\nredis7-1  | search_max_search_results:10000\r\nredis7-1  | search_max_aggregate_results:10000\r\nredis7-1  | search_search_pool_size:20\r\nredis7-1  | search_index_pool_size:8\r\nredis7-1  | search_gc_scan_size:100\r\nredis7-1  | search_min_phonetic_term_length:3\r\nredis7-1  |\r\nredis7-1  | # redisgears_2_trace\r\nredis7-1  | redisgears_2_backtrace:   0: redis_module::basic_info_command_handler\r\nredis7-1  |    1: redisgears::gears_module::__info_func\r\nredis7-1  |    2: modulesCollectInfo\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:10293:9\r\nredis7-1  |    3: logModulesInfo\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:1900:22\r\nredis7-1  |       printCrashReport\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:2183:5\r\nredis7-1  |    4: sigsegvHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:2164:5\r\nredis7-1  |    5: <unknown>\r\nredis7-1  |    6: zfree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/zmalloc.c:374:5\r\nredis7-1  |       zfree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/zmalloc.c:365:6\r\nredis7-1  |       moduleListFree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:2224:5\r\nredis7-1  |    7: parseMergeArgs\r\nredis7-1  |              at /build/src/rm_cms.c:209:20\r\nredis7-1  |       CMSketch_Merge\r\nredis7-1  |              at /build/src/rm_cms.c:239:9\r\nredis7-1  |       CMSketch_Merge\r\nredis7-1  |              at /build/src/rm_cms.c:225:5\r\nredis7-1  |    8: RedisModuleCommandDispatcher\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:917:5\r\nredis7-1  |    9: call\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:3519:5\r\nredis7-1  |   10: processCommand\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:4160:9\r\nredis7-1  |   11: processCommandAndResetClient\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2466:9\r\nredis7-1  |       processInputBuffer\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2574:17\r\nredis7-1  |   12: readQueryFromClient\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2713:9\r\nredis7-1  |   13: callHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/connhelpers.h:79:18\r\nredis7-1  |       connSocketEventHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/socket.c:298:14\r\nredis7-1  |   14: aeProcessEvents\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/ae.c:436:17\r\nredis7-1  |       aeMain\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/ae.c:496:9\r\nredis7-1  |   15: main\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:7360:5\r\nredis7-1  |   16: <unknown>\r\nredis7-1  |   17: __libc_start_main\r\nredis7-1  |   18: _start\r\nredis7-1  |\r\nredis7-1  |\r\nredis7-1  | # redisgears_2_UninitialisedBackends\r\nredis7-1  | redisgears_2_backend_name:js\r\nredis7-1  |\r\nredis7-1  | # ReJSON_trace\r\nredis7-1  | ReJSON_backtrace:   0: redis_module::basic_info_command_handler\r\nredis7-1  |    1: rejson::__info_func\r\nredis7-1  |    2: modulesCollectInfo\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:10293:9\r\nredis7-1  |    3: logModulesInfo\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:1900:22\r\nredis7-1  |       printCrashReport\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:2183:5\r\nredis7-1  |    4: sigsegvHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/debug.c:2164:5\r\nredis7-1  |    5: <unknown>\r\nredis7-1  |    6: zfree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/zmalloc.c:374:5\r\nredis7-1  |       zfree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/zmalloc.c:365:6\r\nredis7-1  |       moduleListFree\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:2224:5\r\nredis7-1  |    7: parseMergeArgs\r\nredis7-1  |              at /build/src/rm_cms.c:209:20\r\nredis7-1  |       CMSketch_Merge\r\nredis7-1  |              at /build/src/rm_cms.c:239:9\r\nredis7-1  |       CMSketch_Merge\r\nredis7-1  |              at /build/src/rm_cms.c:225:5\r\nredis7-1  |    8: RedisModuleCommandDispatcher\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/module.c:917:5\r\nredis7-1  |    9: call\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:3519:5\r\nredis7-1  |   10: processCommand\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:4160:9\r\nredis7-1  |   11: processCommandAndResetClient\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2466:9\r\nredis7-1  |       processInputBuffer\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2574:17\r\nredis7-1  |   12: readQueryFromClient\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/networking.c:2713:9\r\nredis7-1  |   13: callHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/connhelpers.h:79:18\r\nredis7-1  |       connSocketEventHandler\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/socket.c:298:14\r\nredis7-1  |   14: aeProcessEvents\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/ae.c:436:17\r\nredis7-1  |       aeMain\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/ae.c:496:9\r\nredis7-1  |   15: main\r\nredis7-1  |              at /home/runner/work/redis-stack/redis-stack/redis/src/server.c:7360:5\r\nredis7-1  |   16: <unknown>\r\nredis7-1  |   17: __libc_start_main\r\nredis7-1  |   18: _start\r\nredis7-1  |\r\nredis7-1  |\r\nredis7-1  | ------ CONFIG DEBUG OUTPUT ------\r\nredis7-1  | lazyfree-lazy-user-del no\r\nredis7-1  | io-threads 1\r\nredis7-1  | lazyfree-lazy-user-flush no\r\nredis7-1  | lazyfree-lazy-eviction no\r\nredis7-1  | lazyfree-lazy-server-del no\r\nredis7-1  | lazyfree-lazy-expire no\r\nredis7-1  | client-query-buffer-limit 1gb\r\nredis7-1  | sanitize-dump-payload no\r\nredis7-1  | io-threads-do-reads no\r\nredis7-1  | slave-read-only yes\r\nredis7-1  | repl-diskless-load disabled\r\nredis7-1  | repl-diskless-sync yes\r\nredis7-1  | activedefrag no\r\nredis7-1  | proto-max-bulk-len 512mb\r\nredis7-1  | list-compress-depth 0\r\nredis7-1  | replica-read-only yes\r\nredis7-1  |\r\nredis7-1  | ------ FAST MEMORY TEST ------\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.769 # Bio worker thread #0 terminated\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.769 # Bio worker thread #1 terminated\r\nredis7-1  | 8:M 25 Jan 2024 14:18:59.769 # Bio worker thread #2 terminated\r\nredis7-1  | *** Preparing to test memory region aaaac4cfd000 (135168 bytes)\r\nredis7-1  | *** Preparing to test memory region aaaaf2419000 (12173312 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff84000000 (135168 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff8c000000 (135168 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff905d0000 (204800 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff9112a000 (397312 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff91b40000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff92350000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff92b60000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff93370000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff953ad000 (139264 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff95707000 (8192 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff95c47000 (12288 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff95cf4000 (8192 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff95d10000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff96520000 (8388608 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff97352000 (24576 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff97388000 (491520 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff9759e000 (49152 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff9799d000 (12288 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff97b2e000 (8192 bytes)\r\nredis7-1  | *** Preparing to test memory region ffff97b32000 (8192 bytes)\r\nredis7-1  | .O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nredis7-1  | Fast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\nredis7-1  |\r\nredis7-1  | ------ DUMPING CODE AROUND EIP ------\r\nredis7-1  | Symbol: RM_StringToLongLong (base: 0xaaaac4b8aea0)\r\nredis7-1  | Module: /opt/redis-stack/bin/redis-server *:6379 (base 0xaaaac4a30000)\r\nredis7-1  | $ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\nredis7-1  | $ objdump --adjust-vma=0xaaaac4b8aea0 -D -b binary -m i386:x86-64 /tmp/dump.bin\r\nredis7-1  | ------\r\nredis7-1  | 8:M 25 Jan 2024 14:19:00.042 # dump of function (hexdump of 128 bytes):\r\nredis7-1  | 050440f9e20301aaa4f05f38830800127f080071e0040054890200547f0c0071c00400547f100071c1040054a1f05ef8230400d1200080527f4c00f1680200543f0400f140020054fd7bbfa9e00305aafd030091e348fd971f000071e0179f1afd7bc1a8c0035fd6030200347f04007181020054a1d05f3820008052230400d1\r\nredis7-1  |\r\nredis7-1  | === REDIS BUG REPORT END. Make sure to include from START to END. ===\r\nredis7-1  |\r\nredis7-1  |        Please report the crash by opening an issue on github:\r\nredis7-1  |\r\nredis7-1  |            http://github.com/redis/redis/issues\r\nredis7-1  |\r\nredis7-1  |   If a Redis module was involved, please open in the module's repo instead.\r\nredis7-1  |\r\nredis7-1  |   Suspect RAM error? Use redis-server --test-memory to verify it.\r\nredis7-1  |\r\nredis7-1  |   Some other issues could be detected by redis-server --check-system\r\nredis7-1  | Segmentation fault\r\nredis7-1 exited with code 139\r\n```",
  "state": "closed",
  "created_at": "2024-01-25T14:22:09Z",
  "updated_at": "2024-01-25T23:05:42Z",
  "closed_at": "2024-01-25T23:05:42Z",
  "labels": [],
  "comments_data": [
    {
      "id": 1911137404,
      "user": "madolson",
      "created_at": "2024-01-25T23:05:42Z",
      "body": "It crashed in the bloom code, so going to assume it's related to that and close this here. I see you already have an issue opened to the bloom module."
    }
  ]
}