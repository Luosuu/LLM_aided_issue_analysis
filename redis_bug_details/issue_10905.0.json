{
  "issue_number": 10905.0,
  "title": "[BUG] The redis down by it's self ,redis verison 5.0.3( ASSERTION FAILED)",
  "body": "**Describe the bug**\r\nThe  redis server down by it's self. The bug report below.\r\n```\r\nREDIS BUG REPORT START:Cut & paste starting fron here\r\n2532:M 21 Jun 2022 19:55:12.083ASSERTION FAILED\r\n2532:M 21 Jun 2022 19:55:12.083*>dict.c:197 'd->ht[0].size>(unsigned long)d->rehashidx'is not true 2532:M 21 Jun 2022 19:55:12.083#(forcing SIGSEGV to print the bug report.)\r\n2532:M 21 Jun 2022 19:55:12.083#Redis 5.0.3 crashed by signal:11\r\n2532:M 21 Jun 2022 19:55:12.083#Crashed running the instruction at:0x46e73a 2532:M 21 Jun 2022 19:55:12.083 #Accessing address:oxffffffffffffffff\r\n2532:M 21 Jun 2022 19:55:12.083 # Failed assertion: d->ht[e].size > (unsigned long)d->rehashidx (dict.c:197)\r\nSTACK TRACE\r\nEIP:\r\n/home/redis/bin/redis-server*:63791(_serverAssert+0x6a)[0x46e73a] Backtrace:\r\n/home/redis/bin/redis-server*:63791(1ogStackTrace+0x29)[0x470919] /home/redis/bin/redis-server:63791(sigsegvHandler+0xac)[0x470fbc] /1ib64/1ibpthread.so.0(+0xf630)[0x7f346872b630]\r\n/home/redis/bin/redis-server*:63791(_serverAssert+0x6a)[0x46e73a] /home/redis/bin/redis-server *:63791(dictRehash+0xf0)[0x42c340】 /home/redis/bin/redis-server*:63791(dictFind+0xda)[0x42cc2a] /home/redis/bin/redis-server*:63791(getExpire+0x24)[0x445a34] /home/redis/bin/redis-server *:63791(keyIsExpired+0x6)[0x445b26] /home/redis/bin/redis-server*:63791(expireIfNeeded+0x11)[0x446791]\r\n/home/redis/bin/redis-server*:63791(1ookupKeyReadwithF1ags+0x12)[0x446822] /home/redis/bin/redis-server*:63791(1ookupKeyReadorReply+0x17)[0x4468c7] /home/redis/bin/redis-server *:63791(1rangeConnand+0x62)[0x454612]\r\n/home/redis/bin/redis-server:63791(ca11+0xa7)[0x430657]\r\n/home/redis/bin/redis-server *:63791(processCommand+0x33f)[0x4318ef] /home/redis/bin/redis-server*:63791(processInputBuffer+0x175)[0x440475] /home/redis/bin/redis-server*:63791(aeProcessEvents+0x2a0)[0x42ab10] /home/redis/bin/redis-server *:63791(aeMain+0x2b)[0x42addb]\r\n/home/redis/bin/redis-server*:63791(main+0x4af)[0x427c8f] /11b64/1ibc.so.6(_libc_start_main+0xf5)[ex7+3468370555] /home/redis/bin/redis-server*:63791[0x427eda]\r\nINFO OUTPUT. ------\r\n# Server\r\nredis_version:5.0.3 redis_git_shal:00000000 redis_git_dirty:0\r\nredis_build_id:832d8ac449b67014 redis mode:standalone\r\nos:Linux 3.10.0-1127.e17.x86_64 x86_64 arch_bits:64\r\nmultiplexing_api:epol1 atomicvar_api:atonic-builtin gcc_version:4.8.5\r\nprocess id:2532\r\nrun_id:3c079c02cc04a8017a8fc5b369ed1d4c27260fd9 tcp_port:63791\r\nuptime_in_seconds:5901402 uptime_in_days:68\r\nhz:10\r\nconfigured hz:10 1ru_clock:11645344\r\nexecutable:/home/redis/bin/redis-server config_file:/hone/redis/conf/63791.conf Clients\r\nconnected_clients:26\r\nclient_recent_max_input_buffer:2 client_recent_max_output_buffer:0 blocked_clients:0\r\n#Memory\r\nused_memory:899493536 used_memory_hunan:857.82M used_nenory_rss:925822976 used_memory_rss_human:882.93M used_nemory_peak:900837176 used_dehory_peak_human:859.11M used_memory_peak_perc:99.85% used menory overhead:118763296 used_memory_startup:792056 used_memory_dataset:780730240 used_memory_dataset_perc:86.87% allocator allocated:899609392 allocator active:901378048 allocator_resident:921731072 total_system_menory:33539612672 total_system_memory_human:31.24G used_menory_lua:37888\r\nused_memory_lua_human:37.00K used_nenory_scripts:0\r\nused_menory_scripts_human:08 number_of_cached_scripts:0 maxmenory:0\r\nmaxmemory_human:08\r\nmaxmemory_policy:noeviction allocator_frag_ratio:1.00 allocator_frag_bytes:1768656 allocator rss_ratio:1.02 allocator_rss_bytes:20353024 rss_overhead_ratio:1.00 rss_overhead_bytes:4091904 mem_fragmentation_ratio:1.03 mem_fragmentation_bytes:26330872 mem_not_counted_for_evict:3740 mem_replication_backlog:0 mem clients_ slaves:0 mem_clients_nornal:571060 mem_aof_buffer:3740\r\nmem allocator:jenalloc-5.1.0 active_defrag_running:0 lazyfree_pending_objects:0 #Persistence\r\nloading:0\r\nrdb_changes since _last_save:20256 rdb_bgsave_in_progress:1\r\nrdb_last_save_time:1655811753 rdb_last_bgsave_status:err rdb_last_bgsave_time_sec:8 rdb_current_bgsave_time_sec:6 rdb_last_cow_size:6205440 aof_enabled:1\r\nmof_rewrite_in_progress:0 aof_rewrite_scheduled:0 aof_last_rewrite_time_sec:12 aof_current_rewrite time sec:-1 aof_last_bgrewrite_status:ok aof last_write_status:ok aof_last_cow_size:9342976 aof_current_size:498228060 aof_base_size:281845178 aof_pending rewrite:0 aof_buffer length:0\r\nnof_rewrite buffer length:0 aof pending_bio_fsync:0 aof_delayed_fsync:30 # Stats\r\ntotal connections_received:349278 total commands processed:3699871959 instantaneous_ops_per_sec:4901 total net input bytes:363225698884 total net output bytes:363490433045 instantaneous_input_kbps:236.74 instantaneous_output_kbps:1131.02 rejected_connections:0\r\nsync_full:0 sync_partial_ok:0 sync_partial_err:0 expired_keys:19156464 expired_stale_perc:0.32\r\nexpired_time_cap_reached_count:0 evicted keys:0\r\nkeyspace_hits:475505663 keyspace_misses:292239404 pubsub_channels:1\r\npubsub_patterns:0 latest_fork_usec:31048 migrate cached sockets:0 slave_expires_tracked keys:0 active_defrag_hits:0\r\nactive defrag misses:0 active_defrag_key_hits:e active_defrag_key_misses:0 # Replication\r\nrole:master\r\nconnected slaves:0\r\nmaster_replid:d7953059d8411a171b79457388cd415b7ae5f2c2 master_replid2:00000000000000\r\n00000 master_repl_offset:0\r\nsecond_repl_offset:-1 repl backlog_active:0 repl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0 repl backlog_histlen:0\r\n# CPU\r\nused_cpu_sys:71393.377563 used_cpu_user:85765.102154\r\nused_cpu sys_children:7421.702684 used_cpu_user_children:103487.149565 # Commandstats\r\ncmdstat_get:calls=49215416,usec=267117912,usec_per_cail=5.43 mdstat_rpush:calls-79434791,usec-500566120,usec_per_call-6.30 cmdstat_hset:calls-11150603,usec=49281810,usec_per call-4.42 cmdstat_del:calls-151166063,usec-906272849,usec_per_call-6.00 cmdstat_incrby:calls-4,usec-66,usec_per_call-16.50\r\ncmdstat_hincrby:calls-238401,usec-1644202,usec_per_ca1l-6.90 cmdstat_multi:calls=10346964,usec-9179564,usec_per_call=0.9 cmdstat_hget:calls-514831,usec-1439323,usec_per_call-2.80\r\ncmdstat_expire:calls-121029559,usec-532028053,usec_per_call-4.40 cmdstat_info:calls=128094,usec=13935989,usec_per_call=108.80 cmdstat_publish:calls-9900,usec-147496,usec_per_call-14.90 cmdstat_ping:calls=2196921,usec=2348718,usec_per_ca11=1.07 cmdstat_incr:calls-1236,usec-5716,usec_per_call-4.62 cmdstat_setnx:calls-286,usec-1338,usec_per_call-4.68\r\ncmdstat_set:calls=89140544,usec=512096422,usec_per_cal1=5.74 cmdstat_hgetall:calls-425782720,usec-4015414117,usec_per_ca11-9.43 cmdstat_discard:calls-3,usec=3,usec_per_call-1.00\r\ncmdstat_exists:calls=124054961,usec=532620304,usec_per_call=4.29 cmdstat_hdel:calls-3072,usec-11995,usec_per_call-3.90\r\ncmdstat_11en:calls-39035262,usec-70148055,usec_per_ca1l-1.80 cmdstat_setex:calls-50797064,usec=259738442,usec_per_call=5.11 cmdstat_subscribe:calls-30,usec-298,usec_per_call-9.93\r\ncmdstat_auth:calls-368952,usec-889573,usec_per_call-2.41\r\ncmdstat_1rem:calls-39035262,usec-9945641730,usec_per_call-254.79 cmdstat_1range:calls-129141877,usec-547276048,usec_per_call-4.24 cmdstat_hmset:calls=168224392,usec=2683597423,usec_per_call=16.75 cmdstat select:calls-2193928833,usec-2108313766,usec_per_cal1-0.96 cmdstat brpop:calls-12576849,usec-128083214,usec per call-10.18 cmdstat_exec:calls-10346961,usec-315159311,usec_per_call-30.46 # Clusten\r\ncluster enabled:0 # Keyspace\r\ndbe:keys=42,expires=0,avg_ttl=0 dbl:keys-1,expires-0,avg_tt1-0\r\ndb2:keys=86,expires=83,avg_tt1=5492815 db3:keys-26,expires-25,avg_tt1-16510023\r\ndb4:keys-1047620,expires-1047587,avg_tt1-108304128 db10:keys=63,expires=0,avg_ttl=0\r\ndb15:keys-24,expires-0,avg_tt1-0 -CLIENT LIST OUTPUT-----\r\nid-231843 addr-193.168.10.208:53534 fd-19 name- age-1998118 idle-4611 flags-P db-0 sub-1 psub-0 multi--1 qbuf-0 qbuf-frec-0 obl-0 o11-0 omem-0 events-r cmd-subscribe id-235092 addr-193.168.10.208:57850 fd-16 names age-1929425 idle-4611 flags-P db-0 sub-1 psub-0 multi--1 qbuf-0 qbuf-free-0 obl-0 ol1-0 omem-0 eventsar cmdasubscribe id-349279 addr=193.168.10.208:40128 fd-33 name= age=6 idle=4 flags=N db-4 sub-8 psub=e multi=-1 qbuf=0 qbuf-free=0 obl=0 oll-0 omem=0 events=r cmd-set\r\nid-231847 addr-193.168.10.208:53568 fd-25 nane- age-1998102 idle-4611 flags-P db-0 sub-1 psub-0 multi--1 qbuf-0 qbuf-free-0 obl-0 o11-0 omem-0 events-r cmd-subscribe 1d*41685 addr=193.168.10.208:60096 fd=11 name=age=5212938 idle=4611 flags=P db=0 sub=1 psub=θ multi=-1 qbuf=0 qbuf-free=0 obl=0 o11=0 omem=0 eventsar cnd=subscribe id-231850 addr-193.168.10.208:53706 fd-28 name= age-1998051 idle=4611 flags-P db-0 sub-1 psub=θ multi=-1 qbuf=0 qbuf-free=0 obl-0 o11-0 omem-0 events=r cmd-subscribe id-349275 addr-193.168.10.208:39920 fd=27 name-age-14 idle-0 flags-N db-4 sub-0 psub-0 multi--1 qbuf-92 qbuf-free-32676 ob1-0 011-0 omem-e eventser cnd-1range id=349267 addr=193.168.10.208:39266 fd=18 nane= age=44 idle=1 flags=N db=4 sub=θ psub=θ multi=-1 qbuf=θ qbuf-free=32768 obl=θ o11=0 omem=8 events=r cmd=brpop id-349273 addr-193.168.10.208:39917 fd-9 name- age-14 idle-1 flags-N db-4 sub-0 psub-0 multi--1 qbuf=0 qbuf-free-32768 ob1-0 o11-0 onem-e events-r cmd-set id=349274 addr=193.168.10.208:39916 fd=20 name=age=14 idle=1 flags=N db=4 sub=0 psub=θ multi=-1 qbuf=θ qbuf-free=32768 obl=0 o1l=0 onem-0 events=r cmd=1range id=349277 addr=193.168.10.208:40064 fd=24 name= age=9 idle=1 flags=N db=2 sub=Ø psub=θ multi=-1 qbuf=0 qbuf-free=0 obl=0 011=0 omem=0 eventser cmd=exec\r\nid-349278 addr-193.168.10.20B:40068 fd-26 nane- age-9 idle-1 flags-N db-2 sub-0 psub-0 multi--1 qbuf-0 qbuf-free-0 ob1-0 o11-0 omem-0 eventser cmd-exec\r\nid=231852 addr-193.168.10.208:53852 fd-29 nanes age-1998008 idle-4611 flags=P db-0 sub-1 psub=0 multia-1 qbuf=0 qbuf-free=0 obl=0 o11=0 omem=0 eventsar cmd-subscribe id-231840 addr-193.168.10.208:53294 fd-15 nane= age-1998208 idle-4611 flags=P db=0 sub=1 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl-0 oll=0 omem=0 eventser cmd-subscribe id-235112 addr-193.168.10.208:58456 fd-13 nane-age-1929211 idle-4611 flags-P db-0 sub-1 psub-θ multi--1 qbuf-0 qbuf-free-0 ob1-0 011-0 omem-0 events-r cmd-subscribe\r\naddr=193.168.10.208:54438 fd=104 name= age=1997845 idle=4611 flags=P db=θ sub=1 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 ol1=0 omem=0 events=r cmd=subscribe\r\n193,1,1.2    anese cad-subscrbe\r\naddr=193.168.10.208:54142 fd-8 name-age-1997890 idle-4611 flags-P db-0 sub-1 psub-θ multi--1 qbuf-0 qbuf-free=0 obl-0 o11-8 omcm-0 events=r cnd-subscribe ------\r\nCURRENT CLIENT INFO\r\nid-349275 addr-193.168.10.208:39920 fd-27 name- age-14 idle-0 flags-N db=4 sub-0 psub-0 multi--1 qbuf-92 qbuf-free-32676 ob1-8 o11-8 omem-0 eventser cmd-1range argv[e]:'LRANGE\r\nargv[1]: 'datahub.sys.tiner.abe8fbb1-a600-4923-b4f9-8f6989f9b91d' arEV[2]:'0'\r\nargv[3]:*-1*\r\nREGISTERS\r\n2532:M 21 Jun 2022 19:55:12.085#\r\nRAX:0000000000000000 RBX:00000000000000c5 RCX:0000000000e89800 RDX:00000000000135c0 RDI:00007f3468715760 RSI:0000000000000000 RBP:000000000052c2e1 RSP:00007fffd61095a0 R8:0000000000000001 R9:00007f346925cf80 R10:7562206568742074 R11:0000000000000206 R12:000000000052c328 R13:00007f3467e2b050 R14:66000000000000aa0 R15:00007+3467e8bb40 RIP:000000000046e73a EFL:0000000000010206 CSGSFS:0000000000000033\r\n2532:M 21 Jun 2022 19:55:12,085 #(00007fffd61095af)->0000000000000000 2532:M 21 Jun 2022 19:55:12.085 #(00007fffd61095ae)->00007f3467e3c790 2532:M 21 Jun 2022 19:55:12.086 #(00007fffd61095ad)->00007f3467e1ad00 2532:M 21 Jun 2022 19:55:12.086#(00307fffd61095ac)->00007f340d5eeb00 2532:H 21 Jun 2022 19:55:12.086 #(00007fffd61095ab)>\r\n000000000042cc2a 2532:M 21 Jun 2022 19:55:12.086 #(00007+ffd61095aa)->\r\n00007f3467e0bb48 2532:M 21 Jun 2022 19:55:12.886#(00007fffd61095a9)->\r\n0000000000000000 2532:H 21 Jun 2022 19:55:12.086#(00007fffd61095a8)->\r\n00007f3467e2b050 2532:M\r\n21 Jun 2022 19:55:12.086#(00007fffd61095a7)->\r\n0000000000000000 2532:H 21 Jun 2022 19:55:12.086*(00007fffd61095a6)\r\n->\r\n00007f344406c0c3 2532:M 21 Jun 2022 19:55:12.086#(00007fffd6109585)->\r\n00007f3467e1a000 2532:M 21 Jun 2022 19:55:12.086#(08007+ffd61095a4)->\r\n0000000000000000 2532:M 21 Jun 2022 19:55:12.086 #(00007fffd61095a3)->000000000042c340 2532:H 21 Jun 2022 19:55:12.086#(00007fffd61095a2)-\r\n2000000000000000\r\n2532:M 21 Jun 2022 19:55:12.086=(00007fffd61095a1)->80007f344406c0c3 2532:8 21 Jun 2022 19:55:12.086 #(00007fffd61095a0)\r\n->\r\n00007f3467c0bb40 --\r\nFAST MEMORY TEST\r\n2532:H 21 Jun 2022 19:55:12.087# Bio thread for job type le terminated 2532:H 21 Jun 2022 19:55:12.088 # Bio thread for job type #1 terminated 2532:H 21 Jun 2022 19:55:12.088# Bio thread for job type #2 terminated\r\n***Preparing to test menory region 78d000 (2252800 bytes)\r\n***Preparing to test memory region e7ceee(135168 bytes)\r\n***Preparing to test memory region 7f3409e00000 (1277165568 bytes)\r\n***Preparing to test menory region 7f34560ba000 (163577856 bytes)\r\n**Preparing to test menory region 7+345fcbb000(8388608 bytes)\r\n***Preparing to test memory region 7f34604bc000(8388608 bytes) Preparing to test menory region 7f3460cbd000 (8388608 bytes)\r\n***Preparing to test memory region 7f3467a00000 (8388608 bytes)\r\n***Preparing to test menory region 7f3468717000(20480 bytes)\r\n***Preparing to test menory region 7f3468934000(16384 bytes)\r\n***Preparing to test memory region 7f346925b000(20480 bytes)\r\n***Preparing to test memory region 7f3469265000(4096 bytes)\r\n**Preparing to test memory region 7f3469266000(4096 bytes)\r\n*** Preparing to test memory region 7f3469269000 (4096 bytes) 0.0.0.0.0.0.0.0.0.0.0.0.0.0\r\nFast memory test PASSED,however your memory can still be broken.Please run a memory test for several hours if possible. -DUMPING CODE AROUND EIP\r\nSymbol: serverAssert (base:0x46e6d0)\r\nModule:redis-rdb-bgsave*:63791 (base 0x400000) $ xxd-r-p/tep/dump.hex/tmp/dump.bin\r\n$objdump--adjust-vma-0x46e6de -D -b binary -m 1386:x86-64/tmp/dump.bin 28167:C-21 Jun 2022 19:55:14.064=dunp of function (hexdump of 234 bytes):\r\n41548605940b32004989fc554889f585c05389d37505e8f5fdffffbeaec65300bf0300000031c0e874fafbff4d89e089d94889eabec7c65300bf0300000031c0eB5bfafbffbe48b65300bf0300000031c04c8925300b32004889 F1f84000000000041544989fc55534883c4808b150beb320085d20f84e700000031cebe78b65300bf03000000e6f6f9fbff418b9424a000000031c0bee2c65300bf0300000031ed31dbe8d9f9Fbff418b54240831c0bef5c6530 REDIS BUG REPORT END.Make sure to include from START to END.O\r\nPlease report the crash by opening an issue on github: http://github.com/antirez/redis/issues\r\nsuspect RAM error? Use redis-server--test-memory to verify it. 0.0.0.0.0.0.0.0.0.0.0.0\r\nFast nenory test PASSED,however your memory can still be broken,Please run a memory test for several hours if possible. ------\r\nDUMPING CODE AROUND EIP. Symbol: serverAssert (base: 0x46e6de)\r\nModule:/home/redis/bin/redis-server *:63791 (base 0x400000) $xxd-r-p/tmp/durp.hex/tmp/dump.bin\r\n$ objdump--adjust-vma-0x46e6de-D-b binary-m 1386:x86-64/tmp/dump.bin -----\r\n2532:H 21 Jun 2022 19:55:18.751 #dump of function(hexdump of 234 bytes):\r\n41548b05940b32004989fc5548891585c05389d37505e8f5faffffbeaec65300bf0300000031c0e874fafbff4d89e089d94889eabec7c65300bfe300000031cee85bfafbffbe48b65300bf0300000031c04c8925300b32004889 f1f84000000000041544989fc55534883c48086150b0b320085d20f84e700000031c0be78b65300bf03000000c8f6f9fbff418b9424a000000031c0bee2c65300bf0300000031ed31dbe8d9f9fbff418b54240831c0bef5c6530 REDIS BUG REPORT END.Make sure to include from START to END.\r\nPlease report the crash by opening an issue on github: http://github.com/antirez/redis/issues\r\nSuspect RAM error> Use redis-server--test-memory to verify it.\r\n29054:C 21 Jun 2022 20:09:47.673 #000000000000o Redis is starting o000000000000\r\n29054:C 21 Jun 2022 20:09:47.684 #Redis version-5.0.3,bits-64,commit-00000000,modified-0,pid-29054,just started 29054:C 21 Jun 2022 20:09:47.684 # Configuration loaded\r\n```\r\n\r\n\r\n\r\n",
  "state": "open",
  "created_at": "2022-06-30T06:09:06Z",
  "updated_at": "2022-07-04T06:28:53Z",
  "closed_at": null,
  "labels": [],
  "comments_data": [
    {
      "id": 1170809213,
      "user": "oranagra",
      "created_at": "2022-06-30T06:13:43Z",
      "body": "@tiggoliu please post it as text, not an image.\r\nplease also try to describe the scenario that lead to this crash.\r\nmaybe also include a few lines from the log file from before it crashed.\r\np.s. 5.0.3 is old, and no longer supported, chance are that this issue is already fixed."
    },
    {
      "id": 1170815616,
      "user": "tiggoliu",
      "created_at": "2022-06-30T06:23:26Z",
      "body": "@oranagra I hava update the bug report ,please confirm it ,thanks!"
    },
    {
      "id": 1170818449,
      "user": "oranagra",
      "created_at": "2022-06-30T06:27:35Z",
      "body": "@tiggoliu thank you. that's a little bit better since we can use copy / search on that text, but for some reason many line breaks disappeared and many lines are mashed together..\r\n"
    },
    {
      "id": 1172888515,
      "user": "hui-QY",
      "created_at": "2022-07-02T12:12:50Z",
      "body": "I also encountered this problem, did you solve it?"
    },
    {
      "id": 1173020442,
      "user": "oranagra",
      "created_at": "2022-07-03T06:20:21Z",
      "body": "@Gongyihui please describe what exactly you encountered, which version, what was the scenario which lead to it, and if yo can also post a crash log.\r\nmaybe additional info would lead to some realization."
    },
    {
      "id": 1173288494,
      "user": "hui-QY",
      "created_at": "2022-07-04T03:07:19Z",
      "body": "> @Gongyihui please describe what exactly you encountered, which version, what was the scenario which lead to it, and if yo can also post a crash log. maybe additional info would lead to some realization.\r\n\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n30073:M 02 Jul 2022 18:42:36.350 # === ASSERTION FAILED ===\r\n30073:M 02 Jul 2022 18:42:36.350 # ==> dict.c:197 'd->ht[0].size > (unsigned long)d->rehashidx' is not true\r\n30073:M 02 Jul 2022 18:42:36.350 # (forcing SIGSEGV to print the bug report.)\r\n30073:M 02 Jul 2022 18:42:36.350 # Redis 5.0.14 crashed by signal: 11\r\n30073:M 02 Jul 2022 18:42:36.350 # Crashed running the instruction at: 0x46fc6a\r\n30073:M 02 Jul 2022 18:42:36.350 # Accessing address: 0xffffffffffffffff\r\n30073:M 02 Jul 2022 18:42:36.350 # Failed assertion: d->ht[0].size > (unsigned long)d->rehashidx (dict.c:197)"
    },
    {
      "id": 1173364700,
      "user": "oranagra",
      "created_at": "2022-07-04T05:26:19Z",
      "body": "@Gongyihui thank you. do you happen to have some info about what triggers it, or how to reproduce it?\r\ncan you please post a complete crash log?"
    },
    {
      "id": 1173369777,
      "user": "hui-QY",
      "created_at": "2022-07-04T05:35:05Z",
      "body": "> @Gongyihui谢谢你。你碰巧有一些关于什么触发它的信息，或者如何重现它？ 你能发布一个完整的崩溃日志吗？\r\n```\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n30073:M 02 Jul 2022 18:42:36.350 # === ASSERTION FAILED ===\r\n30073:M 02 Jul 2022 18:42:36.350 # ==> dict.c:197 'd->ht[0].size > (unsigned long)d->rehashidx' is not true\r\n30073:M 02 Jul 2022 18:42:36.350 # (forcing SIGSEGV to print the bug report.)\r\n30073:M 02 Jul 2022 18:42:36.350 # Redis 5.0.14 crashed by signal: 11\r\n30073:M 02 Jul 2022 18:42:36.350 # Crashed running the instruction at: 0x46fc6a\r\n30073:M 02 Jul 2022 18:42:36.350 # Accessing address: 0xffffffffffffffff\r\n30073:M 02 Jul 2022 18:42:36.350 # Failed assertion: d->ht[0].size > (unsigned long)d->rehashidx (dict.c:197)\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](_serverAssert+0x6a)[0x46fc6a]\r\n\r\nBacktrace:\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](logStackTrace+0x29)[0x471e49]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](sigsegvHandler+0xac)[0x4724ec]\r\n/lib64/libpthread.so.0(+0xf5d0)[0x7f41b4d495d0]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](_serverAssert+0x6a)[0x46fc6a]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](dictRehash+0xf0)[0x42cad0]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](dictRehashMilliseconds+0x3d)[0x42cdbd]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](incrementallyRehash+0x33)[0x42ee33]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](databasesCron+0xd9)[0x42f3c9]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](serverCron+0x207)[0x431647]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](aeProcessEvents+0x32f)[0x42b32f]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](aeMain+0x2b)[0x42b56b]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster](main+0x4c0)[0x428350]\r\n/lib64/libc.so.6(__libc_start_main+0xf5)[0x7f41b498f495]\r\n/usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster][0x4285aa]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:5.0.14\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:1ab6cca463b399de\r\nredis_mode:cluster\r\nos:Linux 4.19.188-10.el7.ucloud.x86_64 x86_64\r\narch_bits:64\r\nmultiplexing_api:epoll\r\natomicvar_api:atomic-builtin\r\ngcc_version:4.8.5\r\nprocess_id:30073\r\nrun_id:15c09b32ac4428ea84ce0a1cd40c0454dcaaf46c\r\ntcp_port:7003\r\nuptime_in_seconds:6222846\r\nuptime_in_days:72\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:12591388\r\nexecutable:/usr/local/redis/bin/redis-server\r\nconfig_file:/data/redis/redis-cluster/7003/redis_7003.conf\r\n\r\n# Clients\r\nconnected_clients:46\r\nclient_recent_max_input_buffer:2\r\nclient_recent_max_output_buffer:0\r\nblocked_clients:0\r\n\r\n# Memory\r\nused_memory:506802784\r\nused_memory_human:483.32M\r\nused_memory_rss:542609408\r\nused_memory_rss_human:517.47M\r\nused_memory_peak:507100352\r\nused_memory_peak_human:483.61M\r\nused_memory_peak_perc:99.94%\r\nused_memory_overhead:129464684\r\nused_memory_startup:1456032\r\nused_memory_dataset:377338100\r\nused_memory_dataset_perc:74.67%\r\nallocator_allocated:507022752\r\nallocator_active:527568896\r\nallocator_resident:542932992\r\ntotal_system_memory:16537907200\r\ntotal_system_memory_human:15.40G\r\nused_memory_lua:37888\r\nused_memory_lua_human:37.00K\r\nused_memory_scripts:0\r\nused_memory_scripts_human:0B\r\nnumber_of_cached_scripts:0\r\nmaxmemory:0\r\nmaxmemory_human:0B\r\nmaxmemory_policy:volatile-lru\r\nallocator_frag_ratio:1.04\r\nallocator_frag_bytes:20546144\r\nallocator_rss_ratio:1.03\r\nallocator_rss_bytes:15364096\r\nrss_overhead_ratio:1.00\r\nrss_overhead_bytes:-323584\r\nmem_fragmentation_ratio:1.07\r\nmem_fragmentation_bytes:35726000\r\nmem_not_counted_for_evict:1266\r\nmem_replication_backlog:1048576\r\nmem_clients_slaves:16922\r\nmem_clients_normal:1073360\r\nmem_aof_buffer:1266\r\nmem_allocator:jemalloc-5.1.0\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nrdb_changes_since_last_save:23411\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1656758508\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:4\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_last_cow_size:4780032\r\naof_enabled:1\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:5\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:5279744\r\naof_current_size:264378112\r\naof_base_size:230215285\r\naof_pending_rewrite:0\r\naof_buffer_length:0\r\naof_rewrite_buffer_length:0\r\naof_pending_bio_fsync:0\r\naof_delayed_fsync:6\r\n\r\n# Stats\r\ntotal_connections_received:830383\r\ntotal_commands_processed:2990897394\r\ninstantaneous_ops_per_sec:1497\r\ntotal_net_input_bytes:97590575380\r\ntotal_net_output_bytes:326166986568\r\ninstantaneous_input_kbps:45.83\r\ninstantaneous_output_kbps:146.31\r\nrejected_connections:0\r\nsync_full:1\r\nsync_partial_ok:0\r\nsync_partial_err:1\r\nexpired_keys:18631934\r\nexpired_stale_perc:0.76\r\nexpired_time_cap_reached_count:0\r\nevicted_keys:0\r\nkeyspace_hits:440034801\r\nkeyspace_misses:170589145\r\npubsub_channels:0\r\npubsub_patterns:0\r\nlatest_fork_usec:8866\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:1\r\nslave0:ip=10.13.79.31,port=7006,state=online,offset=56763392337,lag=1\r\nmaster_replid:97aac61c0b415acca3717b157cb19df7ba505ba7\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:56763417832\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:1\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:56762369257\r\nrepl_backlog_histlen:1048576\r\n\r\n# CPU\r\nused_cpu_sys:54986.653833\r\nused_cpu_user:40102.149267\r\nused_cpu_sys_children:5557.904197\r\nused_cpu_user_children:90080.758779\r\n\r\n# Commandstats\r\ncmdstat_incr:calls=36797754,usec=152462236,usec_per_call=4.14\r\ncmdstat_hvals:calls=5953179,usec=51955765,usec_per_call=8.73\r\ncmdstat_dbsize:calls=18,usec=15,usec_per_call=0.83\r\ncmdstat_hdel:calls=30230,usec=391923,usec_per_call=12.96\r\ncmdstat_flushall:calls=1,usec=12288,usec_per_call=12288.00\r\ncmdstat_hget:calls=1447485,usec=6951048,usec_per_call=4.80\r\ncmdstat_info:calls=2,usec=127,usec_per_call=63.50\r\ncmdstat_ping:calls=1493163637,usec=561356102,usec_per_call=0.38\r\ncmdstat_scan:calls=180,usec=25454,usec_per_call=141.41\r\ncmdstat_command:calls=3,usec=3742,usec_per_call=1247.33\r\ncmdstat_psync:calls=1,usec=458,usec_per_call=458.00\r\ncmdstat_replconf:calls=6209600,usec=10545123,usec_per_call=1.70\r\ncmdstat_set:calls=159819003,usec=923218537,usec_per_call=5.78\r\ncmdstat_auth:calls=829698,usec=1091309,usec_per_call=1.32\r\ncmdstat_expire:calls=646367311,usec=1240877456,usec_per_call=1.92\r\ncmdstat_setex:calls=3267313,usec=28185355,usec_per_call=8.63\r\ncmdstat_get:calls=603223282,usec=2447400634,usec_per_call=4.06\r\ncmdstat_hset:calls=441365,usec=7814003,usec_per_call=17.70\r\ncmdstat_del:calls=33346829,usec=118653501,usec_per_call=3.56\r\ncmdstat_cluster:calls=503,usec=46573,usec_per_call=92.59\r\n\r\n# Cluster\r\ncluster_enabled:1\r\n\r\n# Keyspace\r\ndb0:keys=1049527,expires=1048633,avg_ttl=1310323254082\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=830363 addr=10.13.127.128:60962 fd=38 name= age=58 idle=2 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830371 addr=10.13.79.238:30580 fd=34 name= age=35 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=setex\r\nid=830341 addr=10.13.127.128:49508 fd=22 name= age=118 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830380 addr=10.13.180.225:55788 fd=47 name= age=9 idle=9 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830381 addr=10.13.180.225:55790 fd=56 name= age=9 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830376 addr=10.13.180.225:54812 fd=7 name= age=15 idle=15 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830377 addr=10.13.180.225:54814 fd=14 name= age=15 idle=15 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830378 addr=10.13.180.225:54816 fd=16 name= age=15 idle=15 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830379 addr=10.13.180.225:54818 fd=26 name= age=15 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830354 addr=10.13.180.225:43748 fd=23 name= age=75 idle=15 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830357 addr=10.13.79.238:24284 fd=51 name= age=65 idle=5 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830258 addr=10.13.79.238:29404 fd=45 name= age=305 idle=5 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830368 addr=10.13.142.210:12062 fd=40 name= age=47 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830369 addr=10.13.142.210:12064 fd=42 name= age=47 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830382 addr=10.13.79.238:36620 fd=63 name= age=5 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830331 addr=10.13.79.238:11584 fd=57 name= age=125 idle=5 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830359 addr=10.13.41.219:27888 fd=55 name= age=64 idle=4 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830375 addr=10.13.138.111:58118 fd=53 name= age=21 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830360 addr=10.13.41.219:27890 fd=58 name= age=64 idle=4 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830336 addr=10.13.127.128:49480 fd=46 name= age=118 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830337 addr=10.13.127.128:49482 fd=62 name= age=118 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830319 addr=10.13.138.111:25170 fd=64 name= age=171 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830320 addr=10.13.142.210:41224 fd=65 name= age=167 idle=17 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830372 addr=10.13.139.229:29124 fd=27 name= age=24 idle=24 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830383 addr=10.13.41.219:38916 fd=30 name= age=4 idle=4 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=830384 addr=10.13.41.219:38918 fd=39 name= age=4 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830385 addr=10.13.41.219:38920 fd=61 name= age=4 idle=3 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830373 addr=10.13.139.229:29126 fd=37 name= age=24 idle=2 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830374 addr=10.13.139.229:29130 fd=60 name= age=24 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830346 addr=10.13.79.238:18128 fd=54 name= age=95 idle=5 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830350 addr=10.13.138.111:45098 fd=59 name= age=81 idle=21 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830342 addr=10.13.138.111:38264 fd=35 name= age=111 idle=21 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830343 addr=10.13.142.210:54042 fd=24 name= age=107 idle=9 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830344 addr=10.13.142.210:54044 fd=50 name= age=107 idle=17 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830300 addr=10.13.138.111:18630 fd=49 name= age=201 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=830348 addr=10.13.139.229:18532 fd=32 name= age=84 idle=24 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=incr\r\nid=830370 addr=10.13.180.225:50008 fd=36 name= age=39 idle=9 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=incr\r\nid=830349 addr=10.13.139.229:18534 fd=41 name= age=84 idle=24 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830355 addr=10.13.180.225:44622 fd=31 name= age=69 idle=9 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830364 addr=10.13.127.128:60978 fd=11 name= age=58 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830365 addr=10.13.127.128:60980 fd=12 name= age=58 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830366 addr=10.13.127.128:60982 fd=21 name= age=58 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830367 addr=10.13.127.128:60984 fd=52 name= age=58 idle=2 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=830356 addr=10.13.180.225:44624 fd=48 name= age=69 idle=9 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=5 addr=10.13.79.31:13387 fd=10 name= age=6222768 idle=0 flags=S db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=replconf\r\nid=830361 addr=10.13.127.128:60958 fd=25 name= age=58 idle=28 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=830362 addr=10.13.127.128:60960 fd=33 name= age=58 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\n\r\n------ REGISTERS ------\r\n30073:M 02 Jul 2022 18:42:36.351 # \r\nRAX:0000000000000000 RBX:00000000000000c5\r\nRCX:0000000001616670 RDX:0000000000012750\r\nRDI:00007f41b4d33760 RSI:0000000000000000\r\nRBP:000000000052ee01 RSP:00007ffeab40b500\r\nR8 :0000000000000001 R9 :00007f41b5879f80\r\nR10:7562206568742074 R11:0000000000000206\r\nR12:000000000052ee48 R13:000000000000001f\r\nR14:0000000000000063 R15:0000000000000000\r\nRIP:000000000046fc6a EFL:0000000000010206\r\nCSGSFS:002b000000000033\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50f) -> 0000000000000001\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50e) -> 0000000000000010\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50d) -> 0000000000000000\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50c) -> 00007f419c379e40\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50b) -> 000000000042cdbd\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b50a) -> 00007f41b44150c0\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b509) -> 20c49ba5e353f7cf\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b508) -> 00000181be8156be\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b507) -> 0000000000000001\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b506) -> 00007f41b440b420\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b505) -> 00000000000000c8\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b504) -> 0000000000000064\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b503) -> 000000000042cad0\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b502) -> 00000000000003d8\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b501) -> 00007f4195a8d5d8\r\n30073:M 02 Jul 2022 18:42:36.351 # (00007ffeab40b500) -> 00007f41b440b420\r\n\r\n------ FAST MEMORY TEST ------\r\n30073:M 02 Jul 2022 18:42:36.351 # Bio thread for job type #0 terminated\r\n30073:M 02 Jul 2022 18:42:36.352 # Bio thread for job type #1 terminated\r\n30073:M 02 Jul 2022 18:42:36.352 # Bio thread for job type #2 terminated\r\n*** Preparing to test memory region 791000 (2252800 bytes)\r\n*** Preparing to test memory region 1608000 (135168 bytes)\r\n*** Preparing to test memory region 7f4163a00000 (1186988032 bytes)\r\n*** Preparing to test memory region 7f41aa680000 (18350080 bytes)\r\n*** Preparing to test memory region 7f41ab840000 (2621440 bytes)\r\n*** Preparing to test memory region 7f41abac1000 (10485760 bytes)\r\n*** Preparing to test memory region 7f41ac4c2000 (10485760 bytes)\r\n*** Preparing to test memory region 7f41acec3000 (10485760 bytes)\r\n*** Preparing to test memory region 7f41b4000000 (8388608 bytes)\r\n*** Preparing to test memory region 7f41b4d35000 (20480 bytes)\r\n*** Preparing to test memory region 7f41b4f52000 (16384 bytes)\r\n*** Preparing to test memory region 7f41b5878000 (20480 bytes)\r\n*** Preparing to test memory region 7f41b5883000 (4096 bytes)\r\n*** Preparing to test memory region 7f41b5884000 (4096 bytes)\r\n*** Preparing to test memory region 7f41b5887000 (4096 bytes)\r\n.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n------ DUMPING CODE AROUND EIP ------\r\nSymbol: _serverAssert (base: 0x46fc00)\r\nModule: /usr/local/redis/bin/redis-server 10.13.72.193:7003 [cluster] (base 0x400000)\r\n$ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\n$ objdump --adjust-vma=0x46fc00 -D -b binary -m i386:x86-64 /tmp/dump.bin\r\n------\r\n30073:M 02 Jul 2022 18:42:43.054 # dump of function (hexdump of 234 bytes):\r\n41548b05ac3632004989fc554889f585c05389d37505e8f5fdffffbe8ef45300bf0300000031c0e8d4ecfbff4d89e089d94889eabea7f45300bf0300000031c0e8bbecfbffbe28e45300bf0300000031c04c89254836320048892d49363200891d4b363200e896ecfbffc60425ffffffff785b5d415cc3660f1f84000000000041544989fc55534883c4808b152336320085d20f84e700000031c0be58e45300bf03000000e856ecfbff418b9424a000000031c0bec2f45300bf0300000031ed31dbe839ecfbff418b54240831c0bed5f45300bf03000000e823ecfbff418b54244031c0bee5f45300bf\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n\r\n       Please report the crash by opening an issue on github:\r\n\r\n           http://github.com/antirez/redis/issues\r\n\r\n  Suspect RAM error? Use redis-server --test-memory to verify it.\r\n```"
    },
    {
      "id": 1173379126,
      "user": "oranagra",
      "created_at": "2022-07-04T05:52:06Z",
      "body": "any chance you can try a more recent version of Redis?\r\nlooking at dict.c between this version and the 6.2, i see dict.c is unchanged, however, i haven't seen any similar reports and i'm unable to reproduce or figure out what the problem is."
    },
    {
      "id": 1173380047,
      "user": "tiggoliu",
      "created_at": "2022-07-04T05:53:46Z",
      "body": "> I also encountered this problem, did you solve it?\r\n\r\nI had update the redis to 5.0.14 version."
    },
    {
      "id": 1173382397,
      "user": "hui-QY",
      "created_at": "2022-07-04T05:57:58Z",
      "body": "> 您有机会尝试更新版本的 Redis 吗？ 查看这个版本和 6.2 之间的 dict.c，我看到 dict.c 没有改变，但是，我没有看到任何类似的报告，我无法重现或找出问题所在。\r\n\r\nThe production environment is inconvenient to update"
    },
    {
      "id": 1173395000,
      "user": "hui-QY",
      "created_at": "2022-07-04T06:15:43Z",
      "body": "There is another bug, please take a look\r\n\r\n> any chance you can try a more recent version of Redis? looking at dict.c between this version and the 6.2, i see dict.c is unchanged, however, i haven't seen any similar reports and i'm unable to reproduce or figure out what the problem is.\r\n\r\nThere is another bug, please take a look"
    },
    {
      "id": 1173395479,
      "user": "hui-QY",
      "created_at": "2022-07-04T06:16:20Z",
      "body": "> any chance you can try a more recent version of Redis? looking at dict.c between this version and the 6.2, i see dict.c is unchanged, however, i haven't seen any similar reports and i'm unable to reproduce or figure out what the problem is.\r\n```\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n3169:M 22 Jun 2022 12:43:04.536 # Redis 5.0.14 crashed by signal: 11\r\n3169:M 22 Jun 2022 12:43:04.536 # Crashed running the instruction at: 0x431e0e\r\n3169:M 22 Jun 2022 12:43:04.536 # Accessing address: 0x7fba00010008\r\n3169:M 22 Jun 2022 12:43:04.536 # Failed assertion: <no assertion failed> (<no file>:0)\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](processCommand+0x1e)[0x431e0e]\r\n\r\nBacktrace:\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](logStackTrace+0x29)[0x471e49]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](sigsegvHandler+0xac)[0x4724ec]\r\n/lib64/libpthread.so.0(+0xf5d0)[0x7fbad85275d0]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](processCommand+0x1e)[0x431e0e]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](processInputBuffer+0x175)[0x4410c5]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](aeProcessEvents+0x2a0)[0x42b2a0]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](aeMain+0x2b)[0x42b56b]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster](main+0x4c0)[0x428350]\r\n/lib64/libc.so.6(__libc_start_main+0xf5)[0x7fbad816d495]\r\n/usr/local/redis/bin/redis-server 10.13.115.123:7001 [cluster][0x4285aa]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:5.0.14\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:eeedfe8753b30ce3\r\nredis_mode:cluster\r\nos:Linux 4.19.188-10.el7.ucloud.x86_64 x86_64\r\narch_bits:64\r\nmultiplexing_api:epoll\r\natomicvar_api:atomic-builtin\r\ngcc_version:4.8.5\r\nprocess_id:3169\r\nrun_id:46da8bc086b71db9d6f36c663537f1ec7389af82\r\ntcp_port:7001\r\nuptime_in_seconds:5337274\r\nuptime_in_days:61\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:11705816\r\nexecutable:/usr/local/redis/bin/redis-server\r\nconfig_file:/data/redis/redis-cluster/7001/redis_7001.conf\r\n\r\n# Clients\r\nconnected_clients:27\r\nclient_recent_max_input_buffer:2\r\nclient_recent_max_output_buffer:0\r\nblocked_clients:0\r\n\r\n# Memory\r\nused_memory:269238152\r\nused_memory_human:256.77M\r\nused_memory_rss:319258624\r\nused_memory_rss_human:304.47M\r\nused_memory_peak:281246592\r\nused_memory_peak_human:268.22M\r\nused_memory_peak_perc:95.73%\r\nused_memory_overhead:58105306\r\nused_memory_startup:1456032\r\nused_memory_dataset:211132846\r\nused_memory_dataset_perc:78.85%\r\nallocator_allocated:268902488\r\nallocator_active:308342784\r\nallocator_resident:321269760\r\ntotal_system_memory:16537907200\r\ntotal_system_memory_human:15.40G\r\nused_memory_lua:37888\r\nused_memory_lua_human:37.00K\r\nused_memory_scripts:0\r\nused_memory_scripts_human:0B\r\nnumber_of_cached_scripts:0\r\nmaxmemory:0\r\nmaxmemory_human:0B\r\nmaxmemory_policy:volatile-lru\r\nallocator_frag_ratio:1.15\r\nallocator_frag_bytes:39440296\r\nallocator_rss_ratio:1.04\r\nallocator_rss_bytes:12926976\r\nrss_overhead_ratio:0.99\r\nrss_overhead_bytes:-2011136\r\nmem_fragmentation_ratio:1.19\r\nmem_fragmentation_bytes:50514304\r\nmem_not_counted_for_evict:1122\r\nmem_replication_backlog:1048576\r\nmem_clients_slaves:16922\r\nmem_clients_normal:981246\r\nmem_aof_buffer:1122\r\nmem_allocator:jemalloc-5.1.0\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nrdb_changes_since_last_save:65870\r\nrdb_bgsave_in_progress:1\r\nrdb_last_save_time:1655872923\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:1\r\nrdb_current_bgsave_time_sec:0\r\nrdb_last_cow_size:2973696\r\naof_enabled:1\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:2\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:3010560\r\naof_current_size:226527648\r\naof_base_size:130822830\r\naof_pending_rewrite:0\r\naof_buffer_length:0\r\naof_rewrite_buffer_length:0\r\naof_pending_bio_fsync:0\r\naof_delayed_fsync:3\r\n\r\n# Stats\r\ntotal_connections_received:586317\r\ntotal_commands_processed:4766783817\r\ninstantaneous_ops_per_sec:1384\r\ntotal_net_input_bytes:148520878623\r\ntotal_net_output_bytes:229403881424\r\ninstantaneous_input_kbps:41.61\r\ninstantaneous_output_kbps:51.59\r\nrejected_connections:0\r\nsync_full:1\r\nsync_partial_ok:0\r\nsync_partial_err:1\r\nexpired_keys:16330138\r\nexpired_stale_perc:1.37\r\nexpired_time_cap_reached_count:0\r\nevicted_keys:0\r\nkeyspace_hits:246441640\r\nkeyspace_misses:44394874\r\npubsub_channels:0\r\npubsub_patterns:0\r\nlatest_fork_usec:5096\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:1\r\nslave0:ip=10.13.72.193,port=7004,state=online,offset=106077585412,lag=1\r\nmaster_replid:238bdc40ebb6240d3b2152745078afc4c5a6d34b\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:106077603756\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:1\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:106076555181\r\nrepl_backlog_histlen:1048576\r\n\r\n# CPU\r\nused_cpu_sys:47015.673437\r\nused_cpu_user:34738.464793\r\nused_cpu_sys_children:2803.126697\r\nused_cpu_user_children:50352.920614\r\n\r\n# Commandstats\r\ncmdstat_psync:calls=1,usec=280,usec_per_call=280.00\r\ncmdstat_hdel:calls=3967,usec=27272,usec_per_call=6.87\r\ncmdstat_auth:calls=584778,usec=576746,usec_per_call=0.99\r\ncmdstat_hget:calls=713107,usec=2000977,usec_per_call=2.81\r\ncmdstat_info:calls=3,usec=126,usec_per_call=42.00\r\ncmdstat_getset:calls=6,usec=19,usec_per_call=3.17\r\ncmdstat_scan:calls=181,usec=15770,usec_per_call=87.13\r\ncmdstat_dbsize:calls=3,usec=1,usec_per_call=0.33\r\ncmdstat_hset:calls=213029,usec=1941564,usec_per_call=9.11\r\ncmdstat_expire:calls=1498652910,usec=1611615436,usec_per_call=1.08\r\ncmdstat_incr:calls=666486,usec=1224290,usec_per_call=1.84\r\ncmdstat_del:calls=55186,usec=76542,usec_per_call=1.39\r\ncmdstat_hvals:calls=10318830,usec=22502735,usec_per_call=2.18\r\ncmdstat_command:calls=2,usec=1199,usec_per_call=599.50\r\ncmdstat_replconf:calls=5322775,usec=5788665,usec_per_call=1.09\r\ncmdstat_set:calls=586904651,usec=929865099,usec_per_call=1.58\r\ncmdstat_cluster:calls=85,usec=6456,usec_per_call=75.95\r\ncmdstat_ping:calls=2381442021,usec=458617906,usec_per_call=0.19\r\ncmdstat_get:calls=279804571,usec=644540549,usec_per_call=2.30\r\ncmdstat_flushall:calls=1,usec=9660,usec_per_call=9660.00\r\ncmdstat_setex:calls=2101224,usec=11450612,usec_per_call=5.45\r\n\r\n# Cluster\r\ncluster_enabled:1\r\n\r\n# Keyspace\r\ndb0:keys=591222,expires=590638,avg_ttl=1125277365179\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=586310 addr=10.13.79.238:22266 fd=60 name= age=2 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=14 qbuf-free=32754 obl=0 oll=0 omem=0 events=r cmd=set\r\nid=586235 addr=10.13.180.225:15440 fd=28 name= age=235 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586273 addr=10.13.180.225:15822 fd=24 name= age=61 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586165 addr=10.13.180.225:14970 fd=25 name= age=415 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586144 addr=10.13.127.128:49650 fd=46 name= age=467 idle=3 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586241 addr=10.13.180.225:15576 fd=30 name= age=175 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586312 addr=10.13.180.225:15964 fd=7 name= age=1 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=auth\r\nid=586313 addr=10.13.180.225:15966 fd=22 name= age=1 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=hvals\r\nid=586285 addr=10.13.79.238:22162 fd=55 name= age=33 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586286 addr=10.13.79.238:22164 fd=56 name= age=33 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586190 addr=10.13.127.128:49778 fd=32 name= age=390 idle=3 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586261 addr=10.13.79.238:22040 fd=47 name= age=72 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=set\r\nid=586274 addr=10.13.127.128:50290 fd=29 name= age=33 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=4 addr=10.13.72.193:29855 fd=10 name= age=5337196 idle=0 flags=S db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=replconf\r\nid=586228 addr=10.13.180.225:15284 fd=26 name= age=295 idle=25 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586255 addr=10.13.127.128:50204 fd=36 name= age=93 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586232 addr=10.13.127.128:50006 fd=27 name= age=243 idle=2 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586246 addr=10.13.180.225:15706 fd=33 name= age=115 idle=4 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586294 addr=10.13.180.225:15908 fd=21 name= age=31 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586295 addr=10.13.180.225:15910 fd=23 name= age=31 idle=1 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586296 addr=10.13.79.238:22238 fd=31 name= age=2 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586298 addr=10.13.79.238:22242 fd=37 name= age=2 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586300 addr=10.13.79.238:22246 fd=42 name= age=2 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586314 addr=10.13.79.238:22280 fd=39 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586315 addr=10.13.79.238:22282 fd=41 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586317 addr=10.13.79.238:22288 fd=45 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\nid=586318 addr=10.13.79.238:22290 fd=48 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=ping\r\nid=586319 addr=10.13.79.238:22292 fd=50 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=expire\r\n\r\n```"
    },
    {
      "id": 1173404674,
      "user": "hui-QY",
      "created_at": "2022-07-04T06:28:53Z",
      "body": "> > I also encountered this problem, did you solve it?\r\n> \r\n> I had update the redis to 5.0.14 version.\r\n\r\nThe bug still exists in this version"
    }
  ]
}