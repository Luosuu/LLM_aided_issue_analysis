{
  "issue_number": 7657.0,
  "title": "[BUG] make test fails on CentOS 8 for Redis 6.0.6",
  "body": "**Describe the bug**\r\nTests Fail on CentOS 8 for Redis 6.0.6\r\n\r\n**To reproduce**\r\nwget http://download.redis.io/releases/redis-6.0.6.tar.gz\r\ntar xzf redis-6.0.6.tar.gz\r\ncd redis-6.0.6\r\nyum -y install make gcc jemalloc-devel tcl\r\nmake\r\nmake test\r\n\r\n**Expected behavior**\r\nTests to pass\r\n\r\n**Additional information**\r\n\r\n- CentOS Linux release 8.2.2004 (Core) \r\n- Linux redis1 4.18.0-193.14.2.el8_2.x86_64 #1 SMP Sun Jul 26 03:54:29 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n- 2GB Memory\r\n- Redis 5.0.9 installs and passes tests just fine\r\n- SELinux Disabled\r\n\r\n\r\n```\r\n...\r\n[54/56 done]: unit/type/list-3 (99 seconds)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Test replication partial resync: no reconnection, just sync (diskless: yes, disabled, reconnect: 0)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Connect multiple replicas at the same time (issue #141), master diskless=yes, replica diskless=disabled\r\n[ok]: Test replication partial resync: ok psync (diskless: yes, disabled, reconnect: 1)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Test replication partial resync: no backlog (diskless: yes, disabled, reconnect: 1)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Connect multiple replicas at the same time (issue #141), master diskless=yes, replica diskless=swapdb\r\n[ok]: Test replication partial resync: ok after delay (diskless: yes, disabled, reconnect: 1)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Test replication partial resync: backlog expired (diskless: yes, disabled, reconnect: 1)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Test replication partial resync: no reconnection, just sync (diskless: yes, swapdb, reconnect: 0)\r\n[ok]: Slave should be able to synchronize with the master\r\n[ok]: Detect write load to master\r\n[ok]: Master stream is correctly processed while the replica has a script in -BUSY state\r\n[ok]: slave fails full sync and diskless load swapdb recovers it\r\n[ok]: Test replication partial resync: ok psync (diskless: yes, swapdb, reconnect: 1)\r\n\r\n\r\nLogged warnings (pid 6180):\r\n(none)\r\n\r\n\r\nLogged warnings (pid 6180):\r\n(none)\r\n\r\n[exception]: Executing test client: tail: cannot open '+31' for reading: No such file or directory.\r\ntail: cannot open '+31' for reading: No such file or directory\r\n    while executing\r\n\"exec tail +$from_line < $stdout\"\r\n    (procedure \"wait_for_log_message\" line 5)\r\n    invoked from within\r\n\"wait_for_log_message -1 \"*Loading DB in memory*\" $loglines 2000 1\"\r\n    (\"uplevel\" body line 43)\r\n    invoked from within\r\n\"uplevel 1 $code \"\r\n    (procedure \"start_server\" line 3)\r\n    invoked from within\r\n\"start_server {} {\r\n            set master [srv 0 client]\r\n            set master_host [srv 0 host]\r\n            set master_port [srv 0 port]\r\n\r\n           ...\"\r\n    (\"uplevel\" body line 5)\r\n    invoked from within\r\n\"uplevel 1 $code \"\r\n    (procedure \"start_server\" line 3)\r\n    invoked from within\r\n\"start_server {tags {\"repl\"}} {\r\n        set replica [srv 0 client]\r\n        set replica_host [srv 0 host]\r\n        set replica_port [srv 0 port]\r\n        ...\"\r\n    (\"uplevel\" body line 2)\r\n    invoked from within\r\n\"uplevel 1 $code\"\r\n    (procedure \"test\" line 47)\r\n    invoked from within\r\n\"test {diskless loading short read} {\r\n    start_server {tags {\"repl\"}} {\r\n        set replica [srv 0 client]\r\n        set replica_host [srv 0 host]\r\n     ...\"\r\n    (file \"tests/integration/replication.tcl\" line 396)\r\n    invoked from within\r\n\"source $path\"\r\n    (procedure \"execute_test_file\" line 4)\r\n    invoked from within\r\n\"execute_test_file $data\"\r\n    (procedure \"test_client_main\" line 10)\r\n    invoked from within\r\n\"test_client_main $::test_server_port \"\r\nKilling still running Redis server 2174\r\nKilling still running Redis server 2190\r\nKilling still running Redis server 2262\r\nKilling still running Redis server 2463\r\nKilling still running Redis server 2999\r\nKilling still running Redis server 6168\r\nKilling still running Redis server 6216\r\nKilling still running Redis server 6228\r\nI/O error reading reply\r\n    while executing\r\n\"{*}$r type $k\"\r\n    (procedure \"createComplexDataset\" line 27)\r\n    invoked from within\r\n\"createComplexDataset $r $ops\"\r\n    (procedure \"bg_complex_data\" line 4)\r\n    invoked from within\r\n\"bg_complex_data [lindex $argv 0] [lindex $argv 1] [lindex $argv 2] [lindex $argv 3] [lindex $argv 4]\"\r\n    (file \"tests/helpers/bg_complex_data.tcl\" line 12)I/O error reading reply\r\n    while executing\r\n\"{*}$r type $k\"\r\n    (procedure \"findKeyWithType\" line 7)\r\n    invoked from within\r\n\"findKeyWithType {*}$r set\"\r\n    (\"uplevel\" body line 2)\r\n    invoked from within\r\n\"uplevel 1 [lindex $args $path]\"\r\n    (procedure \"randpath\" line 3)\r\n    invoked from within\r\n\"randpath {{*}$r sadd $k $v}  {{*}$r srem $k $v}  {\r\n                            set otherset [findKeyWithType {*}$r set]\r\n                            if...\"\r\n    (procedure \"createComplexDataset\" line 54)\r\n    invoked from within\r\n\"createComplexDataset $r $ops\"\r\n    (procedure \"bg_complex_data\" line 4)\r\n    invoked from within\r\n\"bg_complex_data [lindex $argv 0] [lindex $argv 1] [lindex $argv 2] [lindex $argv 3] [lindex $argv 4]\"\r\n    (file \"tests/helpers/bg_complex_data.tcl\" line 12)\r\nI/O error reading reply\r\n    while executing\r\n\"{*}$r type $k\"\r\n    (procedure \"createComplexDataset\" line 27)\r\n    invoked from within\r\n\"createComplexDataset $r $ops\"\r\n    (procedure \"bg_complex_data\" line 4)\r\n    invoked from within\r\n\"bg_complex_data [lindex $argv 0] [lindex $argv 1] [lindex $argv 2] [lindex $argv 3] [lindex $argv 4]\"\r\n    (file \"tests/helpers/bg_complex_data.tcl\" line 12)\r\n\r\nmake[1]: *** [Makefile:330: test] Error 1\r\nmake[1]: Leaving directory '/root/redis-6.0.6/src'\r\nmake: *** [Makefile:6: test] Error 2\r\n\r\n\r\n```",
  "state": "closed",
  "created_at": "2020-08-14T19:39:33Z",
  "updated_at": "2020-08-15T15:38:52Z",
  "closed_at": "2020-08-15T15:38:52Z",
  "labels": [
    "status:duplicate"
  ],
  "comments_data": [
    {
      "id": 674413483,
      "user": "itamarhaber",
      "created_at": "2020-08-15T15:38:52Z",
      "body": "Hello @erichowey \r\n\r\nThanks for reporting - this is a duplicate of #7552 and is resolved in the unstable branch via #7543.\r\n\r\nClosing."
    }
  ]
}