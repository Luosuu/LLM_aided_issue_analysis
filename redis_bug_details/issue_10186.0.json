{
  "issue_number": 10186.0,
  "title": "[CRASH] unfinished module timer causes crash after the module unload",
  "body": "**Crash report**\r\n```\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n13777:M 26 Jan 2022 15:31:51.542 # Redis 255.255.255 crashed by signal: 11, si_code: 1\r\n13777:M 26 Jan 2022 15:31:51.542 # Accessing address: 0x10a3366a0\r\n13777:M 26 Jan 2022 15:31:51.542 # Killed by PID: 0, UID: 0\r\n13777:M 26 Jan 2022 15:31:51.542 # Crashed running the instruction at: 0x10a3366a0\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\n0   ???                                 0x000000010a3366a0 0x0 + 4466108064\r\n\r\nBacktrace:\r\n0   libsystem_platform.dylib            0x00007ff807f5be2d _sigtramp + 29\r\n1   ???                                 0x00007ff7b5f6afd0 0x0 + 140701886492624\r\n2   redis-server                        0x0000000109f993b6 aeProcessEvents + 1062\r\n3   redis-server                        0x0000000109f9950d aeMain + 29\r\n4   redis-server                        0x0000000109faad92 main + 2082\r\n5   dyld                                0x000000011060f4fe start + 462\r\n\r\n------ REGISTERS ------\r\n13777:M 26 Jan 2022 15:31:51.542 #\r\nRAX:0000000000000000 RBX:00007ff7b5f6b4b0\r\nRCX:000000010a13a438 RDX:00000000000c67c7\r\nRDI:00007ff7b5f6b438 RSI:000060000251cfc0\r\nRBP:00007ff7b5f6b6c0 RSP:00007ff7b5f6b428\r\nR8 :000004265aaa5a31 R9 :0000000003ac62cb\r\nR10:0000000000000001 R11:00001ff7b346345c\r\nR12:00007ff7b5f6b438 R13:00007ff7b5f6b4b0\r\nR14:0000600002b16e00 R15:0005d67731fb0d63\r\nRIP:000000010a3366a0 EFL:0000000000010246\r\nCS :000000000000002b FS:0000000000000000  GS:0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b437) -> 0000000110340947\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b436) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b435) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b434) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b433) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b432) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b431) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b430) -> 0000000000000040\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42f) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42e) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42d) -> 0000000000000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42c) -> 00007fe903025400\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42b) -> 0000600000f14060\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b42a) -> 000000010a03c4e0\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b429) -> 0000000a00000000\r\n13777:M 26 Jan 2022 15:31:51.542 # (00007ff7b5f6b428) -> 000000010a0460fa\r\n```\r\n\r\n**How to reproduce this issue**\r\n1. Under redis source folder, launch the Redis server\r\n2. Load the timer module, `module load tests/modules/timer.so`\r\n3. Launch a timer like 5 seconds. `test.createtimer 5000 timer-incr-key`\r\n4. Meanwhile, unload the timer module, `module unload timer`\r\n5. After about 5 seconds, the Redis crashs.\r\n",
  "state": "closed",
  "created_at": "2022-01-26T08:17:04Z",
  "updated_at": "2022-02-01T12:54:12Z",
  "closed_at": "2022-02-01T12:54:12Z",
  "labels": [],
  "comments_data": []
}