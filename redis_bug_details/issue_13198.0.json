{
  "issue_number": 13198.0,
  "title": "[BUG]Redis Fail to Start",
  "body": "Report:\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n11617:S 08 Apr 2024 10:08:47.672 # Redis 7.0.4 crashed by signal: 11\r\n11617:S 08 Apr 2024 10:08:47.672 # Crashed running the instruction at: 0x14b53355e6d7\r\n11617:S 08 Apr 2024 10:08:47.672 # Accessing address: (nil)\r\n11617:S 08 Apr 2024 10:08:47.672 # Failed assertion: <no assertion failed> (<no file>:0)\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\n/lib64/libc.so.6(+0x15b6d7)[0x14b53355e6d7]\r\n\r\nBacktrace:\r\n./redis-server *:20260(logStackTrace+0x32)[0x46fa32]\r\n./redis-server *:20260(sigsegvHandler+0xa6)[0x470106]\r\n/lib64/libpthread.so.0(+0x13240)[0x14b5335ce240]\r\n/lib64/libc.so.6(+0x15b6d7)[0x14b53355e6d7]\r\n./redis-server *:20260(processMultibulkBuffer+0x41)[0x43a0b1]\r\n./redis-server *:20260(fakeProcessInputBuffer+0x48)[0x497a58]\r\n./redis-server *:20260(slaveLoadAppendOnlyFileProcess+0x103)[0x497e63]\r\n./redis-server *:20260(slaveLoadAofData+0x128)[0x4980d8]\r\n./redis-server *:20260(serverCron+0x61d)[0x42eb4d]\r\n./redis-server *:20260(aeProcessEvents+0x3e5)[0x425515]\r\n./redis-server *:20260(aeMain+0x2b)[0x42569b]\r\n./redis-server *:20260(main+0x5b9)[0x422489]\r\n/lib64/libc.so.6(__libc_start_main+0xe7)[0x14b533428b17]\r\n./redis-server *:20260[0x422643]\r\n\r\n------ INFO OUTPUT ------\r\n# Server^M\r\nredis_version:7.0.4^M\r\nredis_git_sha1:16b9c978^M\r\nredis_git_dirty:1^M\r\nredis_build_id:a8ed71090b9b47e2^M\r\nredis_mode:standalone^M\r\nos:Linux 4.19.90-2102.2.0.0062.ctl2.x86_64 x86_64^M\r\narch_bits:64^M\r\nmultiplexing_api:epoll^M\r\natomicvar_api:atomic-builtin^M\r\ngcc_version:5.5.0^M\r\nprocess_id:11617^M\r\nrun_id:5ca9d7007708d630097d046420fef8eba14471ac^M\r\ntcp_port:20260^M\r\nuptime_in_seconds:0^M\r\nuptime_in_days:0^M\r\nhz:10^M\r\nconfigured_hz:10^M\r\nlru_clock:1266095^M\r\nexecutable:/home/ctgcache/cache_apps/redisEntites/redis/src/./redis-server^M\r\nconfig_file:/home/ctgcache/cache_apps/redisEntites/20260/redis20260.conf^M\r\n^M\r\n# Clients^M\r\nconnected_clients:1^M\r\nclient_recent_max_input_buffer:2^M\r\nclient_recent_max_output_buffer:0^M\r\nblocked_clients:0^M\r\n^M\r\n# Memory^M\r\nused_memory:1097544^M\r\nused_memory_human:1.05M^M\r\nused_memory_rss:3780608^M\r\nused_memory_rss_human:3.61M^M\r\nused_memory_peak:1144888^M\r\nused_memory_peak_human:1.09M^M\r\nused_memory_peak_perc:95.86%^M\r\nused_memory_overhead:1096426^M\r\nused_memory_startup:1078984^M\r\nused_memory_dataset:1118^M\r\nused_memory_dataset_perc:6.02%^M\r\nallocator_allocated:1128624^M\r\nallocator_active:3742720^M\r\nallocator_resident:3742720^M\r\ntotal_system_memory:7823212544^M\r\ntotal_system_memory_human:7.29G^M\r\nused_memory_lua:37888^M\r\nused_memory_lua_human:37.00K^M\r\nused_memory_scripts:0^M\r\nused_memory_scripts_human:0B^M\r\nnumber_of_cached_scripts:0^M\r\nmaxmemory:2147483648^M\r\nmaxmemory_human:2.00G^M\r\nmaxmemory_policy:volatile-lru^M\r\nallocator_frag_ratio:3.32^M\r\nallocator_frag_bytes:2614096^M\r\nallocator_rss_ratio:1.00^M\r\nallocator_rss_bytes:0^M\r\nrss_overhead_ratio:1.01^M\r\nrss_overhead_bytes:37888^M\r\nmem_fragmentation_ratio:3.35^M\r\nmem_fragmentation_bytes:2651984^M\r\nmem_not_counted_for_evict:0^M\r\nmem_replication_backlog:0^M\r\nmem_clients_slaves:0^M\r\nmem_clients_normal:17210^M\r\nmem_aof_buffer:0^M\r\nmem_allocator:libc^M\r\nactive_defrag_running:0^M\r\nlazyfree_pending_objects:0^M\r\n^M\r\n# Persistence^M\r\nloading:0^M\r\nrdb_changes_since_last_save:68380^M\r\nrdb_bgsave_in_progress:0^M\r\nrdb_last_save_time:1712542127^M\r\nrdb_last_bgsave_status:ok^M\r\nrdb_last_bgsave_time_sec:-1^M\r\nrdb_current_bgsave_time_sec:-1^M\r\nrdb_last_cow_size:0^M\r\naof_enabled:1^M\r\naof_rewrite_in_progress:0^M\r\naof_rewrite_scheduled:0^M\r\naof_last_rewrite_time_sec:-1^M\r\naof_current_rewrite_time_sec:-1^M\r\naof_last_bgrewrite_status:ok^M\r\naof_last_write_status:ok^M\r\naof_last_cow_size:0^M\r\naof_current_size:7667790^M\r\naof_base_size:0^M\r\naof_pending_rewrite:0^M\r\naof_buffer_length:0^M\r\naof_rewrite_buffer_length:0^M\r\naof_pending_bio_fsync:0^M\r\naof_delayed_fsync:0^M\r\n^M\r\n# Stats^M\r\ntotal_connections_received:1^M\r\ntotal_commands_processed:2^M\r\ninstantaneous_ops_per_sec:0^M\r\ntotal_net_input_bytes:391^M\r\ntotal_net_output_bytes:88^M\r\ninstantaneous_input_kbps:0.22^M\r\ninstantaneous_output_kbps:0.03^M\r\nrejected_connections:0^M\r\nsync_full:0^M\r\nsync_partial_ok:0^M\r\nsync_partial_err:0^M\r\nexpired_keys:0^M\r\nexpired_stale_perc:0.00^M\r\nexpired_time_cap_reached_count:0^M\r\nevicted_keys:0^M\r\nkeyspace_hits:0^M\r\nkeyspace_misses:0^M\r\npubsub_channels:0^M\r\npubsub_patterns:0^M\r\nlatest_fork_usec:0^M\r\nmigrate_cached_sockets:0^M\r\nslave_expires_tracked_keys:0^M\r\nactive_defrag_hits:0^M\r\nactive_defrag_misses:0^M\r\nactive_defrag_key_hits:0^M\r\nactive_defrag_key_misses:0^M\r\nshowlog_length:0^M\r\nauth_fail_times:0^M\r\n^M\r\n# Replication^M\r\nrole:slave^M\r\nmaster_host:172.26.44.82^M\r\nmaster_port:20260^M\r\nmaster_link_status:up^M\r\nmaster_last_io_seconds_ago:0^M\r\nmaster_sync_in_progress:0^M\r\nslave_repl_offset:7667790^M\r\nslave_priority:100^M\r\nslave_read_only:1^M\r\nconnected_slaves:0^M\r\n^M\r\n# CPU^M\r\nused_cpu_sys:0.050026^M\r\nused_cpu_user:0.156725^M\r\nused_cpu_sys_children:0.000000^M\r\nused_cpu_user_children:0.000000^M\r\n^M\r\n# Commandstats^M\r\ncmdstat_auth:calls=1,usec=2,usec_per_call=2.00,max_usec=2^M\r\ncmdstat_aoffiletrans:calls=1,usec=7,usec_per_call=7.00,max_usec=7^M\r\n^M\r\n# Cluster^M\r\ncluster_enabled:0^M\r\n^M\r\n# Keyspace^M\r\ndb31:keys=3,expires=2,avg_ttl=0^M\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=4 addr=172.26.44.82:20260 fd=9 name= age=0 idle=0 flags=M db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=aoffiletrans\r\n\r\n------ REGISTERS ------\r\n11617:S 08 Apr 2024 10:08:47.673 #\r\nRAX:0000000000000000 RBX:0000000001f51b00\r\nRCX:000000000000000e RDX:00000000000000fa\r\nRDI:3ea6049e534b10a0 RSI:000000000000000d\r\nRBP:0000000000000000 RSP:00007fff81680778\r\nR8 :0000000001f565e5 R9 :0000000000000002\r\nR10:00000000000000bf R11:0000000000000000\r\nR12:0000000000003c00 R13:0000000001f565e5\r\nR14:3ea6049e5155aac9 R15:3ea6049e534b10ae\r\nRIP:000014b53355e6d7 EFL:0000000000010206\r\nCSGSFS:002b000000000033\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680787) -> 0000000000000000\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680786) -> 0000000000497e63\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680785) -> 000000000075004e\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680784) -> 000000000075004e\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680783) -> 00000000000000fa\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680782) -> 0000000000497a58\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680781) -> 0000000000000000\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680780) -> 0000000001f51b00\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077f) -> 000000000202eb40\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077e) -> 0000000000003c00\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077d) -> 000000000075004e\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077c) -> 000000000075004e\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077b) -> 0000000000000000\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff8168077a) -> 0000000000000000\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680779) -> 0000000000000000\r\n11617:S 08 Apr 2024 10:08:47.673 # (00007fff81680778) -> 000000000043a0b1\r\n\r\n------ FAST MEMORY TEST ------\r\n11617:S 08 Apr 2024 10:08:47.673 # Bio thread for job type #0 terminated\r\n11617:S 08 Apr 2024 10:08:47.674 # Bio thread for job type #1 terminated\r\n11617:S 08 Apr 2024 10:08:47.674 # Bio thread for job type #2 terminated\r\n11617:S 08 Apr 2024 10:08:47.674 # Bio thread for job type #3 terminated\r\n*** Preparing to test memory region 728000 (94208 bytes)\r\n*** Preparing to test memory region 1f4e000 (135168 bytes)\r\n*** Preparing to test memory region 1f6f000 (917504 bytes)\r\n*** Preparing to test memory region 14b520000000 (135168 bytes)\r\n*** Preparing to test memory region 14b52567d000 (4194304 bytes)\r\n*** Preparing to test memory region 14b525a7e000 (4194304 bytes)\r\n*** Preparing to test memory region 14b525e7f000 (4194304 bytes)\r\n*** Preparing to test memory region 14b526280000 (4521984 bytes)\r\n*** Preparing to test memory region 14b533401000 (8192 bytes)\r\n*** Preparing to test memory region 14b5335b7000 (16384 bytes)\r\n*** Preparing to test memory region 14b5335d8000 (16384 bytes)\r\n*** Preparing to test memory region 14b53376f000 (8192 bytes)\r\n*** Preparing to test memory region 14b5337a5000 (4096 bytes)\r\n.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n------ DUMPING CODE AROUND EIP ------\r\nSymbol: (null) (base: (nil))\r\nModule: /lib64/libc.so.6 (base 0x14b533403000)\r\n$ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\n$ objdump --adjust-vma=(nil) -D -b binary -m i386:x86-64 /tmp/dump.bin\r\n------\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n\r\n       Please report the crash by opening an issue on github:\r\n\r\n           http://github.com/antirez/redis/issues\r\n\r\n  Suspect RAM error? Use redis-server --test-memory to verify it.",
  "state": "closed",
  "created_at": "2024-04-08T02:22:51Z",
  "updated_at": "2024-04-08T06:57:44Z",
  "closed_at": "2024-04-08T06:57:44Z",
  "labels": [],
  "comments_data": [
    {
      "id": 2041767522,
      "user": "sundb",
      "created_at": "2024-04-08T02:47:30Z",
      "body": "I saw `fakeProcessInputBuffer` in the crash log which doesn't exist in redis.\r\nwhere did you get this from? "
    },
    {
      "id": 2041803555,
      "user": "WhiteChan18",
      "created_at": "2024-04-08T03:37:55Z",
      "body": "> I saw `fakeProcessInputBuffer` in the crash log which doesn't exist in redis. where did you get this from?\r\n\r\nIn addition to this parameter, there is no other way to determine the cause of the problem"
    },
    {
      "id": 2041813980,
      "user": "sundb",
      "created_at": "2024-04-08T03:53:30Z",
      "body": "@WhiteChan18 sorry, we can't determine the cause with the special implemention of code."
    },
    {
      "id": 2041995624,
      "user": "WhiteChan18",
      "created_at": "2024-04-08T06:57:32Z",
      "body": "> @WhiteChan18 sorry, we can't determine the cause with the special implemention of code.\r\n\r\nThank you！"
    }
  ]
}