{
  "issue_number": 11697.0,
  "title": "[CRASH] Software Failure",
  "body": "**Crash report**\r\n```\r\n1:M 06 Jan 2023 10:32:20.427 # ------------------------------------------------\r\n1:M 06 Jan 2023 10:32:20.427 # !!! Software Failure. Press left mouse button to continue\r\n1:M 06 Jan 2023 10:32:20.427 # Guru Meditation: Duplicated key found in RDB file #rdb.c:2677\r\n\r\n------ STACK TRACE ------\r\n\r\nBacktrace:\r\nredis-server 0.0.0.0:6379 [cluster](rdbLoadRio+0xd98)[0x558e17ce1a98]\r\nredis-server 0.0.0.0:6379 [cluster](rdbLoad+0x51)[0x558e17ce1b71]\r\nredis-server 0.0.0.0:6379 [cluster](loadDataFromDisk+0x8d)[0x558e17cb5b5d]\r\nredis-server 0.0.0.0:6379 [cluster](main+0x2af)[0x558e17ca569f]\r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xeb)[0x7fef373ec09b]\r\nredis-server 0.0.0.0:6379 [cluster](_start+0x2a)[0x558e17ca5bea]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:6.2.6\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:86878b7aea272845\r\nredis_mode:cluster\r\nos:Linux 5.4.202+ x86_64\r\narch_bits:64\r\nmultiplexing_api:epoll\r\natomicvar_api:c11-builtin\r\ngcc_version:8.3.0\r\nprocess_id:1\r\nprocess_supervised:no\r\nrun_id:b52460475eccfb62293857afa3f5edf4653f4565\r\ntcp_port:6379\r\nserver_time_usec:1673001140407692\r\nuptime_in_seconds:1\r\nuptime_in_days:0\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:12056755\r\nexecutable:/redis-server\r\nconfig_file:\r\nio_threads_active:0\r\n\r\n# Clients\r\nconnected_clients:0\r\ncluster_connections:26\r\nmaxclients:10000\r\nclient_recent_max_input_buffer:0\r\nclient_recent_max_output_buffer:0\r\nblocked_clients:0\r\ntracking_clients:0\r\nclients_in_timeout_table:0\r\n\r\n# Memory\r\nused_memory:257784624\r\nused_memory_human:245.84M\r\nused_memory_rss:262246400\r\nused_memory_rss_human:250.10M\r\nused_memory_peak:257784624\r\nused_memory_peak_human:245.84M\r\nused_memory_peak_perc:101.40%\r\nused_memory_overhead:36284160\r\nused_memory_startup:1503400\r\nused_memory_dataset:221500464\r\nused_memory_dataset_perc:86.43%\r\nallocator_allocated:249115440\r\nallocator_active:253911040\r\nallocator_resident:259776512\r\ntotal_system_memory:67445944320\r\ntotal_system_memory_human:62.81G\r\nused_memory_lua:37888\r\nused_memory_lua_human:37.00K\r\nused_memory_scripts:0\r\nused_memory_scripts_human:0B\r\nnumber_of_cached_scripts:0\r\nmaxmemory:0\r\nmaxmemory_human:0B\r\nmaxmemory_policy:noeviction\r\nallocator_frag_ratio:1.02\r\nallocator_frag_bytes:4795600\r\nallocator_rss_ratio:1.02\r\nallocator_rss_bytes:5865472\r\nrss_overhead_ratio:1.01\r\nrss_overhead_bytes:2469888\r\nmem_fragmentation_ratio:1.05\r\nmem_fragmentation_bytes:13238336\r\nmem_not_counted_for_evict:0\r\nmem_replication_backlog:0\r\nmem_clients_slaves:0\r\nmem_clients_normal:0\r\nmem_aof_buffer:0\r\nmem_allocator:jemalloc-5.1.0\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\nlazyfreed_objects:0\r\n\r\n# Persistence\r\nloading:1\r\ncurrent_cow_size:0\r\ncurrent_cow_size_age:0\r\ncurrent_fork_perc:0.00\r\ncurrent_save_keys_processed:0\r\ncurrent_save_keys_total:0\r\nrdb_changes_since_last_save:0\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1673001139\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:-1\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_last_cow_size:0\r\naof_enabled:0\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:-1\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:0\r\nmodule_fork_in_progress:0\r\nmodule_fork_last_cow_size:0\r\nloading_start_time:1673001139\r\nloading_total_bytes:209292993\r\nloading_rdb_used_mem:552850552\r\nloading_loaded_bytes:96468562\r\nloading_loaded_perc:46.09\r\nloading_eta_seconds:1\r\n\r\n# Stats\r\ntotal_connections_received:0\r\ntotal_commands_processed:0\r\ninstantaneous_ops_per_sec:0\r\ntotal_net_input_bytes:0\r\ntotal_net_output_bytes:0\r\ninstantaneous_input_kbps:0.00\r\ninstantaneous_output_kbps:0.00\r\nrejected_connections:0\r\nsync_full:0\r\nsync_partial_ok:0\r\nsync_partial_err:0\r\nexpired_keys:0\r\nexpired_stale_perc:0.00\r\nexpired_time_cap_reached_count:0\r\nexpire_cycle_cpu_milliseconds:0\r\nevicted_keys:0\r\nkeyspace_hits:0\r\nkeyspace_misses:0\r\npubsub_channels:0\r\npubsub_patterns:0\r\nlatest_fork_usec:0\r\ntotal_forks:0\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\ntracking_total_keys:0\r\ntracking_total_items:0\r\ntracking_total_prefixes:0\r\nunexpected_error_replies:0\r\ntotal_error_replies:0\r\ndump_payload_sanitizations:0\r\ntotal_reads_processed:0\r\ntotal_writes_processed:0\r\nio_threaded_reads_processed:0\r\nio_threaded_writes_processed:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:0\r\nmaster_failover_state:no-failover\r\nmaster_replid:73a2cfbfc9d2141f2b17de47d65c44b8bdb00175\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:0\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:0\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0\r\nrepl_backlog_histlen:0\r\n\r\n# CPU\r\nused_cpu_sys:0.164452\r\nused_cpu_user:1.158802\r\nused_cpu_sys_children:0.190868\r\nused_cpu_user_children:0.101376\r\nused_cpu_sys_main_thread:0.160073\r\nused_cpu_user_main_thread:1.153151\r\n\r\n# Modules\r\n\r\n# Commandstats\r\n\r\n# Errorstats\r\n\r\n# Cluster\r\ncluster_enabled:1\r\n\r\n# Keyspace\r\ndb0:keys=283459,expires=277716,avg_ttl=0\r\n\r\n------ CLIENT LIST OUTPUT ------\r\n\r\n------ MODULES INFO OUTPUT ------\r\n\r\n------ FAST MEMORY TEST ------\r\n1:M 06 Jan 2023 10:32:20.428 # Bio thread for job type #0 terminated\r\n1:M 06 Jan 2023 10:32:20.428 # Bio thread for job type #1 terminated\r\n1:M 06 Jan 2023 10:32:20.428 # Bio thread for job type #2 terminated\r\n*** Preparing to test memory region 558e17e67000 (2277376 bytes)\r\n*** Preparing to test memory region 558e18fd4000 (270336 bytes)\r\n*** Preparing to test memory region 7fef2507c000 (255852544 bytes)\r\n*** Preparing to test memory region 7fef3447d000 (8388608 bytes)\r\n*** Preparing to test memory region 7fef34c7e000 (8388608 bytes)\r\n*** Preparing to test memory region 7fef3547f000 (8388608 bytes)\r\n*** Preparing to test memory region 7fef35c80000 (8388608 bytes)\r\n*** Preparing to test memory region 7fef36480000 (14155776 bytes)\r\n*** Preparing to test memory region 7fef373c4000 (16384 bytes)\r\n*** Preparing to test memory region 7fef37585000 (24576 bytes)\r\n*** Preparing to test memory region 7fef375a8000 (16384 bytes)\r\n*** Preparing to test memory region 7fef37891000 (16384 bytes)\r\n*** Preparing to test memory region 7fef37ab9000 (8192 bytes)\r\n*** Preparing to test memory region 7fef37ae7000 (4096 bytes)\r\n.O.O.O.O.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n```\r\n",
  "state": "open",
  "created_at": "2023-01-06T10:38:47Z",
  "updated_at": "2023-01-12T16:07:39Z",
  "closed_at": null,
  "labels": [],
  "comments_data": [
    {
      "id": 1378168758,
      "user": "bugwz",
      "created_at": "2023-01-11T02:37:32Z",
      "body": "@alex-telpis \r\n> 1:M 06 Jan 2023 10:32:20.427 # Guru Meditation: Duplicated key found in RDB file #rdb.c:2677\r\n\r\nIt seems that there is a problem with the data in the rdb. It is recommended that you add some debug logs for troubleshooting."
    },
    {
      "id": 1380630078,
      "user": "oranagra",
      "created_at": "2023-01-12T16:07:39Z",
      "body": "@alex-telpis this RDB file seems corrupted (or maybe the memory of the redis that saved it was messed up, possibly due to a bug), do you have any idea how to reproduce that?\r\nmaybe you can check the key name and type of the duplicate key somehow (maybe using redis-rdb-tools or alike) "
    }
  ]
}