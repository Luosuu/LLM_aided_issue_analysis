{
  "issue_number": 3001.0,
  "title": "redis-trib rebalance with weight 0 skips 1 slot",
  "body": "Hi,\n\nWhen using the following command:\n`./redis-trib.rb rebalance --weight 4f54f27d5303563c0fba9952dc1b677f0a3c0cd5=0 127.0.0.1:6379`\n\nAll slots are moved from `4f54f27d5303563c0fba9952dc1b677f0a3c0cd5` to the other nodes except one.\n\nIt skipped 1 of the slots because it divided 4096 by 3 which left one out.\n\nBefore:\n\n```\n127.0.0.1:6379> cluster nodes\n4f54f27d5303563c0fba9952dc1b677f0a3c0cd5 10.240.0.44:6379 master - 0 1452614770198 4 connected 0-1364 5461-6826 10923-12287\nba977fb335ff8dd0766bb38b4d4110111c6c2293 10.240.0.43:6379 master - 0 1452614772204 3 connected 12288-16383\nd1ed2aff2b5d753aa3f6092a7f70c281531113d9 10.240.0.33:6379 master - 0 1452614773207 2 connected 6827-10922\n84ae67264d96a90c74531bad688f6b9df1af3357 10.240.0.40:6379 myself,master - 0 0 1 connected 1365-5460\n```\n\nafter:\n\n```\n127.0.0.1:6379> cluster nodes\n4f54f27d5303563c0fba9952dc1b677f0a3c0cd5 10.240.0.44:6379 master - 0 1452615139058 4 connected 12287\nba977fb335ff8dd0766bb38b4d4110111c6c2293 10.240.0.43:6379 master - 0 1452615140059 7 connected 6826 10923-12286 12288-16383\nd1ed2aff2b5d753aa3f6092a7f70c281531113d9 10.240.0.33:6379 master - 0 1452615141062 6 connected 5461-6825 6827-10922\n84ae67264d96a90c74531bad688f6b9df1af3357 10.240.0.40:6379 myself,master - 0 0 5 connected 0-5460\n```\n\nduring:\n\n```\n/redis-trib.rb rebalance --weight 4f54f27d5303563c0fba9952dc1b677f0a3c0cd5=0 10.240.0.44:6379\n>>> Performing Cluster Check (using node 10.240.0.44:6379)\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n>>> Rebalancing across 4 nodes. Total weight = 3.0\nMoving 1365 slots from 10.240.0.44:6379 to 10.240.0.40:6379\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n#######################################################################################################################################\nMoving 1365 slots from 10.240.0.44:6379 to 10.240.0.33:6379\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n#######################################################################################################################################\nMoving 1365 slots from 10.240.0.44:6379 to 10.240.0.43:6379\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n######################################################################################################################################################################################################################################################\n#######################################################################################################################################\n```\n",
  "state": "closed",
  "created_at": "2016-01-12T16:24:12Z",
  "updated_at": "2016-01-13T16:32:23Z",
  "closed_at": "2016-01-13T16:32:21Z",
  "labels": [
    "non critical bug",
    "cluster"
  ],
  "comments_data": [
    {
      "id": 170980589,
      "user": "antirez",
      "created_at": "2016-01-12T17:19:23Z",
      "body": "Thanks for noticing, fixing before next 3.2 RC2 and next 3.0 patchlevel, in the next days.\n"
    },
    {
      "id": 171353123,
      "user": "antirez",
      "created_at": "2016-01-13T16:32:23Z",
      "body": "Just fixed, perhaps not the best of the fixes but works as expected apparently. I tried with a few similar setups. Would appreciate your take on this. Thanks.\n"
    }
  ]
}