{
  "issue_number": 12524.0,
  "title": "[CRASH] Trying to filter a KNN search query",
  "body": "Notice!\r\n- If a Redis module was involved, please open an issue in the module's repo instead!\r\n- If you're using docker on Apple M1, please make sure the image you're using was compiled for ARM!\r\n\r\n\r\n**Crash report**\r\n\r\nPaste the complete crash log between the quotes below. Please include a few lines from the log preceding the crash report to provide some context.\r\n\r\n```\r\n2023-08-29 11:15:39 === REDIS BUG REPORT START: Cut & paste starting from here ===\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # Redis 6.2.6 crashed by signal: 11, si_code: 1\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # Accessing address: (nil)\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ STACK TRACE ------\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 Backtrace:\r\n2023-08-29 11:15:39 /lib/x86_64-linux-gnu/libpthread.so.0(+0x14140)[0x7f347c06a140]\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ REGISTERS ------\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # \r\n2023-08-29 11:15:39 RAX:00007f3472e1c5c0 RBX:00007f3472da8300\r\n2023-08-29 11:15:39 RCX:0000000000000008 RDX:00007ffca98763d8\r\n2023-08-29 11:15:39 RDI:00007f3472e1c5c0 RSI:0000000000002357\r\n2023-08-29 11:15:39 RBP:0000000000000000 RSP:00007ffca98763c8\r\n2023-08-29 11:15:39 R8 :00007f347ba04478 R9 :00007f347ba021e8\r\n2023-08-29 11:15:39 R10:00007f3473cd2fc1 R11:0000000000000006\r\n2023-08-29 11:15:39 R12:0000000000000000 R13:00007ffca9876438\r\n2023-08-29 11:15:39 R14:00007f3472682320 R15:0000000000000000\r\n2023-08-29 11:15:39 RIP:0000000000000000 EFL:0000000000010297\r\n2023-08-29 11:15:39 CSGSFS:002b000000000033\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d7) -> 00007f347028cfe8\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d6) -> 00007f346fe02010\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d5) -> 0000000000000014\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d4) -> 00007f347028cfe8\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d3) -> 00007f3472e1c5c0\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d2) -> 00007f347b30d95a\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d1) -> 00007ffca9876760\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763d0) -> 00007f347b50923c\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763cf) -> 00007ffca9876438\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763ce) -> 00007f347028cd40\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763cd) -> 00007f347028cca0\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763cc) -> 00007f3472da8300\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763cb) -> 0000000000000c00\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763ca) -> 00007f3472682320\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763c9) -> 00007f346fe022a0\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.157 # (00007ffca98763c8) -> 00007f347b2eba91\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ INFO OUTPUT ------\r\n2023-08-29 11:15:39 # Server\r\n2023-08-29 11:15:39 redis_version:6.2.6\r\n2023-08-29 11:15:39 redis_git_sha1:00000000\r\n2023-08-29 11:15:39 redis_git_dirty:0\r\n2023-08-29 11:15:39 redis_build_id:b402f2b932f9439b\r\n2023-08-29 11:15:39 redis_mode:standalone\r\n2023-08-29 11:15:39 os:Linux 5.10.102.1-microsoft-standard-WSL2 x86_64\r\n2023-08-29 11:15:39 arch_bits:64\r\n2023-08-29 11:15:39 multiplexing_api:epoll\r\n2023-08-29 11:15:39 atomicvar_api:atomic-builtin\r\n2023-08-29 11:15:39 gcc_version:10.2.1\r\n2023-08-29 11:15:39 process_id:1\r\n2023-08-29 11:15:39 process_supervised:no\r\n2023-08-29 11:15:39 run_id:d51d4fd886b15b7f1dd8dcbcc3e41da320dc24ba\r\n2023-08-29 11:15:39 tcp_port:6379\r\n2023-08-29 11:15:39 server_time_usec:1693322139155159\r\n2023-08-29 11:15:39 uptime_in_seconds:1811\r\n2023-08-29 11:15:39 uptime_in_days:0\r\n2023-08-29 11:15:39 hz:10\r\n2023-08-29 11:15:39 configured_hz:10\r\n2023-08-29 11:15:39 lru_clock:15600539\r\n2023-08-29 11:15:39 executable:/data/redis-server\r\n2023-08-29 11:15:39 config_file:\r\n2023-08-29 11:15:39 io_threads_active:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Clients\r\n2023-08-29 11:15:39 connected_clients:1\r\n2023-08-29 11:15:39 cluster_connections:0\r\n2023-08-29 11:15:39 maxclients:10000\r\n2023-08-29 11:15:39 client_recent_max_input_buffer:16\r\n2023-08-29 11:15:39 client_recent_max_output_buffer:0\r\n2023-08-29 11:15:39 blocked_clients:0\r\n2023-08-29 11:15:39 tracking_clients:0\r\n2023-08-29 11:15:39 clients_in_timeout_table:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Memory\r\n2023-08-29 11:15:39 used_memory:109988976\r\n2023-08-29 11:15:39 used_memory_human:104.89M\r\n2023-08-29 11:15:39 used_memory_rss:119209984\r\n2023-08-29 11:15:39 used_memory_rss_human:113.69M\r\n2023-08-29 11:15:39 used_memory_peak:110011864\r\n2023-08-29 11:15:39 used_memory_peak_human:104.92M\r\n2023-08-29 11:15:39 used_memory_peak_perc:99.98%\r\n2023-08-29 11:15:39 used_memory_overhead:1455368\r\n2023-08-29 11:15:39 used_memory_startup:904728\r\n2023-08-29 11:15:39 used_memory_dataset:108533608\r\n2023-08-29 11:15:39 used_memory_dataset_perc:99.50%\r\n2023-08-29 11:15:39 allocator_allocated:110278288\r\n2023-08-29 11:15:39 allocator_active:110673920\r\n2023-08-29 11:15:39 allocator_resident:114573312\r\n2023-08-29 11:15:39 total_system_memory:26638192640\r\n2023-08-29 11:15:39 total_system_memory_human:24.81G\r\n2023-08-29 11:15:39 used_memory_lua:37888\r\n2023-08-29 11:15:39 used_memory_lua_human:37.00K\r\n2023-08-29 11:15:39 used_memory_scripts:0\r\n2023-08-29 11:15:39 used_memory_scripts_human:0B\r\n2023-08-29 11:15:39 number_of_cached_scripts:0\r\n2023-08-29 11:15:39 maxmemory:0\r\n2023-08-29 11:15:39 maxmemory_human:0B\r\n2023-08-29 11:15:39 maxmemory_policy:noeviction\r\n2023-08-29 11:15:39 allocator_frag_ratio:1.00\r\n2023-08-29 11:15:39 allocator_frag_bytes:395632\r\n2023-08-29 11:15:39 allocator_rss_ratio:1.04\r\n2023-08-29 11:15:39 allocator_rss_bytes:3899392\r\n2023-08-29 11:15:39 rss_overhead_ratio:1.04\r\n2023-08-29 11:15:39 rss_overhead_bytes:4636672\r\n2023-08-29 11:15:39 mem_fragmentation_ratio:1.08\r\n2023-08-29 11:15:39 mem_fragmentation_bytes:9280456\r\n2023-08-29 11:15:39 mem_not_counted_for_evict:0\r\n2023-08-29 11:15:39 mem_replication_backlog:0\r\n2023-08-29 11:15:39 mem_clients_slaves:0\r\n2023-08-29 11:15:39 mem_clients_normal:20496\r\n2023-08-29 11:15:39 mem_aof_buffer:0\r\n2023-08-29 11:15:39 mem_allocator:jemalloc-5.1.0\r\n2023-08-29 11:15:39 active_defrag_running:0\r\n2023-08-29 11:15:39 lazyfree_pending_objects:0\r\n2023-08-29 11:15:39 lazyfreed_objects:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Persistence\r\n2023-08-29 11:15:39 loading:0\r\n2023-08-29 11:15:39 current_cow_size:0\r\n2023-08-29 11:15:39 current_cow_size_age:0\r\n2023-08-29 11:15:39 current_fork_perc:0.00\r\n2023-08-29 11:15:39 current_save_keys_processed:0\r\n2023-08-29 11:15:39 current_save_keys_total:0\r\n2023-08-29 11:15:39 rdb_changes_since_last_save:0\r\n2023-08-29 11:15:39 rdb_bgsave_in_progress:0\r\n2023-08-29 11:15:39 rdb_last_save_time:1693320328\r\n2023-08-29 11:15:39 rdb_last_bgsave_status:ok\r\n2023-08-29 11:15:39 rdb_last_bgsave_time_sec:-1\r\n2023-08-29 11:15:39 rdb_current_bgsave_time_sec:-1\r\n2023-08-29 11:15:39 rdb_last_cow_size:0\r\n2023-08-29 11:15:39 aof_enabled:0\r\n2023-08-29 11:15:39 aof_rewrite_in_progress:0\r\n2023-08-29 11:15:39 aof_rewrite_scheduled:0\r\n2023-08-29 11:15:39 aof_last_rewrite_time_sec:-1\r\n2023-08-29 11:15:39 aof_current_rewrite_time_sec:-1\r\n2023-08-29 11:15:39 aof_last_bgrewrite_status:ok\r\n2023-08-29 11:15:39 aof_last_write_status:ok\r\n2023-08-29 11:15:39 aof_last_cow_size:0\r\n2023-08-29 11:15:39 module_fork_in_progress:0\r\n2023-08-29 11:15:39 module_fork_last_cow_size:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Stats\r\n2023-08-29 11:15:39 total_connections_received:9\r\n2023-08-29 11:15:39 total_commands_processed:36\r\n2023-08-29 11:15:39 instantaneous_ops_per_sec:1\r\n2023-08-29 11:15:39 total_net_input_bytes:11979\r\n2023-08-29 11:15:39 total_net_output_bytes:171453\r\n2023-08-29 11:15:39 instantaneous_input_kbps:0.07\r\n2023-08-29 11:15:39 instantaneous_output_kbps:0.11\r\n2023-08-29 11:15:39 rejected_connections:0\r\n2023-08-29 11:15:39 sync_full:0\r\n2023-08-29 11:15:39 sync_partial_ok:0\r\n2023-08-29 11:15:39 sync_partial_err:0\r\n2023-08-29 11:15:39 expired_keys:0\r\n2023-08-29 11:15:39 expired_stale_perc:0.00\r\n2023-08-29 11:15:39 expired_time_cap_reached_count:0\r\n2023-08-29 11:15:39 expire_cycle_cpu_milliseconds:34\r\n2023-08-29 11:15:39 evicted_keys:0\r\n2023-08-29 11:15:39 keyspace_hits:20032\r\n2023-08-29 11:15:39 keyspace_misses:0\r\n2023-08-29 11:15:39 pubsub_channels:0\r\n2023-08-29 11:15:39 pubsub_patterns:0\r\n2023-08-29 11:15:39 latest_fork_usec:0\r\n2023-08-29 11:15:39 total_forks:0\r\n2023-08-29 11:15:39 migrate_cached_sockets:0\r\n2023-08-29 11:15:39 slave_expires_tracked_keys:0\r\n2023-08-29 11:15:39 active_defrag_hits:0\r\n2023-08-29 11:15:39 active_defrag_misses:0\r\n2023-08-29 11:15:39 active_defrag_key_hits:0\r\n2023-08-29 11:15:39 active_defrag_key_misses:0\r\n2023-08-29 11:15:39 tracking_total_keys:0\r\n2023-08-29 11:15:39 tracking_total_items:0\r\n2023-08-29 11:15:39 tracking_total_prefixes:0\r\n2023-08-29 11:15:39 unexpected_error_replies:0\r\n2023-08-29 11:15:39 total_error_replies:18\r\n2023-08-29 11:15:39 dump_payload_sanitizations:0\r\n2023-08-29 11:15:39 total_reads_processed:44\r\n2023-08-29 11:15:39 total_writes_processed:35\r\n2023-08-29 11:15:39 io_threaded_reads_processed:0\r\n2023-08-29 11:15:39 io_threaded_writes_processed:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Replication\r\n2023-08-29 11:15:39 role:master\r\n2023-08-29 11:15:39 connected_slaves:0\r\n2023-08-29 11:15:39 master_failover_state:no-failover\r\n2023-08-29 11:15:39 master_replid:b3bdf3d07bea57b95ce0e8a211570a8ff72e462d\r\n2023-08-29 11:15:39 master_replid2:0000000000000000000000000000000000000000\r\n2023-08-29 11:15:39 master_repl_offset:0\r\n2023-08-29 11:15:39 second_repl_offset:-1\r\n2023-08-29 11:15:39 repl_backlog_active:0\r\n2023-08-29 11:15:39 repl_backlog_size:1048576\r\n2023-08-29 11:15:39 repl_backlog_first_byte_offset:0\r\n2023-08-29 11:15:39 repl_backlog_histlen:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # CPU\r\n2023-08-29 11:15:39 used_cpu_sys:0.429450\r\n2023-08-29 11:15:39 used_cpu_user:3.943134\r\n2023-08-29 11:15:39 used_cpu_sys_children:0.000000\r\n2023-08-29 11:15:39 used_cpu_user_children:0.009021\r\n2023-08-29 11:15:39 used_cpu_sys_main_thread:0.427535\r\n2023-08-29 11:15:39 used_cpu_user_main_thread:3.925556\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Modules\r\n2023-08-29 11:15:39 module:name=search,ver=20403,api=1,filters=0,usedby=[],using=[ReJSON],options=[handle-io-errors]\r\n2023-08-29 11:15:39 module:name=ReJSON,ver=999999,api=1,filters=0,usedby=[search],using=[],options=[handle-io-errors]\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Commandstats\r\n2023-08-29 11:15:39 cmdstat_client:calls=18,usec=104,usec_per_call=5.78,rejected_calls=0,failed_calls=18\r\n2023-08-29 11:15:39 cmdstat_ping:calls=9,usec=3,usec_per_call=0.33,rejected_calls=0,failed_calls=0\r\n2023-08-29 11:15:39 cmdstat_FT.SEARCH:calls=8,usec=7045,usec_per_call=880.62,rejected_calls=0,failed_calls=0\r\n2023-08-29 11:15:39 cmdstat_info:calls=1,usec=32,usec_per_call=32.00,rejected_calls=0,failed_calls=0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Errorstats\r\n2023-08-29 11:15:39 errorstat_ERR:count=18\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Cluster\r\n2023-08-29 11:15:39 cluster_enabled:0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 # Keyspace\r\n2023-08-29 11:15:39 db0:keys=9976,expires=0,avg_ttl=0\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ CLIENT LIST OUTPUT ------\r\n2023-08-29 11:15:39 id=17 addr=172.19.0.1:38976 laddr=172.19.0.2:6379 fd=8 name= age=1 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=3381 qbuf-free=37573 argv-mem=3238 obl=0 oll=0 omem=0 tot-mem=64870 events=r cmd=FT.SEARCH user=default redir=-1\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ CURRENT CLIENT INFO ------\r\n2023-08-29 11:15:39 id=17 addr=172.19.0.1:38976 laddr=172.19.0.2:6379 fd=8 name= age=1 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=3381 qbuf-free=37573 argv-mem=3238 obl=0 oll=0 omem=0 tot-mem=64870 events=r cmd=FT.SEARCH user=default redir=-1\r\n2023-08-29 11:15:39 argv[0]: 'FT.SEARCH'\r\n2023-08-29 11:15:39 argv[1]: 'idx'\r\n2023-08-29 11:15:39 argv[2]: '*=>[KNN 10 @item_keyword_vector $vec_param AS vector_score]'\r\n2023-08-29 11:15:39 argv[3]: 'FILTER'\r\n2023-08-29 11:15:39 argv[4]: 'isactive'\r\n2023-08-29 11:15:39 argv[5]: '0'\r\n2023-08-29 11:15:39 argv[6]: '0'\r\n2023-08-29 11:15:39 argv[7]: 'RETURN'\r\n2023-08-29 11:15:39 argv[8]: '4'\r\n2023-08-29 11:15:39 argv[9]: 'vector_score'\r\n2023-08-29 11:15:39 argv[10]: 'productid'\r\n2023-08-29 11:15:39 argv[11]: 'productname'\r\n2023-08-29 11:15:39 argv[12]: 'isactive'\r\n2023-08-29 11:15:39 argv[13]: 'DIALECT'\r\n2023-08-29 11:15:39 argv[14]: '2'\r\n2023-08-29 11:15:39 argv[15]: 'LIMIT'\r\n2023-08-29 11:15:39 argv[16]: '0'\r\n2023-08-29 11:15:39 argv[17]: '10'\r\n2023-08-29 11:15:39 argv[18]: 'params'\r\n2023-08-29 11:15:39 argv[19]: '2'\r\n2023-08-29 11:15:39 argv[20]: 'vec_param'\r\n2023-08-29 11:15:39 argv[21]: '���>m�>�'\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ MODULES INFO OUTPUT ------\r\n2023-08-29 11:15:39 # ReJSON_trace\r\n2023-08-29 11:15:39 ReJSON_trace:   0: redis_module::base_info_func\r\n2023-08-29 11:15:39              at /root/.cargo/registry/src/github.com-1ecc6299db9ec823/redis-module-1.0.0/src/lib.rs:78:33\r\n2023-08-29 11:15:39    1: rejson::__info_func\r\n2023-08-29 11:15:39              at /root/.cargo/registry/src/github.com-1ecc6299db9ec823/redis-module-1.0.0/src/macros.rs:120:13\r\n2023-08-29 11:15:39    2: modulesCollectInfo\r\n2023-08-29 11:15:39              at /usr/src/redis/src/module.c:7078:9\r\n2023-08-29 11:15:39    3: logModulesInfo\r\n2023-08-29 11:15:39              at /usr/src/redis/src/debug.c:1598:22\r\n2023-08-29 11:15:39    4: printCrashReport\r\n2023-08-29 11:15:39              at /usr/src/redis/src/debug.c:1849:5\r\n2023-08-29 11:15:39       sigsegvHandler\r\n2023-08-29 11:15:39              at /usr/src/redis/src/debug.c:1831:5\r\n2023-08-29 11:15:39    5: <unknown>\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 ------ FAST MEMORY TEST ------\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.252 # Bio thread for job type #0 terminated\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.252 # Bio thread for job type #1 terminated\r\n2023-08-29 11:15:39 1:M 29 Aug 2023 15:15:39.252 # Bio thread for job type #2 terminated\r\n2023-08-29 11:15:39 *** Preparing to test memory region 55aee0e3d000 (2277376 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 55aee1cc0000 (409600 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f3468000000 (135168 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f346f600000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f346fe00000 (4194304 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347022c000 (132120576 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347802d000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347882e000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347902f000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f3479830000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347a1c3000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347a9c4000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347b5f9000 (28672 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347b600000 (8388608 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347be8b000 (24576 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347c052000 (16384 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347c074000 (16384 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347c368000 (16384 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347c549000 (8192 bytes)\r\n2023-08-29 11:15:39 *** Preparing to test memory region 7f347c579000 (4096 bytes)\r\n2023-08-29 11:15:39 .O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O\r\n2023-08-29 11:15:39 Fast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39 === REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39        Please report the crash by opening an issue on github:\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39            http://github.com/redis/redis/issues\r\n2023-08-29 11:15:39 \r\n2023-08-29 11:15:39   Suspect RAM error? Use redis-server --test-memory to verify it.\r\n```\r\n\r\n**Additional information**\r\n\r\n1. Windows 10\r\n2. Using: Docker Desktop 4.22.0 (117440)\r\n3. Problem: Trying to add a filter to a KNN search.\r\n```\r\n    ITEM_KEYWORD_EMBEDDING_FIELD = 'item_keyword_vector'\r\n    q=Query(f'*=>[KNN {topK} @{ITEM_KEYWORD_EMBEDDING_FIELD} $vec_param AS vector_score]') \\\r\n        .add_filter(NumericFilter(\"isactive\", 0, 0)) \\\r\n        .paging(0,topK) \\\r\n        .return_fields('vector_score', 'productid', 'productname', 'isactive') \\\r\n        .dialect(2)\r\n```\r\n4. The search worked only once and for all other attempts, the server crashed and needed to be restarted.\r\n5. Without the `add_filter()`, work fine.\r\n6. `isactive`: Was a boolean but converted to a numeric in the database.\r\n7. Instead of `*` and `add_filter()`, tried:\r\n```\r\n(@isactive:0)=>[KNN...    No crash / no result\r\n(@isactive:{{0}})=>[KNN...    No crash / no result\r\n``` ",
  "state": "closed",
  "created_at": "2023-08-29T15:48:32Z",
  "updated_at": "2023-09-01T17:29:49Z",
  "closed_at": "2023-09-01T17:29:49Z",
  "labels": [
    "state:to-be-closed"
  ],
  "comments_data": [
    {
      "id": 1697732976,
      "user": "madolson",
      "created_at": "2023-08-29T15:58:30Z",
      "body": "You probably want to open the issue here: https://github.com/RediSearch/RediSearch"
    }
  ]
}