{
  "issue_number": 9873.0,
  "title": "[CRASH] Redis 4.0.10 crashed by signal 11",
  "body": "**Crash report**\r\n\r\n```\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n6257:M 22 Nov 18:48:15.128 # Redis 4.0.10 crashed by signal: 11\r\n6257:M 22 Nov 18:48:15.128 # Accessing address: 0xffffffffffffffff\r\n6257:M 22 Nov 18:48:15.129 # Failed assertion: <no assertion failed> (<no file>:0)\r\n\r\n------ STACK TRACE ------\r\n/opt/redis-4.0.10/bin/redis-server 0.0.0.0:6379(logStackTrace+0x50)[0x46cad8]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:4.0.10\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:e72b66fe03796dbd\r\nredis_mode:standalone\r\nos:Linux 4.19.90-11.ky10.aarch64 aarch64\r\narch_bits:64\r\nmultiplexing_api:epoll\r\natomicvar_api:atomic-builtin\r\ngcc_version:5.4.0\r\nprocess_id:6257\r\nrun_id:b1d6a988889a45c024a7dc0f1c61bbafd815e169\r\ntcp_port:6379\r\nuptime_in_seconds:262451\r\nuptime_in_days:3\r\nhz:10\r\nlru_clock:10188143\r\nexecutable:/opt/redis-4.0.10/bin/redis-server\r\nconfig_file:/opt/redis-4.0.10/redis.conf\r\n\r\n# Clients\r\nconnected_clients:6\r\nclient_longest_output_list:0\r\nclient_biggest_input_buf:0\r\nblocked_clients:0\r\n\r\n# Memory\r\nused_memory:1521480\r\nused_memory_human:1.45M\r\nused_memory_rss:9109504\r\nused_memory_rss_human:8.69M\r\nused_memory_peak:3293232\r\nused_memory_peak_human:3.14M\r\nused_memory_peak_perc:46.20%\r\nused_memory_overhead:990972\r\nused_memory_startup:819376\r\nused_memory_dataset:530508\r\nused_memory_dataset_perc:75.56%\r\ntotal_system_memory:33692123136\r\ntotal_system_memory_human:31.38G\r\nused_memory_lua:37888\r\nused_memory_lua_human:37.00K\r\nmaxmemory:524288000\r\nmaxmemory_human:500.00M\r\nmaxmemory_policy:allkeys-lru\r\nmem_fragmentation_ratio:5.99\r\nmem_allocator:jemalloc-4.0.3\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nrdb_changes_since_last_save:242\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1637577815\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:0\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_last_cow_size:2621440\r\naof_enabled:0\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:-1\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:0\r\n\r\n# Stats\r\ntotal_connections_received:8\r\ntotal_commands_processed:643907\r\ninstantaneous_ops_per_sec:0\r\ntotal_net_input_bytes:361961188\r\ntotal_net_output_bytes:823919170\r\ninstantaneous_input_kbps:0.04\r\ninstantaneous_output_kbps:0.23\r\nrejected_connections:0\r\nsync_full:0\r\nsync_partial_ok:0\r\nsync_partial_err:0\r\nexpired_keys:5948\r\nexpired_stale_perc:0.00\r\nexpired_time_cap_reached_count:0\r\nevicted_keys:0\r\nkeyspace_hits:269615\r\nkeyspace_misses:163129\r\npubsub_channels:0\r\npubsub_patterns:9\r\nlatest_fork_usec:236\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:0\r\nmaster_replid:d7aa5b20a0034bd27410613db5c1ca3045974008\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:0\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:0\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0\r\nrepl_backlog_histlen:0\r\n\r\n# CPU\r\nused_cpu_sys:120.75\r\nused_cpu_user:58.62\r\nused_cpu_sys_children:0.28\r\nused_cpu_user_children:1.92\r\n\r\n# Commandstats\r\ncmdstat_psubscribe:calls=4,usec=27,usec_per_call=6.75\r\ncmdstat_get:calls=419105,usec=1218601,usec_per_call=2.91\r\ncmdstat_auth:calls=8,usec=17,usec_per_call=2.12\r\ncmdstat_setex:calls=77369,usec=354901,usec_per_call=4.59\r\ncmdstat_punsubscribe:calls=1,usec=94,usec_per_call=94.00\r\ncmdstat_publish:calls=211,usec=1416,usec_per_call=6.71\r\ncmdstat_hmset:calls=382,usec=2894,usec_per_call=7.58\r\ncmdstat_hgetall:calls=626,usec=2953,usec_per_call=4.72\r\ncmdstat_pexpire:calls=2198,usec=4955,usec_per_call=2.25\r\ncmdstat_sadd:calls=382,usec=1497,usec_per_call=3.92\r\ncmdstat_smembers:calls=13120,usec=35110,usec_per_call=2.68\r\ncmdstat_del:calls=71623,usec=334733,usec_per_call=4.67\r\ncmdstat_setnx:calls=57917,usec=280542,usec_per_call=4.84\r\ncmdstat_keys:calls=14,usec=1891,usec_per_call=135.07\r\ncmdstat_append:calls=382,usec=1212,usec_per_call=3.17\r\ncmdstat_srem:calls=79,usec=397,usec_per_call=5.03\r\ncmdstat_select:calls=4,usec=5,usec_per_call=1.25\r\ncmdstat_config:calls=2,usec=28,usec_per_call=14.00\r\ncmdstat_exists:calls=480,usec=411,usec_per_call=0.86\r\n\r\n# Cluster\r\ncluster_enabled:0\r\n\r\n# Keyspace\r\ndb1:keys=591,expires=585,avg_ttl=10740474\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=10 addr=143.8.69.236:44310 fd=8 name= age=1086 idle=1 flags=N db=0 sub=0 psub=3 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=psubscribe\r\nid=5 addr=127.0.0.1:48554 fd=9 name= age=262448 idle=1 flags=N db=0 sub=0 psub=3 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=psubscribe\r\nid=6 addr=127.0.0.1:48566 fd=10 name= age=262448 idle=1 flags=N db=1 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=del\r\nid=7 addr=127.0.0.1:48568 fd=11 name= age=262448 idle=1 flags=N db=0 sub=0 psub=3 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=psubscribe\r\nid=8 addr=127.0.0.1:48570 fd=12 name= age=262448 idle=15 flags=N db=1 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=get\r\nid=9 addr=143.8.69.236:44306 fd=7 name= age=1091 idle=3 flags=N db=1 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=del\r\n\r\n------ REGISTERS ------\r\n\r\n------ FAST MEMORY TEST ------\r\n6257:M 22 Nov 18:48:15.129 # Bio thread for job type #0 terminated\r\n6257:M 22 Nov 18:48:15.130 # Bio thread for job type #1 terminated\r\n6257:M 22 Nov 18:48:15.130 # Bio thread for job type #2 terminated\r\n*** Preparing to test memory region 540000 (65536 bytes)\r\n*** Preparing to test memory region 3d9a0000 (196608 bytes)\r\n*** Preparing to test memory region fffcb6600000 (4194304 bytes)\r\n*** Preparing to test memory region fffcb6be0000 (8388608 bytes)\r\n*** Preparing to test memory region fffcb73f0000 (8388608 bytes)\r\n*** Preparing to test memory region fffcb7c00000 (10485760 bytes)\r\n*** Preparing to test memory region fffcbf000000 (2097152 bytes)\r\n*** Preparing to test memory region fffcbf690000 (65536 bytes)\r\n.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n\r\n```\r\n\r\n**Additional information**\r\n\r\n1. OS: kylinos 10 ，aarch64\r\n2. Redis-server crashed after running for half a month\r\n",
  "state": "closed",
  "created_at": "2021-12-01T03:57:57Z",
  "updated_at": "2022-09-22T01:50:04Z",
  "closed_at": "2021-12-01T08:01:12Z",
  "labels": [
    "state:to-be-closed"
  ],
  "comments_data": [
    {
      "id": 983300899,
      "user": "oranagra",
      "created_at": "2021-12-01T05:23:43Z",
      "body": "For some reason the stack trace is incomplete. \r\nThere's really nothing we can do without further info. \r\nMaybe there's something else in the log file just before the crash? "
    },
    {
      "id": 983369235,
      "user": "ksmrp",
      "created_at": "2021-12-01T07:36:33Z",
      "body": "> \r\n**Thank you for your  reply**\r\nI uploaded the log file on this comment, further more , I pasted the part of the log file /var/log/messages under this line.\r\nPlease check it again , thanks again\r\n```\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Host name conflict, retrying with linux-401741\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Registering new address record for fe80::807:7c:c664:8c8a on eth0.*.\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Registering new address record for fe80::424:aad1:7d07:afd7 on eth0.*.\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Registering new address record for fe80::6e0a:b555:5563:82e1 on eth0.*.\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Registering new address record for 143.8.69.236 on eth0.IPv4.\r\nNov 22 18:47:54 host-143-8-69-236 avahi-daemon[3754]: Registering HINFO record with values 'AARCH64'/'LINUX'.\r\nNov 22 18:48:15 host-143-8-69-236 abrt-hook-ccpp: Process 6257 (redis-server) of user 0 killed by SIGSEGV - dumping core\r\nNov 22 18:48:15 host-143-8-69-236 systemd: redis.service: main process exited, code=dumped, status=11/SEGV\r\nNov 22 18:48:15 host-143-8-69-236 systemd: Unit redis.service entered failed state.\r\nNov 22 18:48:15 host-143-8-69-236 systemd: redis.service failed.\r\nNov 22 18:48:15 host-143-8-69-236 abrt-server: Package 'redis' isn't signed with proper key\r\nNov 22 18:48:15 host-143-8-69-236 abrt-server: 'post-create' on '/var/spool/abrt/ccpp-2021-11-22-18:48:15-6257' exited with 1\r\nNov 22 18:48:15 host-143-8-69-236 abrt-server: Deleting problem directory '/var/spool/abrt/ccpp-2021-11-22-18:48:15-6257'\r\n```\r\n[redis-server.log](https://github.com/redis/redis/files/7631678/redis-server.log)\r\n"
    },
    {
      "id": 983376272,
      "user": "oranagra",
      "created_at": "2021-12-01T07:48:57Z",
      "body": "i'm sorry. i don't see anything usable in these logs.\r\nall i can do is suggest you upgrade to a (much) more recent version.\r\nthis may resolve the problem that causes the crash, and if not, it'll at least very likely to resolve the problem with incomplete stack traces, so we know what happens.\r\nthe version you're using is very old, and no longer maintained."
    },
    {
      "id": 1254409518,
      "user": "qinqin111",
      "created_at": "2022-09-22T01:50:04Z",
      "body": "@ksmrp  Hello, can you tell me how to solve the problem? Is it an upgrade ？\r\n\r\n\r\n\r\n"
    }
  ]
}