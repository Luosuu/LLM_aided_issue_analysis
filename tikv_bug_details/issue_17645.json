{
  "issue_number": 17645,
  "title": "In-memory Engine: data inconsistency in table: xx, index: yy, index-count:50 != record-count:49",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n\r\n```log\r\n[2024/10/12 17:16:22.112 +00:00] [ERROR] [reporter.go:231] [\"indexLookup found data inconsistency\"] [conn=2743074836] [session_alias=] [table_name=xx] [index_name=yy] [index_cnt=50] [table_cnt=49] ...\r\n\\\"key\\\":\\\"74800000000000006C5F7203800BCB18172332B1038000002E7022329F\\\",\\\"mvcc\\\":{\\\"info\\\":{\\\"writes\\\":[{\\\"type\\\":1,\\\"start_ts\\\":453182325394243638,\\\"commit_ts\\\":453182325394243643},{\\\"start_ts\\\":453182325394243629,\\\"commit_ts\\\":453182325394243634},{\\\"start_ts\\\":453182325394243621,\\\"commit_ts\\\":453182325394243624},{\\\"start_ts\\\":453182325394243615,\\\"commit_ts\\\":453182325394243616},{\\\"start_ts\\\":453182325394243605,\\\"commit_ts\\\":453182325394243606},{\\\"start_ts\\\":453182325394243600,\\\"commit_ts\\\":453182325394243603},{\\\"start_ts\\\":453182325394243593,\\\"commit_ts\\\":453182325394243599},{\\\"start_ts\\\":453182325381136455,\\\"commit_ts\\\":453182325394243587},{\\\"start_ts\\\":453182325381136446,\\\"commit_ts\\\":453182325381136447},{\\\"start_ts\\\":453182325381136432,\\\"commit_ts\\\":453182325381136435},{\\\"start_ts\\\":453182325381136418,\\\"commit_ts\\\":453182325381136421},{\\\"type\\\":1,\\\"start_ts\\\":453181773711933489,\\\"commit_ts\\\":453181773711933493}],\r\n```\r\n\r\nThe error message indicates that TiDB read a valid index value from the coprocessor, but the corresponding row value was not found in a subsequent request within the same transaction.\r\n\r\n### What version of TiKV are you using?\r\n<!-- You can run `tikv-server --version` -->\r\n\r\nv8.3.0\r\n\r\n### Steps to reproduce\r\n<!-- If possible, provide a recipe for reproducing the error. A complete runnable program is good. -->\r\n\r\n```bash\r\nmysql --comments -h $HOST -P $PORT -u root -Ee 'DELETE FROM xx where id % 10000 > 10' \\\r\n  && sysbench --mysql-host=$HOST --mysql-user=root --mysql-port=$PORT --threads=10  --db-driver=mysql --report-interval=1 --mysql-db=zz --time=3600000  --number_workspaces=4000 --jobs_per_org=10000 --select_percentage=10 --cleanup_on_start=false many_delete_mvcc.lua run \\\r\n  || mysql --comments -h $HOST -P $PORT -u root -Ee 'update mysql.tidb set VARIABLE_VALUE=\"480h\" where VARIABLE_NAME=\"tikv_gc_life_time\";' ; date\r\n```\r\n\r\n### What did you expect?\r\n\r\nNo such error.\r\n\r\n### What did happened?\r\n\r\nsysbench fails.",
  "state": "closed",
  "created_at": "2024-10-14T09:27:19Z",
  "updated_at": "2024-10-22T07:34:48Z",
  "closed_at": "2024-10-22T07:34:48Z",
  "labels": [
    "type/bug",
    "severity/major"
  ],
  "comments_data": []
}