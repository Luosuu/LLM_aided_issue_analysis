{
  "issue_number": 16639,
  "title": "TiKV panic index out of bounds",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n```\r\n   0: tikv_util::set_panic_hook::{{closure}}\r\n             at workspace/source/tikv/components/tikv_util/src/[lib.rs:476](http://lib.rs:476/):18\r\n   1: <alloc::boxed::Box<F,A> as core::ops::function::Fn<Args>>::call\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/[boxed.rs:2029](http://boxed.rs:2029/):9\r\n      std::panicking::rust_panic_with_hook\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panicking.rs:783](http://panicking.rs:783/):13\r\n   2: std::panicking::begin_panic_handler::{{closure}}\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panicking.rs:657](http://panicking.rs:657/):13\r\n   3: std::sys_common::backtrace::__rust_end_short_backtrace\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/sys_common/[backtrace.rs:171](http://backtrace.rs:171/):18\r\n   4: rust_begin_unwind\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panicking.rs:645](http://panicking.rs:645/):5\r\n   5: core::panicking::panic_fmt\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/[panicking.rs:72](http://panicking.rs:72/):14\r\n   6: core::panicking::panic_bounds_check\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/[panicking.rs:208](http://panicking.rs:208/):5\r\n   7: raftstore::store::fsm::store::StoreFsmDelegate<EK,ER,T>::handle_msgs\r\n             at workspace/source/tikv/components/raftstore/src/store/fsm/[store.rs:838](http://store.rs:838/):13\r\n   8: <raftstore::store::fsm::store::RaftPoller<EK,ER,T> as batch_system::batch::PollHandler<raftstore::store::fsm::peer::PeerFsm<EK,ER>,raftstore::store::fsm::store::StoreFsm<EK>>>::handle_control\r\n             at workspace/source/tikv/components/raftstore/src/store/fsm/[store.rs:1035](http://store.rs:1035/):9\r\n      batch_system::batch::Poller<N,C,Handler>::poll\r\n             at workspace/source/tikv/components/batch-system/src/[batch.rs:369](http://batch.rs:369/):27\r\n   9: batch_system::batch::BatchSystem<N,C>::start_poller::{{closure}}\r\n             at workspace/source/tikv/components/batch-system/src/[batch.rs:550](http://batch.rs:550/):17\r\n      <std::thread::Builder as tikv_util::sys::thread::StdThreadBuildWrapper>::spawn_wrapper::{{closure}}\r\n             at workspace/source/tikv/components/tikv_util/src/sys/[thread.rs:438](http://thread.rs:438/):13\r\n      std::sys_common::backtrace::__rust_begin_short_backtrace\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/sys_common/[backtrace.rs:155](http://backtrace.rs:155/):18\r\n  10: std::thread::Builder::spawn_unchecked_::{{closure}}::{{closure}}\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/[mod.rs:529](http://mod.rs:529/):17\r\n      <core::panic::unwind_safe::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/panic/[unwind_safe.rs:272](http://unwind_safe.rs:272/):9\r\n      std::panicking::try::do_call\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panicking.rs:552](http://panicking.rs:552/):40\r\n      std::panicking::try\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panicking.rs:516](http://panicking.rs:516/):19\r\n      std::panic::catch_unwind\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/[panic.rs:142](http://panic.rs:142/):14\r\n      std::thread::Builder::spawn_unchecked_::{{closure}}\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/[mod.rs:528](http://mod.rs:528/):30\r\n      core::ops::function::FnOnce::call_once{{vtable.shim}}\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/[function.rs:250](http://function.rs:250/):5\r\n  11: <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/[boxed.rs:2015](http://boxed.rs:2015/):9\r\n      <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/[boxed.rs:2015](http://boxed.rs:2015/):9\r\n      std::sys::unix::thread::Thread::new::thread_start\r\n             at root/.rustup/toolchains/nightly-2023-12-28-aarch64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/sys/unix/[thread.rs:108](http://thread.rs:108/):17\r\n  12: start_thread\r\n  13: thread_start\r\n```\r\n",
  "state": "closed",
  "created_at": "2024-03-13T04:01:12Z",
  "updated_at": "2024-04-19T02:59:53Z",
  "closed_at": "2024-03-13T06:51:40Z",
  "labels": [
    "type/bug",
    "severity/major",
    "affects-7.1"
  ],
  "comments_data": []
}