{
  "issue_number": 4356,
  "title": "test: raftstore::test_conf_change::test_server_split_brain failed",
  "body": "## Bug Report\r\n\r\n**What version of Rust are you using?**\r\n\r\nnightly-2018-12-06 (`rustc 1.32.0-nightly (14997d56a 2018-12-05)`)\r\n\r\n**What operating system and CPU are you using?**\r\n\r\n(The failure comes from the CI)\r\n\r\n**What did you do?**\r\n\r\nWait for the CI report from #4348\r\n\r\n**What did you expect to see?**\r\n\r\nCI pass\r\n\r\n**What did you see instead?**\r\n\r\n[CI failed](https://internal.pingcap.net/idc-jenkins/blue/organizations/jenkins/tikv_ghpr_test/detail/tikv_ghpr_test/2248/pipeline/) in the unrelated test `raftstore::test_conf_change::test_server_split_brain`:\r\n\r\n```\r\ntest raftstore::test_conf_change::test_server_split_brain ... thread 'raftstore::test_conf_change::test_server_split_brain' panicked at 'can't get value Some(\"v1\") for key \"k1\"', components/test_raftstore/src/util.rs:64:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n             at src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at src/libstd/sys_common/backtrace.rs:59\r\n             at src/libstd/panicking.rs:211\r\n   3: std::panicking::default_hook\r\n             at src/libstd/panicking.rs:227\r\n   4: std::panicking::rust_panic_with_hook\r\n             at src/libstd/panicking.rs:491\r\n   5: std::panicking::continue_panic_fmt\r\n             at src/libstd/panicking.rs:398\r\n   6: std::panicking::begin_panic_fmt\r\n             at src/libstd/panicking.rs:353\r\n   7: test_raftstore::util::must_get\r\n             at components/test_raftstore/src/util.rs:64\r\n   8: test_raftstore::util::must_get_equal\r\n             at components/test_raftstore/src/util.rs:72\r\n   9: integrations::raftstore::test_conf_change::test_split_brain\r\n             at tests/integrations/raftstore/test_conf_change.rs:456\r\n  10: integrations::raftstore::test_conf_change::test_server_split_brain\r\n             at tests/integrations/raftstore/test_conf_change.rs:508\r\n  11: integrations::raftstore::test_conf_change::test_server_split_brain::{{closure}}\r\n             at tests/integrations/raftstore/test_conf_change.rs:505\r\n  12: core::ops::function::FnOnce::call_once\r\n             at /rustc/14997d56a550f4aa99fe737593cd2758227afc56/src/libcore/ops/function.rs:238\r\n  13: <F as alloc::boxed::FnBox<A>>::call_box\r\n             at src/libtest/lib.rs:1471\r\n             at /rustc/14997d56a550f4aa99fe737593cd2758227afc56/src/libcore/ops/function.rs:238\r\n             at /rustc/14997d56a550f4aa99fe737593cd2758227afc56/src/liballoc/boxed.rs:673\r\n  14: __rust_maybe_catch_panic\r\n             at src/libpanic_unwind/lib.rs:102\r\n```\r\n\r\n(This line:\r\n\r\nhttps://github.com/tikv/tikv/blob/6aee17ab420f513b6c6c60329a00720766443d8d/tests/integrations/raftstore/test_conf_change.rs#L456\r\n\r\n)\r\n\r\n* Original log file: [log.txt](https://github.com/tikv/tikv/files/2953379/log.txt)\r\n\r\nThe PR is based on 6aee17ab. The PR only touches `src/import/engine.rs`, which cannot be the cause of the failure above.\r\n\r\n",
  "state": "closed",
  "created_at": "2019-03-11T17:06:41Z",
  "updated_at": "2020-11-04T05:26:54Z",
  "closed_at": "2020-11-04T05:26:54Z",
  "labels": [
    "type/bug",
    "component/test-bench",
    "priority/high",
    "severity/major"
  ],
  "comments_data": [
    {
      "id": 529817413,
      "user": "overvenus",
      "created_at": "2019-09-10T07:51:24Z",
      "body": "Another failed case \r\n[internal.pingcap.net.txt](https://github.com/tikv/tikv/files/3594423/internal.pingcap.net.txt)\r\n"
    },
    {
      "id": 533867910,
      "user": "ghost",
      "created_at": "2019-09-22T10:15:03Z",
      "body": "It fails intermittently, even when ran alone, like:\r\n`$ set +e; counter=0; trap 'echo \"Been $counter tries\"' ERR; true; while test \"$?\" == \"0\"; do let 'counter++'; time RUST_BACKTRACE=1 RUSTFLAGS=-Cdebuginfo=2 cargo test --all raftstore::test_conf_change::test_server_split_brain -- --nocapture ; done `\r\n\r\n<details>\r\n\r\n```\r\n!! master-installed (default)\r\n!! Executing '/home/user/build/2nonpkgs/rust.stuff/cargo/cargo//target/release//cargo' in pwd='/home/user/build/2nonpkgs/rust.stuff/tikv' with args(5): 'test --all raftstore::test_conf_change::test_server_split_brain -- --nocapture'\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.54s\r\n     Running target/debug/deps/backup-248c27fd955a2fe7\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out\r\n\r\n     Running target/debug/deps/cmd-b9006753276863bc\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/tikv_ctl-97d094d1325df856\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out\r\n\r\n     Running target/debug/deps/tikv_server-c23e19a6a06b8d3c\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/codec-044d8c0f849c42ff\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 82 filtered out\r\n\r\n     Running target/debug/deps/engine-b188d984ef37defa\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 25 filtered out\r\n\r\n     Running target/debug/deps/external_storage-4988e07a9142350b\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out\r\n\r\n     Running target/debug/deps/fuzz-f3dff793f29c1988\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/fuzz_targets-e1b24d370909a745\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/fuzzer_afl-86ef046e621fda5c\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/fuzzer_honggfuzz-5e5cd434dd44c0b1\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/fuzzer_libfuzzer-0a320d96cf63c736\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/keys-827caf0ee685ffee\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out\r\n\r\n     Running target/debug/deps/log_wrappers-27fd1652dd182864\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out\r\n\r\n     Running target/debug/deps/match_template-973ec91222b82bee\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out\r\n\r\n     Running target/debug/deps/panic_hook-445b56961b21beaa\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/pd_client-e2e754210a98801c\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out\r\n\r\n     Running target/debug/deps/profiler-aa4b6882167b555d\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/sst_importer-d66807a93b25ec5f\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out\r\n\r\n     Running target/debug/deps/test_coprocessor-1e07b971b322606f\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out\r\n\r\n     Running target/debug/deps/test_raftstore-0f0c58deb91e4637\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/test_storage-26cf9f81a39c9600\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/test_util-2820b084c43f6ca3\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out\r\n\r\n     Running target/debug/deps/tidb_query-da60cd5a9b0811bf\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 508 filtered out\r\n\r\n     Running target/debug/deps/tidb_query_codegen-635361f42feeabab\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 11 filtered out\r\n\r\n     Running target/debug/deps/tidb_query_datatype-19262fb96d973530\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n     Running target/debug/deps/tikv-9301ed19cd0d887d\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 285 filtered out\r\n\r\n     Running target/debug/deps/integrations-af4454caf70e82d5\r\n\r\nrunning 1 test\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nthread 'raftstore::test_conf_change::test_server_split_brain' panicked at 'region Some(id: 1 region_epoch { conf_ver: 3 version: 1 } peers { id: 1 store_id: 1 } peers { id: 2 store_id: 2 } peers { id: 3 store_id: 3 }) has no peer id: 4 store_id: 4', /home/user/build/2nonpkgs/rust.stuff/tikv/components/test_raftstore/src/pd.rs:753:9\r\nstack backtrace:\r\n   0: backtrace::backtrace::libunwind::trace\r\n             at /home/user/.cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.35/src/backtrace/libunwind.rs:88\r\n   1: backtrace::backtrace::trace_unsynchronized\r\n             at /home/user/.cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.35/src/backtrace/mod.rs:66\r\n   2: std::sys_common::backtrace::_print\r\n             at src/libstd/sys_common/backtrace.rs:47\r\n   3: std::sys_common::backtrace::print\r\n             at src/libstd/sys_common/backtrace.rs:36\r\n   4: std::panicking::default_hook::{{closure}}\r\n             at src/libstd/panicking.rs:200\r\n   5: std::panicking::default_hook\r\n             at src/libstd/panicking.rs:214\r\n   6: std::panicking::rust_panic_with_hook\r\n             at src/libstd/panicking.rs:477\r\n   7: std::panicking::continue_panic_fmt\r\n             at src/libstd/panicking.rs:384\r\n   8: std::panicking::begin_panic_fmt\r\n             at src/libstd/panicking.rs:339\r\n   9: test_raftstore::pd::TestPdClient::must_have_peer\r\n             at ./components/test_raftstore/src/pd.rs:753\r\n  10: test_raftstore::pd::TestPdClient::must_add_peer\r\n             at ./components/test_raftstore/src/pd.rs:850\r\n  11: integrations::raftstore::test_conf_change::test_split_brain\r\n             at ./tests/integrations/raftstore/test_conf_change.rs:442\r\n  12: integrations::raftstore::test_conf_change::test_server_split_brain\r\n             at ./tests/integrations/raftstore/test_conf_change.rs:498\r\n  13: integrations::raftstore::test_conf_change::test_server_split_brain::{{closure}}\r\n             at ./tests/integrations/raftstore/test_conf_change.rs:495\r\n  14: core::ops::function::FnOnce::call_once\r\n             at /home/user/build/2nonpkgs/rust.stuff/rust/rust/src/libcore/ops/function.rs:227\r\n  15: <alloc::boxed::Box<F> as core::ops::function::FnOnce<A>>::call_once\r\n             at /home/user/build/2nonpkgs/rust.stuff/rust/rust/src/liballoc/boxed.rs:922\r\n  16: __rust_maybe_catch_panic\r\n             at src/libpanic_unwind/lib.rs:80\r\n  17: std::panicking::try\r\n             at /home/user/build/2nonpkgs/rust.stuff/rust/rust/src/libstd/panicking.rs:275\r\n  18: test::run_test::run_test_inner::{{closure}}\r\n             at src/libtest/lib.rs:1413\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 1of2 attempting to resolve (requested)hostname:\r\n127.0.0.1\r\nglibc64:../sysdeps/posix/getaddrinfo.c:2201/getaddrinfo: integrations-af4454caf70e82d5[233277](full:'/home/user/build/2nonpkgs/rust.stuff/tikv/target/debug/deps/integrations-af4454caf70e82d5') for user user(1000(eff:user(1000))) 2of2 successfully resolved requested hostname('127.0.0.1') which was not transformed('127.0.0.1') as follows:\r\n127.0.0.1 127.0.0.1\r\ntest raftstore::test_conf_change::test_server_split_brain ... FAILED\r\n\r\nfailures:\r\n\r\nfailures:\r\n    raftstore::test_conf_change::test_server_split_brain\r\n\r\ntest result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 288 filtered out\r\n\r\nerror: test failed, to rerun pass '-p tikv --test integrations'\r\nBeen 25 tries\r\n\r\nreal\t0m9.082s\r\nuser\t0m8.543s\r\nsys\t0m2.321s\r\n```\r\n\r\n</details>\r\n\r\nlooks like [the previous comment](https://github.com/tikv/tikv/issues/4356#issuecomment-529817413) has all the gory details"
    },
    {
      "id": 721519486,
      "user": "hicqu",
      "created_at": "2020-11-04T05:26:54Z",
      "body": "Stablized by #5719."
    }
  ]
}