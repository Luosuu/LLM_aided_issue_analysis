{
  "issue_number": 14254,
  "title": "copr: paging not stop with limit executor",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n\r\n### What version of TiKV are you using?\r\n<!-- You can run `tikv-server --version` -->\r\n\r\n```\r\nTiKV \r\nRelease Version:   6.7.0-alpha\r\nEdition:           Community\r\nGit Commit Hash:   061d874c297307a0c6184d827577c58378ae4b72\r\nGit Commit Branch: heads/refs/tags/v6.7.0-alpha\r\nUTC Build Time:    2023-02-21 14:34:16\r\nRust Version:      rustc 1.67.0-nightly (96ddd32c4 2022-11-14)\r\nEnable Features:   pprof-fp jemalloc mem-profiling portable sse test-engine-kv-rocksdb test-engine-raft-raft-engine cloud-aws cloud-gcp cloud-azure\r\nProfile:           dist_release\r\n```\r\n\r\n### What operating system and CPU are you using?\r\n<!-- If you're using Linux, you can run `cat /proc/cpuinfo` -->\r\n\r\nx64 CPU.\r\n\r\n### Steps to reproduce\r\n<!-- If possible, provide a recipe for reproducing the error. A complete runnable program is good. -->\r\n\r\nRun the latest tikv with tidb v6.5.0.\r\n\r\nPrepare\r\n\r\n```sql\r\nCREATE TABLE t(id int PRIMARY KEY, val int)\r\nPARTITION BY RANGE (id)\r\n(PARTITION p1 VALUES LESS THAN (100),\r\n PARTITION p2 VALUES LESS THAN (200),\r\n PARTITION p3 VALUES LESS THAN (300));\r\n\r\nINSERT INTO t VALUES(50, 50), (51, 51), (52, 52), (53, 53), (150, 150), (250, 250);\r\nANALYZE TABLE t;\r\n```\r\n\r\nRun\r\n\r\n```sql\r\nTRACE SELECT * FROM t ORDER BY id ASC LIMIT 1;\r\n```\r\n\r\n### What did you expect?\r\n\r\nOnly one task to each partition because it's limit 1.\r\n\r\n### What did happened?\r\n\r\nThe paging request is calling repeatly.\r\n\r\n```sql\r\nMySQL [test]> TRACE SELECT * FROM t ORDER BY id ASC LIMIT 1;\r\n+-------------------------------------------------------------------------------+-----------------+------------+\r\n| operation                                                                     | startTS         | duration   |\r\n+-------------------------------------------------------------------------------+-----------------+------------+\r\n| trace                                                                         | 13:42:52.980185 | 7.519375ms |\r\n|   ├─session.ExecuteStmt                                                       | 13:42:52.980194 | 638.348µs  |\r\n|   │ ├─executor.Compile                                                        | 13:42:52.980229 | 283.415µs  |\r\n|   │ └─session.runStmt                                                         | 13:42:52.980537 | 272.381µs  |\r\n|   │   └─TableReaderExecutor.Open                                              | 13:42:52.980669 | 96.38µs    |\r\n|   │     └─distsql.Select                                                      | 13:42:52.980693 | 60.134µs   |\r\n|   │       ├─regionRequest.SendReqCtx                                          | 13:42:52.980916 | 942.087µs  |\r\n|   │       │ ├─rpcClient.SendRequest, region ID: 98, type: Cop                 | 13:42:52.980966 | 860.443µs  |\r\n|   │       │ │ └─tikv.RPC                                                      | 13:42:52.980972 | 432.666µs  |\r\n|   │       │ │   └─tikv.Wait                                                   | 13:42:52.980972 | 99.314µs   |\r\n|   │       │ │     └─tikv.GetSnapshot                                          | 13:42:52.980972 | 99.314µs   |\r\n|   │       │ └─regionRequest.SendReqCtx                                        | 13:42:52.981908 | 740.805µs  |\r\n|   │       │   ├─rpcClient.SendRequest, region ID: 98, type: Cop               | 13:42:52.981936 | 686.328µs  |\r\n|   │       │   │ └─tikv.RPC                                                    | 13:42:52.981944 | 304.019µs  |\r\n|   │       │   │   └─tikv.Wait                                                 | 13:42:52.981944 | 36.318µs   |\r\n|   │       │   │     └─tikv.GetSnapshot                                        | 13:42:52.981944 | 36.318µs   |\r\n|   │       │   └─regionRequest.SendReqCtx                                      | 13:42:52.982701 | 562.919µs  |\r\n|   │       │     ├─rpcClient.SendRequest, region ID: 98, type: Cop             | 13:42:52.982733 | 517.313µs  |\r\n|   │       │     │ └─tikv.RPC                                                  | 13:42:52.982737 | 252.825µs  |\r\n|   │       │     │   └─tikv.Wait                                               | 13:42:52.982737 | 27.098µs   |\r\n|   │       │     │     └─tikv.GetSnapshot                                      | 13:42:52.982737 | 27.098µs   |\r\n|   │       │     └─regionRequest.SendReqCtx                                    | 13:42:52.983291 | 541.478µs  |\r\n|   │       │       ├─rpcClient.SendRequest, region ID: 98, type: Cop           | 13:42:52.983311 | 502.926µs  |\r\n|   │       │       │ └─tikv.RPC                                                | 13:42:52.983314 | 231.314µs  |\r\n|   │       │       │   └─tikv.Wait                                             | 13:42:52.983314 | 20.253µs   |\r\n|   │       │       │     └─tikv.GetSnapshot                                    | 13:42:52.983314 | 20.253µs   |\r\n|   │       │       └─regionRequest.SendReqCtx                                  | 13:42:52.983871 | 597.84µs   |\r\n|   │       │         └─rpcClient.SendRequest, region ID: 98, type: Cop         | 13:42:52.983892 | 559.009µs  |\r\n|   │       │           └─tikv.RPC                                              | 13:42:52.983895 | 270.215µs  |\r\n|   │       │             └─tikv.Wait                                           | 13:42:52.983895 | 22.768µs   |\r\n|   │       │               └─tikv.GetSnapshot                                  | 13:42:52.983895 | 22.768µs   |\r\n|   │       ├─regionRequest.SendReqCtx                                          | 13:42:52.984562 | 862.957µs  |\r\n|   │       │ ├─rpcClient.SendRequest, region ID: 100, type: Cop                | 13:42:52.984585 | 814.907µs  |\r\n|   │       │ │ └─tikv.RPC                                                      | 13:42:52.984588 | 417.091µs  |\r\n|   │       │ │   └─tikv.Wait                                                   | 13:42:52.984588 | 141.637µs  |\r\n|   │       │ │     └─tikv.GetSnapshot                                          | 13:42:52.984588 | 141.637µs  |\r\n|   │       │ └─regionRequest.SendReqCtx                                        | 13:42:52.985471 | 597.141µs  |\r\n|   │       │   └─rpcClient.SendRequest, region ID: 100, type: Cop              | 13:42:52.985513 | 535.891µs  |\r\n|   │       │     └─tikv.RPC                                                    | 13:42:52.985517 | 216.368µs  |\r\n|   │       │       └─tikv.Wait                                                 | 13:42:52.985517 | 21.511µs   |\r\n|   │       │         └─tikv.GetSnapshot                                        | 13:42:52.985517 | 21.511µs   |\r\n|   │       └─regionRequest.SendReqCtx                                          | 13:42:52.986157 | 718.665µs  |\r\n|   │         ├─rpcClient.SendRequest, region ID: 10, type: Cop                 | 13:42:52.986193 | 647.567µs  |\r\n|   │         │ └─tikv.RPC                                                      | 13:42:52.986197 | 243.047µs  |\r\n|   │         │   └─tikv.Wait                                                   | 13:42:52.986197 | 84.647µs   |\r\n|   │         │     └─tikv.GetSnapshot                                          | 13:42:52.986197 | 84.647µs   |\r\n|   │         └─regionRequest.SendReqCtx                                        | 13:42:52.986952 | 596.513µs  |\r\n|   │           └─rpcClient.SendRequest, region ID: 10, type: Cop               | 13:42:52.986990 | 544.551µs  |\r\n|   │             └─tikv.RPC                                                    | 13:42:52.986994 | 236.203µs  |\r\n|   │               └─tikv.Wait                                                 | 13:42:52.986994 | 28.914µs   |\r\n|   │                 └─tikv.GetSnapshot                                        | 13:42:52.986994 | 28.914µs   |\r\n|   ├─*executor.TopNExec.Next                                                   | 13:42:52.980851 | 6.792049ms |\r\n|   │ ├─*executor.TableReaderExecutor.Next                                      | 13:42:52.980863 | 1.146303ms |\r\n|   │ ├─*executor.TableReaderExecutor.Next                                      | 13:42:52.982048 | 5.549715ms |\r\n|   │ └─*executor.TableReaderExecutor.Next                                      | 13:42:52.987615 | 17.6µs     |\r\n|   └─*executor.TopNExec.Next                                                   | 13:42:52.987658 | 2.375µs    |\r\n+-------------------------------------------------------------------------------+-----------------+------------+\r\n56 rows in set (0.009 sec)\r\n```\r\n",
  "state": "closed",
  "created_at": "2023-02-22T05:44:46Z",
  "updated_at": "2023-02-22T09:49:08Z",
  "closed_at": "2023-02-22T09:49:08Z",
  "labels": [
    "type/bug",
    "severity/moderate",
    "affects-6.5"
  ],
  "comments_data": []
}