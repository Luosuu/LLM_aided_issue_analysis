{
  "issue_number": 17654,
  "title": "Flaky test `tests::failpoints cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state`",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n\r\n### What version of TiKV are you using?\r\nbranch: release-7.5\r\ncommit: bba48d87b28a45970c1a9ca11a564a04dda7d290\r\n\r\n### What operating system and CPU are you using?\r\n<!-- If you're using Linux, you can run `cat /proc/cpuinfo` -->\r\n\r\nCI @ linux/amd64\r\n\r\n### Steps to reproduce\r\n<!-- If possible, provide a recipe for reproducing the error. A complete runnable program is good. -->\r\n\r\nCI run the unit job.\r\n\r\n### What did you expect?\r\n\r\nCI job passed\r\n\r\n### What did happened?\r\n\r\nFailed with flaky tests\r\n\r\n```log\r\n\r\n  TRY 3 ABRT [   4.862s] tests::failpoints cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state\r\n\r\n\r\n\r\n--- TRY 3 STDOUT:        tests::failpoints cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state ---\r\n\r\n\r\n\r\nrunning 1 test\r\n\r\n\r\n\r\n--- TRY 3 STDERR:        tests::failpoints cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state ---\r\n\r\nthread 'raftstore-1-0::test_update_apply_index_before_sync_read_state' panicked at 'failpoint on_step_read_index_msg panic', /rust/registry/src/github.com-1ecc6299db9ec823/fail-0.5.1/src/lib.rs:496:25\r\n\r\nstack backtrace:\r\n\r\n   0: rust_begin_unwind\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:575:5\r\n\r\n   1: core::panicking::panic_fmt\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panicking.rs:65:14\r\n\r\n   2: fail::FailPoint::eval\r\n\r\n   3: fail::eval\r\n\r\n   4: raftstore::store::peer::Peer<EK,ER>::step\r\n\r\n   5: raftstore::store::fsm::peer::PeerFsmDelegate<EK,ER,T>::on_raft_message\r\n\r\n   6: raftstore::store::fsm::peer::PeerFsmDelegate<EK,ER,T>::handle_msgs\r\n\r\n   7: <raftstore::store::fsm::store::RaftPoller<EK,ER,T> as batch_system::batch::PollHandler<raftstore::store::fsm::peer::PeerFsm<EK,ER>,raftstore::store::fsm::store::StoreFsm<EK>>>::handle_normal\r\n\r\n   8: batch_system::batch::Poller<N,C,Handler>::poll\r\n\r\n   9: batch_system::batch::BatchSystem<N,C>::start_poller::{{closure}}\r\n\r\n  10: <std::thread::Builder as tikv_util::sys::thread::StdThreadBuildWrapper>::spawn_wrapper::{{closure}}\r\n\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nthread 'sched-worker-pool::test_update_apply_index_before_sync_read_state-0' panicked at 'undetermined error: Error(Undetermined(\"async write on_applied callback is dropped\")) cid=4, tag=prewrite, process\r\n\r\n                        result=Some(PrewriteResult { result: PrewriteResult { locks: [], min_commit_ts: TimeStamp(0), one_pc_commit_ts: TimeStamp(0) } })', /home/jenkins/tikv-src/src/storage/txn/scheduler.rs:870:25\r\n\r\nstack backtrace:\r\n\r\n   0: rust_begin_unwind\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:575:5\r\n\r\n   1: core::panicking::panic_fmt\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panicking.rs:65:14\r\n\r\n   2: tikv::storage::txn::scheduler::TxnScheduler<E,L>::on_write_finished\r\n\r\n   3: tikv::storage::txn::scheduler::TxnScheduler<E,L>::process_write::{{closure}}\r\n\r\n   4: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n\r\n   5: tikv::storage::txn::scheduler::TxnScheduler<E,L>::process::{{closure}}::{{closure}}\r\n\r\n   6: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n\r\n   7: <resource_metering::InTags<T> as core::future::future::Future>::poll\r\n\r\n   8: tikv::storage::txn::scheduler::TxnScheduler<E,L>::process::{{closure}}\r\n\r\n   9: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n\r\n  10: tikv::storage::txn::scheduler::TxnScheduler<E,L>::execute::{{closure}}\r\n\r\n  11: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n\r\n  12: <tracker::tls::TrackedFuture<F> as core::future::future::Future>::poll::{{closure}}\r\n\r\n  13: std::thread::local::LocalKey<T>::try_with\r\n\r\n  14: std::thread::local::LocalKey<T>::with\r\n\r\n  15: <tracker::tls::TrackedFuture<F> as core::future::future::Future>::poll\r\n\r\n  16: <futures_util::future::future::map::Map<Fut,F> as core::future::future::Future>::poll\r\n\r\n  17: <futures_util::future::future::Map<Fut,F> as core::future::future::Future>::poll\r\n\r\n  18: yatp::task::future::RawTask<F>::poll\r\n\r\n  19: yatp::task::future::TaskCell::poll\r\n\r\n  20: <yatp::task::future::Runner as yatp::pool::runner::Runner>::handle\r\n\r\n  21: <tikv_util::yatp_pool::YatpPoolRunner<T> as yatp::pool::runner::Runner>::handle\r\n\r\n  22: yatp::pool::worker::WorkerThread<T,R>::run\r\n\r\n  23: yatp::pool::builder::LazyBuilder<T>::build::{{closure}}\r\n\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nthread 'cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state' panicked at 'called `Result::unwrap()` on an `Err` value: RpcFailure(RpcStatus { code: 1-CANCELLED, message: \"CANCELLED\", details: [] })', components/test_raftstore/src/util.rs:1025:59\r\n\r\nstack backtrace:\r\n\r\n   0: rust_begin_unwind\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:575:5\r\n\r\n   1: core::panicking::panic_fmt\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panicking.rs:65:14\r\n\r\n   2: core::result::unwrap_failed\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/result.rs:1791:5\r\n\r\n   3: core::result::Result<T,E>::unwrap\r\n\r\n   4: test_raftstore::util::must_kv_prewrite_with\r\n\r\n   5: test_raftstore::util::must_kv_prewrite\r\n\r\n   6: test_raftstore::util::must_kv_write\r\n\r\n   7: test_raftstore::util::PeerClient::must_kv_write\r\n\r\n   8: failpoints::cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state\r\n\r\n             at /home/jenkins/tikv-src/tests/failpoints/cases/test_replica_stale_read.rs:240:5\r\n\r\n   9: failpoints::cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state::{{closure}}\r\n\r\n             at /home/jenkins/tikv-src/tests/failpoints/cases/test_replica_stale_read.rs:204:53\r\n\r\n  10: core::ops::function::FnOnce::call_once\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/ops/function.rs:513:5\r\n\r\n  11: test_util::runner::run_test_with_hook::{{closure}}::{{closure}}\r\n\r\n  12: core::ops::function::FnOnce::call_once{{vtable.shim}}\r\n\r\n  13: <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once\r\n\r\n             at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/alloc/src/boxed.rs:2000:9\r\n\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nthread 'cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state' panicked at 'called `Result::unwrap()` on an `Err` value: Any { .. }', /rust/git/checkouts/yatp-e704b73c3ee279b6/5572a78/src/pool.rs:72:26\r\n\r\nstack backtrace:\r\n\r\n   0:     0x55f5dea93410 - std::backtrace_rs::backtrace::libunwind::trace::he534b130db6360ed\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/../../backtrace/src/backtrace/libunwind.rs:93:5\r\n\r\n   1:     0x55f5dea93410 - std::backtrace_rs::backtrace::trace_unsynchronized::hc3486e10c7777b38\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n\r\n   2:     0x55f5dea93410 - std::sys_common::backtrace::_print_fmt::ha24198a22cf70db0\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:65:5\r\n\r\n   3:     0x55f5dea93410 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::he928616f28db1c44\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:44:22\r\n\r\n   4:     0x55f5deabd47e - core::fmt::write::hfc4e1f18015528cf\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/fmt/mod.rs:1209:17\r\n\r\n   5:     0x55f5dea8c385 - std::io::Write::write_fmt::h1fe0ff478ba9434a\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/io/mod.rs:1682:15\r\n\r\n   6:     0x55f5dea931d5 - std::sys_common::backtrace::_print::hc5210df762c2ee4d\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:47:5\r\n\r\n   7:     0x55f5dea931d5 - std::sys_common::backtrace::print::h01d5ef97fb586ab1\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:34:9\r\n\r\n   8:     0x55f5dea94ecf - std::panicking::default_hook::{{closure}}::hfaf4dc37dc2875b0\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:267:22\r\n\r\n   9:     0x55f5dea94c0a - std::panicking::default_hook::h22df008dfc46e0e0\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:286:9\r\n\r\n  10:     0x55f5dea955cc - std::panicking::rust_panic_with_hook::h8bb52976cbf68a37\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:688:13\r\n\r\n  11:     0x55f5dea95367 - std::panicking::begin_panic_handler::{{closure}}::hb6582e9b11a93445\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:579:13\r\n\r\n  12:     0x55f5dea938bc - std::sys_common::backtrace::__rust_end_short_backtrace::hd69a588bdd28408e\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:137:18\r\n\r\n  13:     0x55f5dea95082 - rust_begin_unwind\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:575:5\r\n\r\n  14:     0x55f5d7686833 - core::panicking::panic_fmt::hb1806527c2beebe3\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panicking.rs:65:14\r\n\r\n  15:     0x55f5d7686af3 - core::result::unwrap_failed::he2b30c6b959db85a\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/result.rs:1791:5\r\n\r\n  16:     0x55f5dd3cb7f7 - core::result::Result<T,E>::unwrap::h2d1b506fff2f1b04\r\n\r\n  17:     0x55f5dd429a66 - yatp::pool::ThreadPool<T>::shutdown::h09c534635bed83e4\r\n\r\n  18:     0x55f5dd429b4a - <yatp::pool::ThreadPool<T> as core::ops::drop::Drop>::drop::h6417c0abbf7582dd\r\n\r\n  19:     0x55f5dd3eab85 - core::ptr::drop_in_place<yatp::pool::ThreadPool<yatp::task::future::TaskCell>>::h23ab8c128870596a\r\n\r\n  20:     0x55f5dd3ea555 - core::ptr::drop_in_place<tikv_util::yatp_pool::future_pool::PoolInner>::hdae06e44bacf77b7\r\n\r\n  21:     0x55f5dd4187a9 - alloc::sync::Arc<T>::drop_slow::h5f2f45abaef9f0ae\r\n\r\n  22:     0x55f5dd41941e - <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop::h5744a8e025b2f796\r\n\r\n  23:     0x55f5dd3eb2ba - core::ptr::drop_in_place<alloc::sync::Arc<tikv_util::yatp_pool::future_pool::PoolInner>>::he83721c5f25edc07\r\n\r\n  24:     0x55f5dd3ea5ba - core::ptr::drop_in_place<tikv_util::yatp_pool::future_pool::FuturePool>::h6eaa825fe32bb6a4\r\n\r\n  25:     0x55f5d9c36126 - core::ptr::drop_in_place<tikv::storage::txn::sched_pool::VanillaQueue>::ha16975dff4539b87\r\n\r\n  26:     0x55f5d9c34255 - core::ptr::drop_in_place<tikv::storage::txn::sched_pool::SchedPool>::h38c558354c21e6fa\r\n\r\n  27:     0x55f5d9be947b - core::ptr::drop_in_place<tikv::storage::txn::scheduler::TxnSchedulerInner<tikv::server::lock_manager::LockManager>>::h324892b495b0222f\r\n\r\n  28:     0x55f5d9a6685c - alloc::sync::Arc<T>::drop_slow::h0b42620b0fb01b99\r\n\r\n  29:     0x55f5d9a7f47e - <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop::hf88fe24669a6e917\r\n\r\n  30:     0x55f5d9bf48fa - core::ptr::drop_in_place<alloc::sync::Arc<tikv::storage::txn::scheduler::TxnSchedulerInner<tikv::server::lock_manager::LockManager>>>::hef6c41520c5b6ced\r\n\r\n  31:     0x55f5d993b5ea - core::ptr::drop_in_place<tikv::storage::txn::scheduler::TxnScheduler<tikv::server::raftkv::RaftKv<engine_rocks::engine::RocksEngine,test_raftstore::transport_simulate::SimulateTransport<raftstore::router::ServerRaftStoreRouter<engine_rocks::engine::RocksEngine,raft_log_engine::engine::RaftLogEngine>>>,tikv::server::lock_manager::LockManager>>::hafb4022b2ddd67dc\r\n\r\n  32:     0x55f5d993b206 - core::ptr::drop_in_place<tikv::storage::Storage<tikv::server::raftkv::RaftKv<engine_rocks::engine::RocksEngine,test_raftstore::transport_simulate::SimulateTransport<raftstore::router::ServerRaftStoreRouter<engine_rocks::engine::RocksEngine,raft_log_engine::engine::RaftLogEngine>>>,tikv::server::lock_manager::LockManager,api_version::ApiV1>>::h7d4641ca39791044\r\n\r\n  33:     0x55f5d993dd9e - core::ptr::drop_in_place<tikv::server::service::kv::Service<tikv::server::raftkv::RaftKv<engine_rocks::engine::RocksEngine,test_raftstore::transport_simulate::SimulateTransport<raftstore::router::ServerRaftStoreRouter<engine_rocks::engine::RocksEngine,raft_log_engine::engine::RaftLogEngine>>>,tikv::server::lock_manager::LockManager,api_version::ApiV1>>::h0d1babb0c4b8f706\r\n\r\n  34:     0x55f5d9954c15 - core::ptr::drop_in_place<tikv::server::server::BuilderFactory<tikv::server::service::kv::Service<tikv::server::raftkv::RaftKv<engine_rocks::engine::RocksEngine,test_raftstore::transport_simulate::SimulateTransport<raftstore::router::ServerRaftStoreRouter<engine_rocks::engine::RocksEngine,raft_log_engine::engine::RaftLogEngine>>>,tikv::server::lock_manager::LockManager,api_version::ApiV1>>>::hc4d453942dcaa52e\r\n\r\n  35:     0x55f5d9c42d7b - core::ptr::drop_in_place<alloc::boxed::Box<dyn tikv::server::server::GrpcBuilderFactory>>::h9e39b1f222ed3c97\r\n\r\n  36:     0x55f5d9939fc9 - core::ptr::drop_in_place<tikv::server::server::Server<tikv::server::resolve::PdStoreAddrResolver,tikv::server::raftkv::RaftKv<engine_rocks::engine::RocksEngine,test_raftstore::transport_simulate::SimulateTransport<raftstore::router::ServerRaftStoreRouter<engine_rocks::engine::RocksEngine,raft_log_engine::engine::RaftLogEngine>>>>>::h863d80f0ec901ca5\r\n\r\n  37:     0x55f5d96c8aef - <test_raftstore::server::ServerCluster as test_raftstore::cluster::Simulator>::stop_node::h5642ecbfba070109\r\n\r\n  38:     0x55f5d8c5bbb0 - test_raftstore::cluster::Cluster<T>::stop_node::h86ac7b6ae77fa15e\r\n\r\n  39:     0x55f5d8c5f3a5 - test_raftstore::cluster::Cluster<T>::shutdown::h4ca8ed011dddba85\r\n\r\n  40:     0x55f5d8c5fbdc - <test_raftstore::cluster::Cluster<T> as core::ops::drop::Drop>::drop::h818e94e8553a44cc\r\n\r\n  41:     0x55f5d99cd035 - core::ptr::drop_in_place<test_raftstore::cluster::Cluster<test_raftstore::server::ServerCluster>>::hf8d7b5ec0f4482fd\r\n\r\n  42:     0x55f5d796501c - failpoints::cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state::h9a83ec8078337fe0\r\n\r\n                               at /home/jenkins/tikv-src/tests/failpoints/cases/test_replica_stale_read.rs:249:1\r\n\r\n  43:     0x55f5d7a0e4be - failpoints::cases::test_replica_stale_read::test_update_apply_index_before_sync_read_state::{{closure}}::h4af353fdac946363\r\n\r\n                               at /home/jenkins/tikv-src/tests/failpoints/cases/test_replica_stale_read.rs:204:53\r\n\r\n  44:     0x55f5d7a0e4be - core::ops::function::FnOnce::call_once::ha8f9d691c6f1730e\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/ops/function.rs:513:5\r\n\r\n  45:     0x55f5d9a19415 - test_util::runner::run_test_with_hook::{{closure}}::{{closure}}::h4089a60f4bebbd79\r\n\r\n  46:     0x55f5d9a1e814 - core::ops::function::FnOnce::call_once{{vtable.shim}}::h55a73f8cf89ec84c\r\n\r\n  47:     0x55f5dbc7c61a - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h312fea4ff6db7ecf\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/alloc/src/boxed.rs:2000:9\r\n\r\n  48:     0x55f5dbc7c61a - test::__rust_begin_short_backtrace::hb48c52ec89163dba\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/test/src/lib.rs:637:18\r\n\r\n  49:     0x55f5dbc4f263 - test::run_test::{{closure}}::hb6f66070f49159ed\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/test/src/lib.rs:620:34\r\n\r\n  50:     0x55f5dbc4f263 - core::ops::function::FnOnce::call_once{{vtable.shim}}::hedad2e997023f271\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/ops/function.rs:513:5\r\n\r\n  51:     0x55f5dbc7b5c6 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h312fea4ff6db7ecf\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/alloc/src/boxed.rs:2000:9\r\n\r\n  52:     0x55f5dbc7b5c6 - <core::panic::unwind_safe::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once::hdb969e3902e87449\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panic/unwind_safe.rs:271:9\r\n\r\n  53:     0x55f5dbc7b5c6 - std::panicking::try::do_call::h6da79ecfef558898\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:483:40\r\n\r\n  54:     0x55f5dbc7b5c6 - std::panicking::try::h7f668fbaf77473b2\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:447:19\r\n\r\n  55:     0x55f5dbc7b5c6 - std::panic::catch_unwind::ha6924da3c5c9fc14\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panic.rs:137:14\r\n\r\n  56:     0x55f5dbc7b5c6 - test::run_test_in_process::hb6aceb0c3bf0084e\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/test/src/lib.rs:660:27\r\n\r\n  57:     0x55f5dbc7b5c6 - test::run_test::run_test_inner::{{closure}}::h1f9d76cb3b5cab45\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/test/src/lib.rs:554:39\r\n\r\n  58:     0x55f5dbc49a64 - test::run_test::run_test_inner::{{closure}}::hbb1c64585fff0899\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/test/src/lib.rs:581:37\r\n\r\n  59:     0x55f5dbc49a64 - std::sys_common::backtrace::__rust_begin_short_backtrace::hc55a7d34ba091187\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys_common/backtrace.rs:121:18\r\n\r\n  60:     0x55f5dbc4f125 - std::thread::Builder::spawn_unchecked_::{{closure}}::{{closure}}::h5f0678941ebc6010\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/thread/mod.rs:551:17\r\n\r\n  61:     0x55f5dbc4f125 - <core::panic::unwind_safe::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once::h7b5b1b1b480c0d0b\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/panic/unwind_safe.rs:271:9\r\n\r\n  62:     0x55f5dbc4f125 - std::panicking::try::do_call::h75b027545d7dd24a\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:483:40\r\n\r\n  63:     0x55f5dbc4f125 - std::panicking::try::h3231c5548f9f3483\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panicking.rs:447:19\r\n\r\n  64:     0x55f5dbc4f125 - std::panic::catch_unwind::h4b3465df06d90c4b\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/panic.rs:137:14\r\n\r\n  65:     0x55f5dbc4f125 - std::thread::Builder::spawn_unchecked_::{{closure}}::h44dacc2db01da8f5\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/thread/mod.rs:550:30\r\n\r\n  66:     0x55f5dbc4f125 - core::ops::function::FnOnce::call_once{{vtable.shim}}::h8e859a243f1af552\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/core/src/ops/function.rs:513:5\r\n\r\n  67:     0x55f5dea9bae3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h613d5e218c101168\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/alloc/src/boxed.rs:2000:9\r\n\r\n  68:     0x55f5dea9bae3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::hecab0373f4228b53\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/alloc/src/boxed.rs:2000:9\r\n\r\n  69:     0x55f5dea9bae3 - std::sys::unix::thread::Thread::new::thread_start::hd2791a9cabec1fda\r\n\r\n                               at /rustc/96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef/library/std/src/sys/unix/thread.rs:108:17\r\n\r\n  70:     0x7f8e44418ea5 - start_thread\r\n\r\n  71:     0x7f8e43e3f9fd - __clone\r\n\r\n  72:                0x0 - <unknown>\r\n\r\nthread panicked while panicking. aborting.\r\n\r\n\r\n\r\nerror: test run failed\r\n\r\n+ gdb -c 'core.*' -batch -ex 'info threads' -ex 'thread apply all bt'\r\n\r\n/home/jenkins/agent/tikv-presubmit/unit-test/core.*: No such file or directory.\r\n\r\nNo threads.\r\n\r\n+ exit 1\r\n\r\nscript returned exit code 1\r\n```\r\n\r\nCI build link: https://do.pingcap.net/jenkins/job/tikv/job/tikv/job/release-7.5/job/pull_unit_test/195/\r\n\r\nRef #17653\r\n",
  "state": "closed",
  "created_at": "2024-10-15T06:19:14Z",
  "updated_at": "2024-10-15T06:22:31Z",
  "closed_at": "2024-10-15T06:22:30Z",
  "labels": [
    "type/bug",
    "affects-7.5"
  ],
  "comments_data": [
    {
      "id": 2412993002,
      "user": "wuhuizuo",
      "created_at": "2024-10-15T06:20:58Z",
      "body": "/label affects-7.5"
    },
    {
      "id": 2412994446,
      "user": "wuhuizuo",
      "created_at": "2024-10-15T06:22:05Z",
      "body": "dup with #17497"
    },
    {
      "id": 2412995051,
      "user": "wuhuizuo",
      "created_at": "2024-10-15T06:22:30Z",
      "body": "dup with https://github.com/tikv/tikv/issues/17497"
    }
  ]
}