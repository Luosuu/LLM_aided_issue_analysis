{
  "issue_number": 15724,
  "title": "[Dynamic Regions] AVAILABLE is always 0 when query information_schema.tiflash_replica after br restore tiflash data with 2 replicas ",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n\r\n### What version of TiKV are you using?\r\n./tikv-server -V\r\n TiKV \r\nRelease Version:   7.5.0-alpha\r\nEdition:           Community\r\nGit Commit Hash:   fda1b5caf19f3ee87ab26c4458c64a6b3f3ea5ca\r\nGit Commit Branch: heads/refs/tags/v7.5.0-alpha\r\nUTC Build Time:    2023-09-28 11:48:46\r\nRust Version:      rustc 1.67.0-nightly (96ddd32c4 2022-11-14)\r\nEnable Features:   pprof-fp jemalloc mem-profiling portable sse test-engine-kv-rocksdb test-engine-raft-raft-engine cloud-aws cloud-gcp cloud-azure\r\nProfile:           dist_release\r\n\r\n### What operating system and CPU are you using?\r\n8c/32g\r\n\r\n### Steps to reproduce\r\n1、/br restore db  --send-credentials-to-tikv=true --db tpcc --pd http://tc-pd.endless-ha-test-htap-tps-2880160-1-720:2379 --storage s3://nfs/tiflash/ch-2k-flash2-collation --s3.endpoint  http://minio.pingcap.net:9000 --check-requirements=false\r\n2、select * from information_schema.tiflash_replica\r\n[{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2759\\\",\\\"TABLE_NAME\\\":\\\"supplier\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2725\\\",\\\"TABLE_NAME\\\":\\\"warehouse\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2735\\\",\\\"TABLE_NAME\\\":\\\"orders\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2727\\\",\\\"TABLE_NAME\\\":\\\"district\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2737\\\",\\\"TABLE_NAME\\\":\\\"order_line\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2729\\\",\\\"TABLE_NAME\\\":\\\"customer\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2731\\\",\\\"TABLE_NAME\\\":\\\"history\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2755\\\",\\\"TABLE_NAME\\\":\\\"nation\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2739\\\",\\\"TABLE_NAME\\\":\\\"stock\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2741\\\",\\\"TABLE_NAME\\\":\\\"item\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2733\\\",\\\"TABLE_NAME\\\":\\\"new_order\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"},{\\\"AVAILABLE\\\":\\\"0\\\",\\\"LOCATION_LABELS\\\":\\\"\\\",\\\"PROGRESS\\\":\\\"0\\\",\\\"REPLICA_COUNT\\\":\\\"2\\\",\\\"TABLE_ID\\\":\\\"2757\\\",\\\"TABLE_NAME\\\":\\\"region\\\",\\\"TABLE_SCHEMA\\\":\\\"tpcc\\\"}]\"]\r\n\r\n### What did you expect?\r\nAVAILABLE is 1 after br restore tiflash data with 2 replicas \r\n\r\n### What did happened?\r\nAVAILABLE is always 0 when query information_schema.tiflash_replica after br restore tiflash data with 2 replicas ",
  "state": "closed",
  "created_at": "2023-10-07T09:44:24Z",
  "updated_at": "2023-10-07T09:46:26Z",
  "closed_at": "2023-10-07T09:46:26Z",
  "labels": [
    "type/bug"
  ],
  "comments_data": [
    {
      "id": 1751667408,
      "user": "Lily2025",
      "created_at": "2023-10-07T09:46:26Z",
      "body": "should record in tiflash repo"
    }
  ]
}