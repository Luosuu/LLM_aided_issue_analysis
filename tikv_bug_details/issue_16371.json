{
  "issue_number": 16371,
  "title": "tikv panic when enable row level checksum and insert some data",
  "body": "## Bug Report\r\n\r\n<!-- Thanks for your bug report! Don't worry if you can't fill out all the sections. -->\r\n\r\n### What version of TiKV are you using?\r\n<!-- You can run `tikv-server --version` -->\r\n\r\n```\r\n[\"Release Version:   8.0.0-alpha\"]\r\n[\"Git Commit Hash:   8130cb35731d894fe0b5bf7dcf9496b9fcd57bc8\"]\r\n```\r\n\r\n\r\n### What operating system and CPU are you using?\r\n<!-- If you're using Linux, you can run `cat /proc/cpuinfo` -->\r\n\r\n### Steps to reproduce\r\n<!-- If possible, provide a recipe for reproducing the error. A complete runnable program is good. -->\r\n\r\n1. deploy tidb cluser\r\n```\r\ntiup playground v7.6.0-alpha-instant  --db 1 --kv 1 --pd 1 --tiflash 0 --without-monitor\r\n```\r\n\r\n2. enable the row checksum.\r\n```\r\nset global tidb_enable_row_level_checksum=true;\r\n```\r\n\r\n3. exit the mysql client, and entry it again, source the following file\r\n```\r\nhttps://github.com/pingcap/tiflow/blob/master/tests/integration_tests/kafka_simple_basic_avro/data/data.sql\r\n```\r\n\r\n### What did you expect?\r\n\r\nnothing\r\n\r\n### What did happened?\r\n\r\n```\r\n[2024/01/12 16:55:02.845 +08:00] [FATAL] [lib.rs:478] [\"called `Option::unwrap()` on a `None` value\"] [backtrace=\"   0: backtrace::capture::Backtrace::new\\n   1: tikv_util::set_panic_hook::{{closure}}\\n   2: std::panicking::rust_panic_with_hook\\n   3: std::panicking::begin_panic_handler::{{closure}}\\n   4: std::sys_common::backtrace::__rust_end_short_backtrace\\n   5: _rust_begin_unwind\\n   6: core::panicking::panic_fmt\\n   7: core::panicking::panic\\n   8: tidb_query_datatype::codec::row::v2::row_slice::RowSlice::cut_checksum_bytes\\n   9: tidb_query_datatype::codec::row::v2::row_slice::RowSlice::from_bytes\\n  10: <tidb_query_executors::table_scan_executor::TableScanExecutorImpl as tidb_query_executors::util::scan_executor::ScanExecutorImpl>::process_kv_pair\\n  11: <tidb_query_executors::util::scan_executor::ScanExecutor<S,I,F> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  12: <tidb_query_executors::table_scan_executor::BatchTableScanExecutor<S,F> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  13: <tidb_query_common::execute_stats::WithSummaryCollector<C,T> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  14: <alloc::boxed::Box<T> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  15: <tidb_query_executors::selection_executor::BatchSelectionExecutor<Src> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  16: <tidb_query_common::execute_stats::WithSummaryCollector<C,T> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  17: <alloc::boxed::Box<T> as tidb_query_executors::interface::BatchExecutor>::next_batch::{{closure}}\\n  18: tidb_query_executors::runner::BatchExecutorsRunner<SS>::internal_handle_request::{{closure}}\\n  19: <tikv::coprocessor::dag::BatchDagHandler as tikv::coprocessor::RequestHandler>::handle_request::{{closure}}\\n  20: <tikv::coprocessor::interceptors::tracker::Tracker<F,E> as core::future::future::Future>::poll\\n  21: tikv::read_pool::ReadPoolHandle::spawn_handle::{{closure}}\\n  22: <resource_control::future::ControlledFuture<F> as core::future::future::Future>::poll\\n  23: yatp::task::future::RawTask<F>::poll\\n  24: <yatp::task::future::Runner as yatp::pool::runner::Runner>::handle\\n  25: <yatp::queue::multilevel::TrackedRunner<R> as yatp::pool::runner::Runner>::handle\\n  26: std::sys_common::backtrace::__rust_begin_short_backtrace\\n  27: core::ops::function::FnOnce::call_once{{vtable.shim}}\\n  28: std::sys::unix::thread::Thread::new::thread_start\\n  29: __pthread_joiner_wake\\n\"] [location=components/tidb_query_datatype/src/codec/row/v2/row_slice.rs:244] [thread_name=unified-read-pool-2] [thread_id=0x5]\r\n\r\n```\r\n",
  "state": "closed",
  "created_at": "2024-01-12T08:59:04Z",
  "updated_at": "2024-01-15T11:00:28Z",
  "closed_at": "2024-01-15T03:34:19Z",
  "labels": [
    "type/bug",
    "sig/transaction",
    "severity/major",
    "affects-7.5"
  ],
  "comments_data": []
}