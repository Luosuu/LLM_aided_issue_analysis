{
  "issue_number": 7183,
  "title": "raftstore::test_stale_peer::test_server_stale_peer_out_of_region failed",
  "body": "raftstore::test_stale_peer::test_server_stale_peer_out_of_region\n\nLatest failed builds: \nhttps://internal.pingcap.net/idc-jenkins/view/ghpr_tikv/job/tikv_ghpr_test/19071/consoleFull\n",
  "state": "closed",
  "created_at": "2020-03-20T13:00:57Z",
  "updated_at": "2020-11-19T11:29:05Z",
  "closed_at": "2020-11-19T11:29:04Z",
  "labels": [
    "type/bug",
    "sig/raft",
    "component/test-bench",
    "priority/high",
    "severity/major"
  ],
  "comments_data": [
    {
      "id": 603224401,
      "user": "sre-bot",
      "created_at": "2020-03-24T13:00:49Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/19324/consoleFull"
    },
    {
      "id": 621819393,
      "user": "sre-bot",
      "created_at": "2020-04-30T13:00:59Z",
      "body": "New failed tests found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/21872/consoleFull\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/21904/consoleFull"
    },
    {
      "id": 627327955,
      "user": "sre-bot",
      "created_at": "2020-05-12T13:01:24Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/22436/consoleFull"
    },
    {
      "id": 627967686,
      "user": "sre-bot",
      "created_at": "2020-05-13T13:01:08Z",
      "body": "New failed tests found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/22614/consoleFull\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/22596/consoleFull"
    },
    {
      "id": 628618986,
      "user": "sre-bot",
      "created_at": "2020-05-14T13:01:51Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_master_test_coverage/1231/consoleFull"
    },
    {
      "id": 630167046,
      "user": "sre-bot",
      "created_at": "2020-05-18T13:01:13Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/22812/consoleFull"
    },
    {
      "id": 659395424,
      "user": "sre-bot",
      "created_at": "2020-07-16T13:01:22Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/25458/consoleFull"
    },
    {
      "id": 680010187,
      "user": "sre-bot",
      "created_at": "2020-08-25T13:01:16Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/27199/consoleFull"
    },
    {
      "id": 682535248,
      "user": "sre-bot",
      "created_at": "2020-08-28T13:02:18Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/27418/consoleFull"
    },
    {
      "id": 685720128,
      "user": "sre-bot",
      "created_at": "2020-09-02T13:01:37Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/27692/consoleFull"
    },
    {
      "id": 696098811,
      "user": "sre-bot",
      "created_at": "2020-09-21T13:01:54Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/29496/consoleFull"
    },
    {
      "id": 698329078,
      "user": "sre-bot",
      "created_at": "2020-09-24T13:01:26Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/29803/consoleFull"
    },
    {
      "id": 702720450,
      "user": "sre-bot",
      "created_at": "2020-10-02T13:00:49Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/30540/consoleFull"
    },
    {
      "id": 726570666,
      "user": "hunterlxt",
      "created_at": "2020-11-13T07:20:26Z",
      "body": "/info"
    },
    {
      "id": 726570680,
      "user": "ti-srebot",
      "created_at": "2020-11-13T07:20:28Z",
      "body": "## Please edit this comment or add a new comment to complete the following information\n\n### Not a bug\n\n1. Remove the 'type/bug' label\n2. Add notes to indicate why it is not a bug\n\n### Duplicate bug\n\n1. Add the 'type/duplicate' label\n2. Add the link to the original bug\n\n### Bug\n\nNote: Make Sure that 'component', and 'severity' labels are added\nExample for how to fill out the template: https://github.com/pingcap/tidb/issues/20100\n\n#### 1. Root Cause Analysis (RCA) (optional) \n<!-- Write down the reason why this bug occurs -->\n\n#### 2. Symptom (optional)\n\n<!-- What will the user see when this bug occurs. The error message may be in the terminal, log or monitoring -->\n\n#### 3. All Trigger Conditions (optional)\n\n<!-- All the user scenarios that may trigger this bug -->\n\n#### 4. Workaround (optional)\n\n#### 5. Affected versions\n\n<!--\nIn the format of [start_version:end_version], multiple version ranges are\naccepted. If the bug only affects the unreleased version, please input:\n\"unreleased\". For example:\n\nNotes:\n  1. Do not use any white spaces in '[]'.\n  2. The range in '[]' is a closed interval\n  3. The version format is `v$Major.$Minor.$Patch`, the $Majoy and $Minor\n     number in a version range should be the same. [v3.0.1:v3.1.2] is\n     invalid because the $Minor number of the version range is different.\n\nExample 1: [v3.0.1:v3.0.5], [v4.0.1:v4.0.5]\nExample 2: unreleased\n-->\n\n#### 6. Fixed versions\n\n<!--\nThe first released version that contains this fix in each minor version. If the bug's affected version has been released, the fixed version should be a detailed version number; If the bug doesn't affect any released version, the fixed version can be \"master\";  \n\nExample 1: v3.0.13, v4.0.5\nExample 2: master\n-->"
    },
    {
      "id": 726572613,
      "user": "hunterlxt",
      "created_at": "2020-11-13T07:25:56Z",
      "body": "# Bug\r\n\r\n1. Root Cause Analysis (RCA) (optional)\r\nThe test may failed when the peer added cannot catch up the log entries because it's added by adding voter not by adding learner. So sometimes when truncated index > promoted index, the new peer will be added failed.\r\n\r\n2. Symptom (optional)\r\ntest panicked.\r\n\r\n3. All Trigger Conditions (optional)\r\nwhen the peer is added but applied index > 0\r\n\r\n4. Workaround (optional)\r\nAdd node as learner first.\r\n\r\n5. Affected versions\r\nAll\r\n\r\n6. Fixed versions\r\nv4.0.9"
    },
    {
      "id": 727969836,
      "user": "sre-bot",
      "created_at": "2020-11-16T13:01:10Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_master_test_coverage/1604/consoleFull"
    },
    {
      "id": 728911869,
      "user": "sre-bot",
      "created_at": "2020-11-17T13:01:10Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_master_test_coverage/1614/consoleFull"
    },
    {
      "id": 728995141,
      "user": "hunterlxt",
      "created_at": "2020-11-17T15:15:17Z",
      "body": "@gengliqi PTAL"
    },
    {
      "id": 729661718,
      "user": "sre-bot",
      "created_at": "2020-11-18T13:01:07Z",
      "body": "New failed test found:\nhttps://internal.pingcap.net/idc-jenkins/job/tikv_ghpr_test/35375/consoleFull"
    },
    {
      "id": 730311724,
      "user": "hunterlxt",
      "created_at": "2020-11-19T11:29:04Z",
      "body": "These 3 new failed tests is before https://github.com/tikv/tikv/pull/9030 was merged. Close this issue again."
    }
  ]
}